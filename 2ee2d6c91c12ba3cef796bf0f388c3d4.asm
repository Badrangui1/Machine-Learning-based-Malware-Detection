xor     eax, eax
jmp     short loc_401010
movsx   ecx, cl
cmp     ecx, [esp+arg_0]
jnz     short loc_40100f
mov     eax, edx
inc     edx
mov     cl, [edx]
test    cl, cl
jnz     short loc_401004
retn
push    [esp+lpstring2]
push    [esp+4+lpstring1]
call    ds:lstrcpya
mov     edx, [esp+lpstring1]
push    5ch
call    sub_401000
test    eax, eax
pop     ecx
jz      short locret_401039
and     byte ptr [eax+1], 0
retn
push    edi
mov     edi, ds:lstrlena
push    esi
call    edi
cmp     byte ptr [eax+esi-1], 5ch
jnz     short loc_401053
push    esi
call    edi
and     byte ptr [eax+esi-1], 0
pop     edi
retn
push    ebx
push    esi
mov     esi, [esp+8+arg_0]
push    edi
push    0ffffffffh
lea     edi, [esi+204h]
push    dword ptr [edi]
xor     ebx, ebx
call    dword ptr [esi+208h]
push    dword ptr [edi]
call    dword ptr [esi+20ch]
lea     edi, [esi+228h]
jmp     short loc_40108f
inc     ebx
cmp     ebx, 3
jg      short loc_40109a
push    3e8h
call    dword ptr [esi+214h]
push    edi
call    dword ptr [esi+210h]
test    eax, eax
jz      short loc_40107e
cmp     dword ptr [esi+224h], 1
jnz     short loc_401110
lea     eax, [esi+32ch]
push    eax
call    dword ptr [esi+21ch]
lea     edi, [esi+430h]
push    edi
call    dword ptr [esi+220h]
test    eax, eax
jz      short loc_4010c8
push    edi
call    dword ptr [esi+21ch]
lea     edi, [esi+534h]
push    edi
call    dword ptr [esi+220h]
test    eax, eax
jz      short loc_4010e0
push    edi
call    dword ptr [esi+21ch]
lea     edi, [esi+638h]
push    edi
call    dword ptr [esi+220h]
test    eax, eax
jz      short loc_4010f8
push    edi
call    dword ptr [esi+21ch]
lea     edi, [esi+73ch]
push    edi
call    dword ptr [esi+220h]
test    eax, eax
jz      short loc_401110
push    edi
call    dword ptr [esi+21ch]
push    0
call    dword ptr [esi+218h]
pop     edi
pop     esi
pop     ebx
retn
push    ebp
mov     ebp, esp
sub     esp, 0e74h
push    esi
push    edi
push    44h
pop     edx
push    10h
pop     ecx
xor     eax, eax
mov     [ebp+startupinfo.cb], edx
lea     edi, [ebp+startupinfo.lpreserved]
rep stosd
mov     esi, offset aexplorerexe
lea     edi, [ebp+commandline]
movsd
movsd
push    3dh
movsd
pop     ecx
movsb
lea     edi, [ebp+var_257]
rep stosd
stosw
stosb
lea     eax, [ebp+processinformation]
push    eax
xor     esi, esi
lea     eax, [ebp+startupinfo]
push    eax
push    offset currentdirectory
push    esi
push    edx
push    esi
push    esi
push    esi
lea     eax, [ebp+commandline]
push    eax
push    esi
mov     [ebp+var_4], esi
call    ds:createprocessa
test    eax, eax
jz      loc_4013e2
mov     eax, ds:waitforsingleobject
mov     edi, ds:lstrlena
mov     [ebp+var_89c], eax
mov     eax, ds:closehandle
mov     [ebp+var_898], eax
mov     eax, ds:deletefilea
mov     [ebp+var_894], eax
mov     eax, ds:sleep
mov     [ebp+var_890], eax
mov     eax, ds:exitprocess
push    ebx
mov     ebx, ds:getcurrentprocess
mov     [ebp+var_88c], eax
mov     eax, ds:removedirectorya
push    esi
mov     [ebp+var_888], eax
mov     eax, [ebp+arg_0]
push    esi
mov     [ebp+var_880], eax
push    esi
lea     eax, [ebp+targethandle]
push    eax
push    [ebp+processinformation.hprocess]
mov     [ebp+var_884], edi
call    ebx
push    eax
call    ebx
push    eax
call    ds:duplicatehandle
push    104h
lea     eax, [ebp+filename]
push    eax
push    esi
call    ds:getmodulefilenamea
lea     eax, [ebp+string2]
push    eax
lea     eax, [ebp+filename]
push    eax
call    sub_401017
mov     ebx, ds:lstrcpya
pop     ecx
pop     ecx
lea     eax, [ebp+string2]
push    eax
lea     eax, [ebp+string1]
push    eax
call    ebx
lea     eax, [ebp+string1]
push    eax
call    edi
cmp     eax, 3
jle     loc_401325
lea     esi, [ebp+string1]
call    sub_40103a
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+string2]
jmp     loc_40130e
push    5ch
lea     edx, [ebp+string1]
call    sub_401000
pop     ecx
push    eax
call    edi
xor     esi, esi
inc     esi
sub     esi, eax
lea     eax, [ebp+string1]
push    eax
call    edi
add     esi, eax
push    esi
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+var_e74]
push    eax
call    ds:lstrcpyna
lea     eax, [ebp+var_e74]
push    eax
lea     eax, [ebp+string1]
push    eax
call    ebx
lea     eax, [ebp+string1]
push    eax
call    edi
cmp     eax, 3
jle     short loc_401311
inc     [ebp+var_4]
mov     eax, [ebp+var_4]
dec     eax
jz      short loc_401301
dec     eax
jz      short loc_4012f2
dec     eax
jz      short loc_4012e3
dec     eax
jnz     short loc_401311
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+var_368]
jmp     short loc_40130e
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+var_46c]
jmp     short loc_40130e
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+var_570]
jmp     short loc_40130e
lea     eax, [ebp+string1]
push    eax
lea     eax, [ebp+var_674]
push    eax
call    ebx
lea     eax, [ebp+string1]
push    eax
call    edi
cmp     eax, 3
jg      loc_40126e
jmp     short loc_40132b
mov     [ebp+var_880], esi
lea     eax, [ebp+context]
push    eax
push    [ebp+processinformation.hthread]
mov     ecx, 80h
mov     esi, offset sub_401055
lea     edi, [ebp+var_aa0]
rep movsd
mov     [ebp+context.contextflags], 10003h
call    ds:getthreadcontext
mov     esi, [ebp+context._esp]
add     esi, 0fffff7c0h
and     esi, 0ffffffe0h
lea     eax, [esi-4]
mov     [ebp+context._esp], eax
lea     eax, [esi+4]
mov     [ebp+context._eip], eax
lea     eax, [ebp+floldprotect]
push    eax
push    40h
mov     edi, 840h
push    edi
push    esi
push    [ebp+processinformation.hprocess]
mov     [ebp+buffer], esi
call    ds:virtualprotectex
push    0
push    edi
lea     eax, [ebp+buffer]
push    eax
push    esi
push    [ebp+processinformation.hprocess]
call    ds:writeprocessmemory
push    edi
push    esi
push    [ebp+processinformation.hprocess]
call    ds:flushinstructioncache
lea     eax, [ebp+context]
push    eax
push    [ebp+processinformation.hthread]
call    ds:setthreadcontext
push    [ebp+processinformation.hthread]
call    ds:resumethread
push    [ebp+processinformation.hthread]
mov     esi, ds:closehandle
call    esi
push    [ebp+processinformation.hprocess]
call    esi
xor     eax, eax
inc     eax
pop     ebx
jmp     short loc_4013e4
xor     eax, eax
pop     edi
pop     esi
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 200h
push    offset string1
push    [ebp+arg_4]
lea     eax, [ebp+text]
push    [ebp+arg_0]
push    offset athisapplicatio
push    eax
call    ds:wsprintfa
add     esp, 14h
push    2010h
push    offset caption
lea     eax, [ebp+text]
push    eax
push    0
call    ds:messageboxa
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 208h
lea     eax, [ebp+buffer]
push    eax
push    104h
call    ds:gettemppatha
lea     eax, [ebp+tempfilename]
push    eax
push    0
push    offset prefixstring
lea     eax, [ebp+buffer]
push    eax
call    ds:gettempfilenamea
lea     eax, [ebp+tempfilename]
push    eax
push    [ebp+lpstring1]
call    ds:lstrcpya
push    0
push    80h
push    2
push    0
push    0
push    40000000h
push    [ebp+lpstring1]
call    ds:createfilea
leave
retn
sub     esp, 104h
push    esi
mov     esi, offset newfilename
push    esi
call    sub_40142c
pop     ecx
push    eax
call    ds:closehandle
push    esi
call    ds:deletefilea
push    esi
lea     eax, [esp+10ch+existingfilename]
push    eax
call    ds:movefilea
pop     esi
add     esp, 104h
retn
sub     esp, 120h
push    ebx
push    ebp
push    esi
mov     esi, ds:createfilea
push    edi
xor     ebx, ebx
push    ebx
mov     ebp, 80h
push    ebp
push    3
push    ebx
push    1
mov     edi, 80000000h
push    edi
push    offset filename
mov     [esp+14ch+numberofbytesread], ebx
mov     [esp+14ch+var_120], ebx
call    esi
cmp     eax, 0ffffffffh
mov     [esp+130h+hfile], eax
jz      loc_4015ec
push    24ach
push    2
call    ds:globalalloc
cmp     eax, ebx
mov     [esp+130h+hmem], eax
jz      loc_4015e0
push    eax
call    ds:globallock
cmp     eax, ebx
mov     [esp+130h+lpbuffer], eax
jz      loc_4015d6
push    ebx
push    ebx
push    ldistancetomove
push    [esp+13ch+hfile]
call    ds:setfilepointer
push    ebx
lea     eax, [esp+134h+numberofbytesread]
push    eax
push    24abh
push    [esp+13ch+lpbuffer]
push    [esp+140h+hfile]
call    ds:readfile
test    eax, eax
jnz     short loc_401577
push    offset string2
push    offset string1
mov     [esp+138h+var_120], 0fffffffbh
call    ds:lstrcpya
mov     eax, [esp+130h+numberofbytesread]
mov     ecx, [esp+130h+lpbuffer]
mov     [ecx+eax], bl
lea     eax, [esp+130h+filename]
push    eax
call    sub_40142c
pop     ecx
push    ebx
lea     ecx, [esp+134h+numberofbyteswritten]
push    ecx
push    [esp+138h+numberofbytesread]
mov     [esp+13ch+hobject], eax
push    [esp+13ch+lpbuffer]
push    eax
call    ds:writefile
test    eax, eax
jg      short loc_4015c2
push    offset acantwriteloade
push    offset string1
mov     [esp+138h+var_120], 0fffffffah
call    ds:lstrcpya
push    [esp+130h+hobject]
call    ds:closehandle
push    [esp+130h+hmem]
call    ds:globalunlock
push    [esp+130h+hmem]
call    ds:globalfree
push    [esp+130h+hfile]
call    ds:closehandle
jmp     short loc_401604
push    offset acantgetreadacc_0
push    offset string1
mov     [esp+138h+var_120], 0fffffffeh
call    ds:lstrcpya
mov     eax, [esp+130h+var_120]
cmp     eax, ebx
jnz     loc_4016f1
push    ebx
push    ebp
push    3
push    ebx
push    ebx
push    edi
lea     eax, [esp+148h+filename]
push    eax
call    esi
mov     edi, eax
cmp     edi, 0ffffffffh
jz      loc_4016b9
push    edi
call    lzinit
push    3c01h
push    2
mov     [esp+138h+hmem], eax
call    ds:globalalloc
mov     esi, eax
cmp     esi, ebx
jz      short loc_4016a7
push    esi
call    ds:globallock
test    eax, eax
jz      short loc_4016a0
push    offset filename
call    sub_40142c
pop     ecx
mov     ebx, eax
push    ebx
call    lzinit
mov     ebp, eax
push    ebp
push    [esp+134h+hmem]
call    lzcopy
test    eax, eax
jg      short loc_40168c
push    offset acantdecompress
push    offset string1
mov     [esp+138h+var_120], 0fffffffdh
call    ds:lstrcpya
push    ebp
call    lzclose
push    ebx
call    ds:closehandle
push    esi
call    ds:globalunlock
push    esi
call    ds:globalfree
push    [esp+130h+hmem]
call    lzclose
push    edi
call    ds:closehandle
jmp     short loc_4016d1
push    offset string2
push    offset string1
mov     [esp+138h+var_120], 0fffffffch
call    ds:lstrcpya
lea     eax, [esp+130h+filename]
push    eax
call    ds:deletefilea
lea     eax, [esp+130h+filename]
push    offset dword_403620
push    eax
call    sub_401017
mov     eax, [esp+138h+var_120]
pop     ecx
pop     ecx
pop     edi
pop     esi
pop     ebp
pop     ebx
add     esp, 120h
retn
push    ebp
mov     ebp, esp
sub     esp, 10h
push    ebx
xor     ebx, ebx
push    ebx
push    80h
push    3
push    ebx
push    1
push    80000000h
push    offset filename
mov     [ebp+ldistancetomove], 17d4h
call    ds:createfilea
cmp     eax, 0ffffffffh
mov     [ebp+hfile], eax
jnz     short loc_401733
xor     eax, eax
jmp     short loc_401795
push    esi
mov     esi, ds:readfile
push    edi
mov     edi, 44445a53h
jmp     short loc_40176c
inc     [ebp+ldistancetomove]
cmp     [ebp+ldistancetomove], 1838h
jg      short loc_401788
push    ebx
push    ebx
push    [ebp+ldistancetomove]
push    [ebp+hfile]
call    ds:setfilepointer
push    ebx
lea     eax, [ebp+numberofbytesread]
push    eax
push    4
lea     eax, [ebp+buffer]
push    eax
push    [ebp+hfile]
call    esi
cmp     [ebp+buffer], edi
jnz     short loc_401742
push    ebx
lea     eax, [ebp+numberofbytesread]
push    eax
push    4
push    offset dword_403608
push    [ebp+hfile]
call    esi
mov     ebx, dword_403608
push    [ebp+hfile]
call    ds:closehandle
pop     edi
mov     eax, ebx
pop     esi
pop     ebx
leave
retn
sub     esp, 18h
push    esi
push    edi
xor     esi, esi
and     [esp+20h+var_18], esi
push    8001h
call    ds:seterrormode
mov     umode, eax
call    ds:initcommoncontrols
push    104h
mov     edi, offset filename
push    edi
push    [esp+28h+hmodule]
call    ds:getmodulefilenamea
call    sub_4016fc
test    eax, eax
mov     ldistancetomove, eax
jnz     short loc_4017f1
push    offset acantfindstublo
push    offset string1
call    ds:lstrcpya
push    esi
push    8
jmp     short loc_401809
add     eax, 24abh
mov     dword_403230, eax
call    sub_4014c4
mov     esi, eax
test    esi, esi
jge     short loc_401815
push    esi
push    1
call    sub_4013e8
pop     ecx
pop     ecx
jmp     loc_401960
push    ebx
push    ebp
mov     ebp, ds:loadlibrarya
push    offset filename
call    ebp
test    eax, eax
mov     hlibmodule, eax
jnz     short loc_40183b
call    ds:getlasterror
push    eax
push    2
jmp     loc_401957
mov     ebx, ds:getprocaddress
push    offset procname
push    eax
call    ebx
test    eax, eax
mov     dword_40360c, eax
jnz     short loc_401860
call    ds:getlasterror
push    eax
push    3
jmp     loc_401957
call    sub_40148f
push    2
lea     eax, [esp+2ch+var_14]
push    eax
push    dword_403230
mov     eax, offset byte_4020d5
push    eax
push    eax
push    offset newfilename
push    edi
call    dword_40360c
mov     esi, eax
mov     eax, hlibmodule
add     esp, 1ch
test    eax, eax
jz      short loc_4018a1
push    eax
call    ds:freelibrary
and     hlibmodule, 0
test    esi, esi
jz      short loc_4018ad
push    esi
push    4
jmp     loc_401957
push    offset newfilename
call    ebp
test    eax, eax
mov     dword_403238, eax
jnz     short loc_4018cb
call    ds:getlasterror
push    eax
push    5
jmp     loc_401957
push    offset aruninstaller
push    eax
call    ebx
test    eax, eax
mov     dword_403604, eax
jnz     short loc_4018e7
call    ds:getlasterror
push    eax
push    6
jmp     short loc_401957
mov     eax, hlibmodule
test    eax, eax
jz      short loc_4018fe
push    eax
call    ds:freelibrary
and     hlibmodule, 0
lea     eax, [esp+28h+var_18]
push    eax
push    [esp+2ch+arg_8]
push    offset a0cae82a61
push    offset asc_403190
push    offset asc_403120
push    offset asc_403018
push    dword_403230
push    offset filename
push    offset dword_403620
push    edi
push    [esp+50h+arg_4]
call    dword_403604
mov     esi, eax
add     esp, 2ch
test    esi, esi
jz      short loc_40195e
cmp     esi, 63h
jz      short loc_40195e
cmp     esi, 7b0h
jz      short loc_40195e
cmp     esi, 7b1h
jz      short loc_40195e
push    esi
push    7
call    sub_4013e8
pop     ecx
pop     ecx
pop     ebp
pop     ebx
mov     eax, hlibmodule
test    eax, eax
jz      short loc_401970
push    eax
call    ds:freelibrary
mov     eax, dword_403238
test    eax, eax
jz      short loc_401980
push    eax
call    ds:freelibrary
mov     edi, ds:deletefilea
push    offset filename
call    edi
push    offset newfilename
call    edi
push    umode
call    ds:seterrormode
cmp     esi, 7b0h
jnz     short loc_4019b0
push    1
call    sub_40111c
pop     ecx
pop     edi
cmp     esi, 7b1h
pop     esi
jnz     short loc_4019c2
push    0
call    sub_40111c
pop     ecx
mov     eax, [esp+18h+var_18]
add     esp, 18h
retn    10h
sub     esp, 44h
push    esi
call    ds:getcommandlinea
mov     esi, eax
mov     al, [esi]
cmp     al, 22h
jnz     short loc_401a14
mov     al, [esi+1]
inc     esi
test    al, al
jz      short loc_401a0c
lea     ebx, [ebx+0]
cmp     al, 22h
jz      short loc_401a11
mov     al, [esi+1]
inc     esi
test    al, al
jnz     short loc_401a00
cmp     byte ptr [esi], 22h
jnz     short loc_401a20
inc     esi
jmp     short loc_401a20
cmp     al, 20h
jle     short loc_401a20
mov     al, [esi+1]
inc     esi
cmp     al, 20h
jg      short loc_401a18
mov     al, [esi]
test    al, al
jz      short loc_401a32
cmp     al, 20h
jg      short loc_401a32
mov     al, [esi+1]
inc     esi
test    al, al
jnz     short loc_401a26
lea     eax, [esp+48h+startupinfo]
push    eax
mov     [esp+4ch+startupinfo.dwflags], 0
call    ds:getstartupinfoa
call    sub_401ac0
push    offset dword_403004
push    offset dword_403000
call    sub_401a90
mov     al, byte ptr [esp+50h+startupinfo.dwflags]
add     esp, 8
test    al, 1
movzx   eax, [esp+48h+startupinfo.wshowwindow]
jnz     short loc_401a6e
mov     eax, 0ah
push    eax
push    esi
push    0
push    0
call    ds:getmodulehandlea
push    eax
call    sub_401798
mov     esi, eax
call    sub_401ae0
push    esi
call    ds:exitprocess
pop     esi
nop
push    esi
mov     esi, [esp+4+arg_0]
push    edi
mov     edi, [esp+8+arg_4]
cmp     esi, edi
jnb     short loc_401aaf
mov     edi, edi
mov     eax, [esi]
test    eax, eax
jz      short loc_401aa8
call    eax
add     esi, 4
cmp     esi, edi
jb      short loc_401aa0
pop     edi
pop     esi
retn
push    4
push    20h
mov     dword_403224, 20h
call    sub_401b00
add     esp, 8
mov     dword_403220, eax
retn
mov     ecx, dword_403228
test    ecx, ecx
jz      short locret_401afc
mov     eax, dword_403220
lea     ecx, [eax+ecx*4]
push    ecx
push    eax
call    sub_401a90
add     esp, 8
retn
mov     eax, [esp+arg_0]
imul    eax, [esp+arg_4]
push    eax
push    8
call    ds:getprocessheap
push    eax
call    ds:heapalloc
retn