push    ebx
push    esi
push    edi
push    0a10h
push    8
mov     ebx, ecx
push    hheap
call    ds:heapalloc
mov     esi, eax
push    ebx
call    ds:lstrlenw
mov     edi, 100h
mov     [esi], eax
cmp     eax, edi
jbe     short loc_6e2f18be
mov     [esi], edi
mov     eax, [esi]
inc     eax
push    eax
lea     eax, [esi+4]
push    ebx
push    eax
call    ds:wcstombs
add     esp, 0ch
lea     eax, [esi+108h]
mov     ecx, [esi]
mov     [eax], ecx
add     eax, 4
dec     edi
jnz     short loc_6e2f18d6
mov     eax, [esi]
xor     ecx, ecx
test    eax, eax
jbe     short loc_6e2f1900
mov     edx, ebx
movzx   edi, word ptr [edx]
sub     eax, ecx
dec     eax
inc     ecx
mov     [esi+edi*4+108h], eax
mov     eax, [esi]
inc     edx
inc     edx
cmp     ecx, eax
jb      short loc_6e2f18ea
mov     eax, esi
pop     edi
pop     esi
pop     ebx
retn
push    ecx
push    0
push    hheap
call    ds:heapfree
retn
push    ebp
mov     ebp, esp
push    ecx
mov     [ebp+var_4], edx
push    ebx
mov     edx, [ecx]
push    esi
push    edi
mov     edi, edx
mov     ebx, edx
mov     eax, [ebp+var_4]
movzx   esi, byte ptr [edi+eax-1]
movsx   eax, byte ptr [ebx+ecx+3]
cmp     esi, eax
jnz     short loc_6e2f193b
dec     edi
dec     ebx
jmp     short loc_6e2f1953
mov     esi, [ecx+esi*4+108h]
mov     eax, edx
sub     eax, ebx
inc     eax
cmp     eax, esi
jbe     short loc_6e2f194f
add     edi, eax
jmp     short loc_6e2f1951
add     edi, esi
mov     ebx, edx
cmp     ebx, 1
jb      short loc_6e2f195d
cmp     edi, [ebp+arg_0]
jle     short loc_6e2f1926
cmp     edi, [ebp+arg_0]
jl      short loc_6e2f1966
xor     eax, eax
jmp     short loc_6e2f196b
mov     eax, [ebp+var_4]
add     eax, edi
pop     edi
pop     esi
pop     ebx
leave
retn    4
push    ebp
mov     ebp, esp
sub     esp, 6ch
push    ebx
push    esi
push    edi
mov     [ebp+nsize], ecx
push    0dh
mov     esi, offset dword_6e2f12b0
pop     ecx
lea     edi, [ebp+name]
rep movsd
movsw
push    0bh
xor     eax, eax
pop     ecx
lea     edi, [ebp+var_36]
mov     ebx, edx
push    14h
rep stosd
mov     edi, ds:lstrcpynw
push    offset string2
push    ebx
call    edi
lea     edx, [ebp+name]
push    62h
push    4
pop     ecx
call    sub_6e2f2595
mov     esi, ds:getenvironmentvariablew
lea     eax, [ebp+name]
push    [ebp+nsize]
push    ebx
push    eax
call    esi
test    eax, eax
jz      short loc_6e2f19da
push    ebx
call    ds:getfileattributesw
cmp     eax, 0ffffffffh
jz      short loc_6e2f19da
test    al, 10h
jnz     short loc_6e2f1a12
push    13h
lea     eax, [ebp+name]
push    offset word_6e2f125c
push    eax
call    edi
lea     edx, [ebp+name]
push    62h
push    5
pop     ecx
call    sub_6e2f2595
lea     eax, [ebp+name]
push    [ebp+nsize]
push    ebx
push    eax
call    esi
test    eax, eax
jz      short loc_6e2f1a1b
push    ebx
call    ds:getfileattributesw
cmp     eax, 0ffffffffh
jz      short loc_6e2f1a1b
test    al, 10h
jz      short loc_6e2f1a1b
push    ebx
call    ds:lstrlenw
jmp     short loc_6e2f1a9a
mov     eax, [ebp+nsize]
xor     esi, esi
add     eax, eax
mov     [ebp+phkresult], esi
mov     [ebp+nsize], eax
lea     eax, [ebp+phkresult]
push    eax
push    1
push    esi
push    offset subkey
push    80000002h
call    ds:regopenkeyexw
test    eax, eax
jnz     short loc_6e2f1a58
lea     eax, [ebp+nsize]
push    eax
push    ebx
push    esi
push    esi
push    offset valuename
push    [ebp+phkresult]
call    ds:regqueryvalueexw
cmp     [ebp+phkresult], esi
jz      short loc_6e2f1a66
push    [ebp+phkresult]
call    ds:regclosekey
mov     eax, [ebp+nsize]
cmp     word ptr [ebx+eax*2-4], 3bh
lea     eax, [ebx+eax*2-4]
jnz     short loc_6e2f1a78
mov     [eax], si
cmp     [ebp+name], si
jz      short loc_6e2f1a8e
lea     eax, [ebp+name]
push    ebx
push    eax
call    ds:setenvironmentvariablew
mov     eax, [ebp+nsize]
jmp     short loc_6e2f1a9a
push    13h
push    offset word_6e2f125c
push    ebx
call    edi
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
mov     eax, [esp+fdwreason]
push    esi
push    edi
xor     edi, edi
sub     eax, edi
jz      short loc_6e2f1ae0
dec     eax
jnz     short loc_6e2f1af7
push    edi
call    ds:coinitialize
test    eax, eax
jl      short loc_6e2f1adc
mov     esi, [esp+8+hinstdll]
push    esi
call    ds:disablethreadlibrarycalls
push    edi
push    edi
push    edi
mov     hinstance, esi
call    ds:heapcreate
cmp     eax, edi
mov     hheap, eax
jnz     short loc_6e2f1af7
xor     eax, eax
jmp     short loc_6e2f1afa
call    ds:couninitialize
push    hheap
call    ds:heapdestroy
call    sub_6e2f3363
push    1
pop     eax
pop     edi
pop     esi
retn    0ch
push    ebx
push    esi
mov     ebx, ecx
push    edi
push    ebx
call    ds:lstrlenw
mov     edi, eax
lea     eax, [edi+edi+2]
push    eax
push    8
push    hheap
call    ds:heapalloc
mov     esi, eax
test    esi, esi
jz      short loc_6e2f1b35
push    ebx
push    esi
call    ds:lstrcpyw
and     word ptr [esi+edi*2], 0
mov     eax, esi
pop     edi
pop     esi
pop     ebx
retn
push    ebx
push    esi
mov     ebx, ecx
push    edi
push    ebx
call    ds:lstrlena
mov     edi, eax
lea     eax, [edi+edi+2]
push    eax
push    8
push    hheap
call    ds:heapalloc
mov     esi, eax
test    esi, esi
jz      short loc_6e2f1b75
add     edi, edi
push    edi
push    ebx
push    esi
call    ds:mbstowcs
add     esp, 0ch
and     word ptr [esi+edi], 0
mov     eax, esi
pop     edi
pop     esi
pop     ebx
retn
push    ebp
mov     ebp, esp
sub     esp, 400h
mov     eax, [ebp+format]
test    eax, eax
jz      short locret_6e2f1ba3
cmp     byte ptr [eax], 0
jz      short locret_6e2f1ba3
lea     ecx, [ebp+arglist]
push    ecx
push    eax
lea     eax, [ebp+buffer]
push    eax
call    ds:vsprintf
add     esp, 0ch
leave
retn
lea     eax, [ecx+ecx]
push    eax
push    8
push    hheap
call    ds:heapalloc
retn
mov     eax, [ecx]
test    eax, eax
jz      short loc_6e2f1bc2
mov     ecx, eax
jmp     short sub_6e2f1bb8
mov     eax, [esp+arg_0]
mov     [ecx], eax
retn    4
push    ebp
mov     ebp, esp
sub     esp, 424h
push    ebx
push    esi
push    edi
mov     esi, ecx
push    16h
xor     eax, eax
pop     ecx
mov     edi, esi
rep stosd
mov     ecx, [ebp+lpstring2]
xor     ebx, ebx
cmp     ecx, ebx
mov     [ebp+str], offset dword_6e2f1364
jz      short loc_6e2f1bfa
call    sub_6e2f1aff
mov     [esi+4], eax
push    45h
xor     eax, eax
pop     ecx
lea     edi, [ebp+versioninformation]
rep stosd
lea     eax, [ebp+versioninformation]
mov     [ebp+versioninformation.dwosversioninfosize], 114h
push    eax
call    ds:getversionexw
mov     eax, [ebp+versioninformation.dwplatformid]
dec     eax
jz      short loc_6e2f1c33
dec     eax
jnz     short loc_6e2f1c3a
mov     [ebp+str], offset awindowsnt
jmp     short loc_6e2f1c3a
mov     [ebp+str], offset awindows95
call    ds:getsystemdefaultlangid
movzx   eax, ax
push    eax
lea     eax, [ebp+szagent]
push    [ebp+versioninformation.dwminorversion]
push    [ebp+versioninformation.dwmajorversion]
push    [ebp+str]
push    offset amssignup11sddl
push    eax
call    ds:wsprintfw
add     esp, 18h
lea     eax, [ebp+szagent]
push    ebx
push    ebx
push    ebx
push    ebx
push    eax
call    ds:internetopenw
mov     [esi+8], eax
mov     edi, 104h
lea     eax, [ebp+buffer]
push    edi
push    eax
call    ds:getwindowsdirectoryw
lea     ecx, [ebp+buffer]
mov     [ebp+var_8], bx
call    sub_6e2f1aff
mov     ebx, ds:lstrlenw
push    eax
mov     [esi+20h], eax
call    ebx
mov     [esi+34h], eax
lea     eax, [ebp+buffer]
push    edi
push    eax
call    ds:getsystemdirectoryw
and     [ebp+var_8], 0
lea     ecx, [ebp+buffer]
call    sub_6e2f1aff
push    eax
mov     [esi+24h], eax
call    ebx
lea     edx, [ebp+buffer]
mov     ecx, edi
mov     [esi+38h], eax
call    sub_6e2f1972
and     [ebp+var_8], 0
lea     ecx, [ebp+buffer]
call    sub_6e2f1aff
push    eax
mov     [esi+28h], eax
call    ebx
mov     ecx, [esi+28h]
mov     [esi+3ch], eax
cmp     word ptr [ecx+eax*2-2], 5ch
lea     eax, [ecx+eax*2-2]
jnz     short loc_6e2f1d10
and     word ptr [eax], 0
dec     dword ptr [esi+3ch]
push    20ah
push    8
push    hheap
call    ds:heapalloc
push    eax
push    edi
mov     [esi+2ch], eax
call    ds:getcurrentdirectoryw
push    dword ptr [esi+2ch]
call    ebx
mov     [esi+44h], eax
call    ds:getcommandlinew
and     [ebp+lpstring2], 0
push    edi
push    eax
lea     eax, [ebp+buffer]
push    eax
call    ds:wcsncpy
and     [ebp+var_8], 0
add     esp, 0ch
lea     eax, [ebp+buffer]
push    offset delimiter
push    eax
call    ds:wcstok
pop     ecx
mov     [ebp+str], eax
test    eax, eax
pop     ecx
jz      short loc_6e2f1d94
push    5ch
push    eax
call    ds:wcschr
pop     ecx
mov     [ebp+lpstring2], eax
test    eax, eax
pop     ecx
jnz     short loc_6e2f1d94
push    2fh
push    [ebp+str]
call    ds:wcsrchr
pop     ecx
mov     [ebp+lpstring2], eax
pop     ecx
mov     eax, [ebp+lpstring2]
test    eax, eax
jz      short loc_6e2f1da4
and     word ptr [eax], 0
mov     ecx, [ebp+str]
jmp     short loc_6e2f1dbd
lea     eax, [ebp+buffer]
push    eax
push    edi
call    ds:getcurrentdirectoryw
and     [ebp+var_8], 0
lea     ecx, [ebp+buffer]
call    sub_6e2f1aff
push    eax
mov     [esi+30h], eax
call    ebx
mov     [esi+40h], eax
mov     eax, esi
pop     edi
pop     esi
pop     ebx
leave
retn    4
push    ebx
push    esi
mov     esi, ecx
push    edi
push    esi
push    offset format
call    sub_6e2f1b79
pop     ecx
xor     ebx, ebx
pop     ecx
mov     ecx, [esi]
cmp     ecx, ebx
jz      short loc_6e2f1e01
mov     edi, [ecx]
cmp     ecx, ebx
jz      short loc_6e2f1dfb
push    1
call    sub_6e2f1ead
cmp     edi, ebx
mov     ecx, edi
jnz     short loc_6e2f1dee
mov     eax, [esi+20h]
mov     edi, ds:heapfree
cmp     eax, ebx
jz      short loc_6e2f1e18
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+24h]
cmp     eax, ebx
jz      short loc_6e2f1e29
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+28h]
cmp     eax, ebx
jz      short loc_6e2f1e3a
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+2ch]
cmp     eax, ebx
jz      short loc_6e2f1e4b
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+30h]
cmp     eax, ebx
jz      short loc_6e2f1e5c
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+4]
cmp     eax, ebx
jz      short loc_6e2f1e6d
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+18h]
cmp     eax, ebx
jz      short loc_6e2f1e7e
push    eax
push    ebx
push    hheap
call    edi
mov     eax, [esi+8]
cmp     eax, ebx
jz      short loc_6e2f1e8c
push    eax
call    ds:internetclosehandle
mov     eax, [esi+50h]
cmp     eax, ebx
jz      short loc_6e2f1ea9
push    ebx
push    1
push    eax
call    ds:releasesemaphore
push    dword ptr [esi+50h]
call    ds:closehandle
mov     [esi+50h], ebx
pop     edi
pop     esi
pop     ebx
retn
push    esi
mov     esi, ecx
mov     eax, [esi+4]
test    eax, eax
jz      short loc_6e2f1ec6
push    eax
push    0
push    hheap
call    ds:heapfree
test    [esp+4+arg_0], 1
jz      short loc_6e2f1ed4
mov     ecx, esi
call    sub_6e2f1906
mov     eax, esi
pop     esi
retn    4
push    ebp
mov     ebp, esp
sub     esp, 20ch
push    ebx
mov     ebx, [ebp+arg_0]
push    esi
push    edi
mov     edi, ecx
xor     esi, esi
mov     ax, [ebx]
test    ax, ax
jz      loc_6e2f2003
cmp     esi, 104h
jge     loc_6e2f1fff
cmp     ax, 25h
jnz     loc_6e2f1fef
inc     ebx
push    25h
inc     ebx
push    ebx
call    ds:wcschr
pop     ecx
mov     [ebp+arg_0], eax
test    eax, eax
pop     ecx
jz      loc_6e2f1fff
and     word ptr [eax], 0
push    offset asignup
push    ebx
call    ds:lstrcmpiw
test    eax, eax
jnz     short loc_6e2f1f54
push    dword ptr [edi+30h]
lea     eax, [ebp+esi*2+string1]
push    eax
call    ds:lstrcpyw
add     esi, [edi+40h]
jmp     loc_6e2f1fea
push    offset awindows
push    ebx
call    ds:lstrcmpiw
test    eax, eax
jnz     short loc_6e2f1f7a
push    dword ptr [edi+20h]
lea     eax, [ebp+esi*2+string1]
push    eax
call    ds:lstrcpyw
add     esi, [edi+34h]
jmp     short loc_6e2f1fea
push    offset asystem
push    ebx
call    ds:lstrcmpiw
test    eax, eax
jnz     short loc_6e2f1fa0
push    dword ptr [edi+24h]
lea     eax, [ebp+esi*2+string1]
push    eax
call    ds:lstrcpyw
add     esi, [edi+38h]
jmp     short loc_6e2f1fea
push    offset atemp
push    ebx
call    ds:lstrcmpiw
test    eax, eax
jnz     short loc_6e2f1fc6
push    dword ptr [edi+28h]
lea     eax, [ebp+esi*2+string1]
push    eax
call    ds:lstrcpyw
add     esi, [edi+3ch]
jmp     short loc_6e2f1fea
push    offset aicw98dir
push    ebx
call    ds:lstrcmpiw
test    eax, eax
jnz     short loc_6e2f1fff
push    dword ptr [edi+2ch]
lea     eax, [ebp+esi*2+string1]
push    eax
call    ds:lstrcpyw
add     esi, [edi+44h]
mov     ebx, [ebp+arg_0]
jmp     short loc_6e2f1ff8
mov     [ebp+esi*2+string1], ax
inc     esi
inc     ebx
inc     ebx
jmp     loc_6e2f1eed
xor     eax, eax
jmp     short loc_6e2f2017
and     [ebp+esi*2+string1], 0
lea     ecx, [ebp+string1]
call    sub_6e2f1aff
pop     edi
pop     esi
pop     ebx
leave
retn    4
cmp     byte ptr [ecx], 0
jz      short loc_6e2f2046
push    0dh
push    ecx
call    ds:strchr
pop     ecx
test    eax, eax
pop     ecx
jz      short loc_6e2f2046
cmp     byte ptr [eax+1], 0ah
lea     ecx, [eax+1]
jnz     short sub_6e2f201e
and     byte ptr [eax+1], 0
and     byte ptr [eax], 0
add     eax, 2
retn
xor     eax, eax
retn
push    ecx
push    ecx
push    ebx
push    ebp
mov     ebp, ds:lstrlena
push    esi
push    edi
mov     edi, ecx
mov     [esp+18h+lpstring2], edx
push    edi
call    ebp
mov     ebx, eax
add     ebx, edi
xor     esi, esi
mov     [esp+18h+var_8], esi
cmp     edi, ebx
jnb     short loc_6e2f20a7
push    offset asc_6e2f13e0
push    edi
call    ds:strtok
cmp     [esp+20h+var_8], 0
pop     ecx
pop     ecx
mov     esi, eax
jnz     short loc_6e2f20ae
test    esi, esi
jz      short loc_6e2f20a7
push    esi
call    ebp
lea     edi, [eax+esi+1]
push    [esp+18h+lpstring2]
push    esi
call    ds:lstrcmpia
test    eax, eax
jnz     short loc_6e2f2068
mov     [esp+18h+var_8], 1
jmp     short loc_6e2f2068
cmp     [esp+18h+var_8], 0
jz      short loc_6e2f20cd
test    esi, esi
jz      short loc_6e2f20cd
cmp     byte ptr [esi], 22h
jnz     short loc_6e2f20b8
inc     esi
push    esi
call    ebp
cmp     byte ptr [eax+esi-1], 22h
lea     eax, [eax+esi-1]
jnz     short loc_6e2f20c9
and     byte ptr [eax], 0
mov     eax, esi
jmp     short loc_6e2f20cf
xor     eax, eax
pop     edi
pop     esi
pop     ebp
pop     ebx
pop     ecx
pop     ecx
retn
push    ecx
push    ecx
mov     eax, [esp+8+arg_4]
push    ebx
push    ebp
push    esi
test    eax, eax
push    edi
mov     esi, edx
jz      short loc_6e2f20e9
and     dword ptr [eax], 0
mov     eax, [esp+18h+arg_0]
test    eax, eax
jz      short loc_6e2f20f4
and     dword ptr [eax], 0
test    esi, esi
jz      short loc_6e2f20fb
and     dword ptr [esi], 0
test    ecx, ecx
mov     ebp, ecx
jz      loc_6e2f223f
mov     edi, ds:lstrlena
mov     ecx, ebp
call    sub_6e2f201e
cmp     byte ptr [ebp+0], 0
mov     [esp+18h+var_4], eax
jz      loc_6e2f223d
push    offset asc_6e2f1438
push    ebp
call    ds:strtok
mov     ebp, eax
pop     ecx
test    ebp, ebp
pop     ecx
jz      loc_6e2f222f
push    ebp
call    edi
lea     ebx, [eax+ebp+1]
push    offset amultipartmixed
push    ebp
call    ds:lstrcmpia
test    eax, eax
jnz     short loc_6e2f21ac
test    esi, esi
jz      loc_6e2f222f
mov     edx, offset aboundary
mov     ecx, ebx
call    sub_6e2f2049
mov     ebp, eax
test    ebp, ebp
jz      loc_6e2f222f
push    ebp
call    edi
lea     eax, [eax+eax+6]
push    eax
push    8
push    hheap
call    ds:heapalloc
mov     [esi], eax
mov     word ptr [eax+2], 2dh
mov     eax, [esi]
push    ebp
mov     word ptr [eax], 2dh
call    edi
inc     eax
push    eax
mov     eax, [esi]
add     eax, 4
push    ebp
push    eax
call    ds:mbstowcs
add     esp, 0ch
jmp     loc_6e2f222f
push    offset acontentdisposi
push    ebp
call    ds:lstrcmpia
test    eax, eax
jnz     short loc_6e2f222f
push    offset asc_6e2f1438
push    ebx
call    ds:strtok
mov     ebp, eax
pop     ecx
test    ebp, ebp
pop     ecx
jz      short loc_6e2f222f
push    ebp
call    edi
mov     ebx, ds:lstrcmpia
lea     eax, [eax+ebp+1]
push    offset ainline
push    ebp
mov     [esp+20h+string], eax
call    ebx
test    eax, eax
jnz     short loc_6e2f21fd
mov     eax, [esp+18h+arg_4]
test    eax, eax
jz      short loc_6e2f2209
mov     dword ptr [eax], 1
jmp     short loc_6e2f2209
push    offset aattachment
push    ebp
call    ebx
test    eax, eax
jnz     short loc_6e2f222f
cmp     [esp+18h+arg_0], 0
jz      short loc_6e2f222f
mov     ecx, [esp+18h+string]
mov     edx, offset afilename
call    sub_6e2f2049
test    eax, eax
jz      short loc_6e2f222f
mov     ecx, eax
call    sub_6e2f1b39
mov     ecx, [esp+18h+arg_0]
mov     [ecx], eax
mov     ebp, [esp+18h+var_4]
test    ebp, ebp
jnz     loc_6e2f210b
jmp     short loc_6e2f223f
mov     ebp, eax
pop     edi
mov     eax, ebp
pop     esi
pop     ebp
pop     ebx
pop     ecx
pop     ecx
retn    8
push    ebp
mov     ebp, esp
sub     esp, 310h
push    ebx
push    esi
mov     esi, ecx
xor     ebx, ebx
push    edi
mov     [ebp+dwflags], 1fh
mov     eax, [esi+8]
cmp     eax, ebx
jz      loc_6e2f23c2
mov     ecx, [esi+4]
cmp     ecx, ebx
jz      loc_6e2f23c2
push    esi
push    84000000h
push    ebx
push    ebx
push    ecx
push    eax
call    ds:internetopenurlw
cmp     eax, ebx
mov     [esi+0ch], eax
jnz     short loc_6e2f2307
cmp     [esi+8], ebx
jnz     short loc_6e2f229e
call    ds:getlasterror
jmp     loc_6e2f23c5
call    ds:getlasterror
mov     edi, eax
cmp     edi, 2
jnz     short loc_6e2f22d2
push    ebx
push    ebx
lea     eax, [ebp+dwflags]
push    ebx
push    eax
mov     [ebp+dwflags], ebx
call    ds:internetgetconnectedstateexw
test    byte ptr [ebp+dwflags], 20h
jz      short loc_6e2f22d2
cmp     dword_6e2f400c, ebx
jz      short loc_6e2f22d9
push    20h
mov     dword_6e2f400c, ebx
pop     edi
mov     eax, edi
jmp     loc_6e2f23c5
xor     eax, eax
lea     edi, [ebp+buffer]
stosd
stosd
push    1
lea     eax, [ebp+buffer]
pop     edi
push    8
push    eax
push    32h
push    ebx
mov     [ebp+buffer], edi
call    ds:internetsetoptionw
mov     ecx, esi
mov     dword_6e2f400c, edi
call    sub_6e2f224a
jmp     loc_6e2f23c5
mov     edi, ds:httpqueryinfow
lea     ecx, [ebp+dwbufferlength]
push    ebx
push    ecx
lea     ecx, [ebp+string]
mov     [ebp+dwbufferlength], 200h
push    ecx
push    5
push    eax
call    edi
test    eax, eax
jz      short loc_6e2f233c
lea     eax, [ebp+string]
push    eax
call    ds:_wtol
pop     ecx
mov     [esi+10h], eax
jmp     short loc_6e2f233f
mov     [esi+10h], ebx
lea     eax, [ebp+dwbufferlength]
push    ebx
push    eax
lea     eax, [ebp+string]
push    eax
push    1
push    dword ptr [esi+0ch]
mov     [ebp+dwbufferlength], 200h
call    edi
test    eax, eax
jz      short loc_6e2f23ac
mov     edi, ds:lstrlenw
lea     eax, [ebp+string]
push    eax
call    edi
inc     eax
push    eax
lea     eax, [ebp+string]
push    eax
lea     eax, [ebp+dest]
push    eax
call    ds:wcstombs
add     esp, 0ch
lea     edx, [esi+18h]
lea     ecx, [ebp+dest]
push    ebx
push    ebx
call    sub_6e2f20d6
mov     eax, [esi+18h]
cmp     eax, ebx
jz      short loc_6e2f23ac
push    eax
call    edi
mov     ecx, esi
mov     [esi+1ch], eax
call    sub_6e2f25b8
mov     [ebp+dwflags], eax
mov     eax, [esi+0ch]
cmp     eax, ebx
jz      short loc_6e2f23ba
push    eax
call    ds:internetclosehandle
mov     eax, [ebp+dwflags]
mov     [esi+0ch], ebx
jmp     short loc_6e2f23c5
push    57h
pop     eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
push    edi
mov     edi, [ecx+48h]
add     [ecx+14h], eax
mov     eax, [ecx+14h]
test    edi, edi
jz      short loc_6e2f2407
push    esi
mov     esi, [ecx+10h]
test    esi, esi
jz      short loc_6e2f23f2
imul    eax, 64h
xor     edx, edx
div     esi
mov     [ebp+arg_0], eax
jmp     short loc_6e2f23f6
and     [ebp+arg_0], 0
lea     eax, [ebp+arg_0]
push    4
push    eax
push    63h
push    dword ptr [ecx+54h]
push    dword ptr [ecx+0ch]
call    edi
pop     esi
pop     edi
pop     ebp
retn    4
push    ebp
mov     ebp, esp
push    ebx
mov     ebx, [ebp+arg_0]
push    esi
mov     esi, [ebp+dwnumberofbytesread]
cmp     esi, [ebp+arg_4]
push    edi
mov     edi, ecx
jnb     short loc_6e2f2456
lea     eax, [ebp+dwnumberofbytesread]
and     [ebp+dwnumberofbytesread], 0
push    eax
mov     eax, [ebp+arg_4]
sub     eax, esi
push    eax
lea     eax, [esi+ebx]
push    eax
push    dword ptr [edi+0ch]
call    ds:internetreadfile
test    eax, eax
jz      short loc_6e2f2456
cmp     [ebp+dwnumberofbytesread], 0
jz      short loc_6e2f2456
push    [ebp+dwnumberofbytesread]
mov     ecx, edi
call    sub_6e2f23ca
add     esi, [ebp+dwnumberofbytesread]
cmp     esi, [ebp+arg_4]
jb      short loc_6e2f241f
mov     ecx, [ebp+arg_4]
sub     ecx, esi
jz      short loc_6e2f2470
mov     edx, ecx
xor     eax, eax
lea     edi, [esi+ebx]
shr     ecx, 2
rep stosd
mov     ecx, edx
and     ecx, 3
rep stosb
mov     eax, esi
pop     edi
pop     esi
pop     ebx
pop     ebp
retn    0ch
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
push    esi
sub     eax, [ebp+src]
mov     esi, ecx
add     [ebp+size], eax
jz      short loc_6e2f249c
push    [ebp+size]
push    [ebp+src]
push    [ebp+arg_0]
call    ds:memmove
add     esp, 0ch
push    [ebp+size]
mov     ecx, esi
push    [ebp+arg_4]
push    [ebp+arg_0]
call    sub_6e2f240c
pop     esi
pop     ebp
retn    10h
push    ebp
mov     ebp, esp
sub     esp, 814h
push    ebx
push    esi
mov     esi, [ebp+arg_8]
push    edi
push    [ebp+lpmem]
mov     [ebp+var_4], ecx
or      dword ptr [esi], 0ffffffffh
call    sub_6e2f1eda
push    [ebp+lpmem]
xor     ebx, ebx
mov     edi, eax
push    ebx
push    hheap
call    ds:heapfree
cmp     edi, ebx
jnz     short loc_6e2f24ee
push    0dh
pop     eax
jmp     loc_6e2f258e
lea     eax, [ebp+ext]
push    eax
lea     eax, [ebp+filename]
push    eax
lea     eax, [ebp+dir]
push    eax
lea     eax, [ebp+drive]
push    eax
push    edi
call    ds:_wsplitpath
add     esp, 14h
lea     eax, [ebp+dir]
push    eax
lea     eax, [ebp+drive]
push    eax
lea     eax, [ebp+pathname]
push    offset ass
push    eax
call    ds:wsprintfw
add     esp, 10h
lea     eax, [ebp+pathname]
push    ebx
push    eax
call    ds:createdirectoryw
push    ebx
push    80h
push    4
push    ebx
push    ebx
push    40000000h
push    edi
call    ds:createfilew
cmp     eax, 0ffffffffh
mov     [esi], eax
jz      short loc_6e2f257b
push    0ch
pop     ecx
call    sub_6e2f1ba5
cmp     eax, ebx
jz      short loc_6e2f2575
mov     ecx, [ebp+arg_4]
mov     [eax], ebx
mov     [eax+4], edi
mov     [eax+8], ecx
jmp     short loc_6e2f2577
xor     eax, eax
cmp     eax, ebx
jnz     short loc_6e2f2583
call    ds:getlasterror
jmp     short loc_6e2f258e
mov     ecx, [ebp+var_4]
push    eax
call    sub_6e2f1bb8
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn    0ch
push    esi
mov     esi, edx
test    esi, esi
jz      short loc_6e2f25b2
push    [esp+4+cchbuffermax]
and     word ptr [esi], 0
push    esi
push    ecx
push    hinstance
call    ds:loadstringw
mov     eax, esi
pop     esi
retn    4
push    ebp
mov     ebp, esp
sub     esp, 24h
push    ebx
and     [ebp+var_18], 0
and     [ebp+lpmem], 0
or      [ebp+hfile], 0ffffffffh
push    esi
push    edi
push    200ah
push    8
push    hheap
mov     ebx, ecx
mov     [ebp+var_24], ebx
call    ds:heapalloc
mov     esi, eax
test    esi, esi
jnz     short loc_6e2f25f7
mov     [ebp+numberofbyteswritten], 8007000eh
jmp     loc_6e2f27af
mov     ecx, [ebx+18h]
call    sub_6e2f1890
mov     [ebp+var_18], eax
mov     edi, 1000h
push    0
push    edi
push    esi
mov     ecx, ebx
call    sub_6e2f240c
test    eax, eax
mov     [ebp+size], eax
jz      loc_6e2f279b
mov     ecx, [ebp+var_18]
push    eax
mov     edx, esi
call    sub_6e2f1916
test    eax, eax
jz      short loc_6e2f2607
add     eax, [ebx+1ch]
mov     ecx, ebx
push    eax
push    [ebp+size]
push    edi
push    esi
call    sub_6e2f2479
test    eax, eax
mov     [ebp+size], eax
jz      loc_6e2f279b
cmp     byte ptr [esi], 2dh
jnz     short loc_6e2f2656
cmp     byte ptr [esi+1], 2dh
jz      loc_6e2f278c
and     [ebp+lpstring], 0
and     [ebp+var_20], 0
lea     eax, [ebp+var_20]
xor     edx, edx
push    eax
lea     eax, [ebp+lpstring]
push    eax
lea     ecx, [esi+2]
call    sub_6e2f20d6
cmp     [ebp+lpstring], 0
mov     [ebp+src], eax
jz      loc_6e2f27a8
test    eax, eax
jz      loc_6e2f27a8
push    [ebp+lpstring]
call    ds:lstrlenw
lea     eax, [eax+eax+2]
push    eax
push    8
push    hheap
call    ds:heapalloc
push    [ebp+lpstring]
mov     [ebp+lpmem], eax
push    eax
call    ds:lstrcpyw
lea     eax, [ebp+hfile]
mov     ecx, ebx
push    eax
push    [ebp+var_20]
push    [ebp+lpstring]
call    sub_6e2f24b1
test    eax, eax
mov     [ebp+numberofbyteswritten], eax
jnz     loc_6e2f27af
push    [ebp+src]
mov     ecx, ebx
push    [ebp+size]
push    edi
push    esi
call    sub_6e2f2479
and     [ebp+src], 0
mov     [ebp+size], eax
test    eax, eax
jz      short loc_6e2f274f
push    [ebp+size]
mov     ecx, [ebp+var_18]
and     [ebp+numberofbyteswritten], 0
mov     edx, esi
call    sub_6e2f1916
mov     ebx, eax
test    ebx, ebx
mov     [ebp+src], ebx
jz      short loc_6e2f2702
sub     ebx, esi
jmp     short loc_6e2f270d
mov     ebx, [ebp+size]
cmp     ebx, 64h
jbe     short loc_6e2f270d
add     ebx, 0ffffff9ch
test    ebx, ebx
jz      short loc_6e2f272f
and     [ebp+numberofbyteswritten], 0
lea     eax, [ebp+numberofbyteswritten]
push    0
push    eax
push    ebx
push    esi
push    [ebp+hfile]
call    ds:writefile
test    eax, eax
jz      short loc_6e2f2790
cmp     [ebp+numberofbyteswritten], ebx
jnz     short loc_6e2f2790
cmp     [ebp+src], 0
jnz     short loc_6e2f274c
add     ebx, esi
mov     ecx, [ebp+var_24]
push    ebx
push    [ebp+size]
push    edi
push    esi
call    sub_6e2f2479
test    eax, eax
mov     [ebp+size], eax
jnz     short loc_6e2f26e4
mov     ebx, [ebp+var_24]
push    [ebp+hfile]
call    ds:setendoffile
push    [ebp+hfile]
call    ds:closehandle
or      [ebp+hfile], 0ffffffffh
cmp     [ebp+lpmem], 0
jz      short loc_6e2f2780
push    [ebp+lpmem]
push    0
push    hheap
call    ds:heapfree
and     [ebp+lpmem], 0
mov     eax, [ebp+src]
test    eax, eax
jz      short loc_6e2f279b
jmp     loc_6e2f262c
xor     eax, eax
jmp     short loc_6e2f27f6
call    ds:getlasterror
mov     [ebp+numberofbyteswritten], eax
jmp     short loc_6e2f27af
call    ds:getlasterror
test    eax, eax
mov     [ebp+numberofbyteswritten], eax
jnz     short loc_6e2f27af
mov     [ebp+numberofbyteswritten], 0dh
xor     edi, edi
cmp     esi, edi
jz      short loc_6e2f27c3
push    esi
push    edi
push    hheap
call    ds:heapfree
mov     ecx, [ebp+var_18]
cmp     ecx, edi
jz      short loc_6e2f27cf
call    sub_6e2f1906
cmp     [ebp+lpmem], edi
jz      short loc_6e2f27e4
push    [ebp+lpmem]
push    edi
push    hheap
call    ds:heapfree
cmp     [ebp+hfile], 0ffffffffh
jz      short loc_6e2f27f3
push    [ebp+hfile]
call    ds:closehandle
mov     eax, [ebp+numberofbyteswritten]
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 5ch
push    ebx
push    esi
push    edi
xor     eax, eax
lea     edi, [ebp+processinformation]
mov     ebx, edx
stosd
stosd
stosd
mov     edx, ecx
push    11h
stosd
pop     ecx
xor     eax, eax
lea     edi, [ebp+startupinfo]
xor     esi, esi
rep stosd
lea     eax, [ebp+processinformation]
push    eax
lea     eax, [ebp+startupinfo]
push    eax
push    esi
push    esi
push    esi
push    1
push    esi
push    esi
push    esi
push    edx
call    ds:createprocessw
test    eax, eax
jnz     short loc_6e2f2840
call    ds:getlasterror
jmp     short loc_6e2f2890
mov     eax, [ebp+processinformation.hprocess]
push    offset aicwdlhandleexe
mov     [ebp+handles], ebx
mov     [ebp+var_4], eax
call    sub_6e2f1b79
pop     ecx
lea     eax, [ebp+handles]
push    0ffffffffh
push    esi
push    eax
push    2
call    ds:waitformultipleobjects
cmp     eax, esi
mov     eax, offset ahcancelsemapho
jz      short loc_6e2f2871
mov     eax, offset apihprocess
push    eax
push    offset aicwdlhandleexe_0
call    sub_6e2f1b79
mov     esi, ds:closehandle
pop     ecx
pop     ecx
push    [ebp+processinformation.hthread]
call    esi
push    [ebp+processinformation.hprocess]
call    esi
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 268h
push    ebx
push    esi
push    edi
lea     eax, [ebp+string1]
push    offset aregedits
mov     [ebp+var_4], edx
mov     edi, ecx
push    eax
call    ds:lstrcpyw
xor     ebx, ebx
cmp     word ptr [edi], 22h
jz      short loc_6e2f2901
mov     esi, ds:lstrcatw
lea     eax, [ebp+string1]
push    offset asc_6e2f1524
push    eax
call    esi
lea     eax, [ebp+string1]
push    edi
push    eax
call    esi
lea     eax, [ebp+string1]
push    eax
call    ds:lstrlenw
add     eax, eax
mov     [ebp+eax+string1], 22h
mov     [ebp+eax+var_266], bx
jmp     short loc_6e2f290f
lea     eax, [ebp+string1]
push    edi
push    eax
call    ds:lstrcatw
xor     eax, eax
lea     edi, [ebp+processinformation]
stosd
stosd
stosd
stosd
push    11h
xor     eax, eax
pop     ecx
lea     edi, [ebp+startupinfo]
rep stosd
push    1
lea     ecx, [ebp+processinformation]
pop     eax
mov     [ebp+startupinfo.wshowwindow], bx
push    ecx
lea     ecx, [ebp+startupinfo]
push    ecx
push    ebx
push    ebx
push    ebx
mov     [ebp+startupinfo.dwflags], eax
push    eax
push    ebx
lea     eax, [ebp+string1]
push    ebx
push    eax
push    ebx
call    ds:createprocessw
test    eax, eax
jnz     short loc_6e2f2954
call    ds:getlasterror
jmp     short loc_6e2f29a7
mov     eax, [ebp+var_4]
push    offset aicwdlhandlereg
mov     [ebp+handles], eax
mov     eax, [ebp+processinformation.hprocess]
mov     [ebp+var_4], eax
call    sub_6e2f1b79
pop     ecx
lea     eax, [ebp+handles]
push    0ffffffffh
push    ebx
push    eax
push    2
call    ds:waitformultipleobjects
cmp     eax, ebx
mov     eax, offset ahcancelsemapho
jz      short loc_6e2f2988
mov     eax, offset apihprocess
push    eax
push    offset aicwdlhandlereg_0
call    sub_6e2f1b79
mov     esi, ds:closehandle
pop     ecx
pop     ecx
push    [ebp+processinformation.hthread]
call    esi
push    [ebp+processinformation.hprocess]
call    esi
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 268h
push    ebx
push    esi
xor     esi, esi
cmp     word ptr [ecx], 22h
push    edi
mov     ebx, edx
push    ecx
jz      short loc_6e2f29fb
lea     eax, [ebp+string]
push    offset arundllsetupxdl
push    eax
call    ds:wsprintfw
add     esp, 0ch
lea     eax, [ebp+string]
push    eax
call    ds:lstrlenw
add     eax, eax
mov     [ebp+eax+string], 22h
mov     [ebp+eax+var_266], si
jmp     short loc_6e2f2a10
lea     eax, [ebp+string]
push    offset arundllsetupxdl_0
push    eax
call    ds:wsprintfw
add     esp, 0ch
xor     eax, eax
lea     edi, [ebp+processinformation]
stosd
stosd
stosd
stosd
push    11h
xor     eax, eax
pop     ecx
lea     edi, [ebp+startupinfo]
rep stosd
push    1
lea     ecx, [ebp+processinformation]
pop     eax
mov     [ebp+startupinfo.cb], 44h
push    ecx
lea     ecx, [ebp+startupinfo]
push    ecx
push    esi
push    esi
push    esi
mov     [ebp+startupinfo.dwflags], eax
push    eax
push    esi
lea     eax, [ebp+string]
push    esi
push    eax
push    esi
mov     [ebp+startupinfo.wshowwindow], 5
call    ds:createprocessw
test    eax, eax
jnz     short loc_6e2f2a5e
call    ds:getlasterror
jmp     short loc_6e2f2aae
mov     eax, [ebp+processinformation.hprocess]
push    offset aicwdlhandleinf
mov     [ebp+handles], ebx
mov     [ebp+var_4], eax
call    sub_6e2f1b79
pop     ecx
lea     eax, [ebp+handles]
push    0ffffffffh
push    esi
push    eax
push    2
call    ds:waitformultipleobjects
cmp     eax, esi
mov     eax, offset ahcancelsemapho
jz      short loc_6e2f2a8f
mov     eax, offset apihprocess
push    eax
push    offset aicwdlhandleinf_0
call    sub_6e2f1b79
mov     esi, ds:closehandle
pop     ecx
pop     ecx
push    [ebp+processinformation.hthread]
call    esi
push    [ebp+processinformation.hprocess]
call    esi
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 0ch
lea     eax, [ebp+ppv]
push    esi
push    eax
push    offset riid
push    1
push    0
mov     esi, ecx
push    offset rclsid
call    ds:cocreateinstance
test    eax, eax
jl      loc_6e2f2b67
mov     eax, [ebp+ppv]
lea     edx, [ebp+var_c]
push    edx
push    offset dword_6e2f1880
mov     ecx, [eax]
push    eax
call    dword ptr [ecx]
test    eax, eax
jl      short loc_6e2f2b5e
mov     eax, [ebp+var_c]
push    0
push    [ebp+ppmalloc]
mov     ecx, [eax]
push    eax
call    dword ptr [ecx+14h]
test    eax, eax
jl      short loc_6e2f2b55
mov     eax, [ebp+ppv]
lea     edx, [ebp+lpstring]
push    edx
push    eax
mov     ecx, [eax]
call    dword ptr [ecx+10h]
test    eax, eax
jl      short loc_6e2f2b55
cmp     [ebp+lpstring], 0
jz      short loc_6e2f2b55
push    [ebp+lpstring]
call    ds:lstrlenw
push    eax
push    [ebp+lpstring]
push    64h
push    dword ptr [esi+54h]
push    dword ptr [esi+0ch]
call    dword ptr [esi+48h]
lea     eax, [ebp+ppmalloc]
push    eax
call    ds:shgetmalloc
test    eax, eax
jl      short loc_6e2f2b55
mov     eax, [ebp+ppmalloc]
push    [ebp+lpstring]
mov     ecx, [eax]
push    eax
call    dword ptr [ecx+14h]
mov     eax, [ebp+ppmalloc]
push    eax
mov     ecx, [eax]
call    dword ptr [ecx+8]
mov     eax, [ebp+var_c]
push    eax
mov     ecx, [eax]
call    dword ptr [ecx+8]
mov     eax, [ebp+ppv]
push    eax
mov     ecx, [eax]
call    dword ptr [ecx+8]
xor     eax, eax
pop     esi
leave
retn    4
push    ebp
mov     ebp, esp
sub     esp, 218h
push    ebx
push    esi
push    edi
mov     edi, ds:lstrcpyw
lea     eax, [ebp+string1]
push    ecx
push    eax
mov     [ebp+var_8], ecx
call    edi
mov     esi, ds:lstrlenw
lea     eax, [ebp+string1]
push    eax
call    esi
cmp     eax, 4
jle     loc_6e2f2c58
lea     eax, [ebp+string1]
push    eax
call    esi
lea     esi, [ebp+eax*2+var_220]
push    offset aphb
push    esi
call    edi
cmp     word ptr [esi], 5ch
jz      short loc_6e2f2bd1
lea     eax, [ebp+string1]
cmp     esi, eax
jbe     short loc_6e2f2bd1
dec     esi
dec     esi
jmp     short loc_6e2f2bbd
lea     eax, [ebp+filepart]
add     esi, 2
push    eax
lea     eax, [ebp+string1]
push    eax
push    104h
push    0
push    esi
push    0
call    ds:searchpathw
test    eax, eax
jz      short loc_6e2f2c47
push    offset libfilename
call    ds:loadlibraryw
mov     ebx, eax
test    ebx, ebx
jz      short loc_6e2f2c47
mov     esi, ds:getprocaddress
push    offset procname
push    ebx
call    esi
test    eax, eax
jz      short loc_6e2f2c47
lea     ecx, [ebp+var_4]
push    ecx
push    [ebp+var_8]
call    eax
mov     edi, eax
test    edi, edi
jnz     short loc_6e2f2c5b
push    offset aphonebookmerge
push    ebx
call    esi
test    eax, eax
jz      short loc_6e2f2c47
push    [ebp+var_8]
push    [ebp+var_4]
call    eax
mov     edi, eax
push    offset aphonebookunloa
push    ebx
call    esi
test    eax, eax
jnz     short loc_6e2f2c51
call    ds:getlasterror
mov     edi, eax
jmp     short loc_6e2f2c5b
push    [ebp+var_4]
call    eax
jmp     short loc_6e2f2c5b
push    57h
pop     edi
mov     eax, edi
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 20ch
push    esi
mov     esi, ecx
push    edi
xor     edi, edi
cmp     word ptr [esi], 22h
jz      short loc_6e2f2cba
lea     eax, [ebp+string1]
push    offset asc_6e2f1524
push    eax
call    ds:lstrcpyw
lea     eax, [ebp+string1]
push    esi
push    eax
call    ds:lstrcatw
lea     eax, [ebp+string1]
push    eax
call    ds:lstrlenw
add     eax, eax
mov     [ebp+eax+string1], 22h
mov     [ebp+eax+var_20a], di
jmp     short loc_6e2f2cd0
push    esi
call    ds:lstrlenw
push    eax
lea     eax, [ebp+string1]
push    esi
push    eax
call    ds:lstrcpynw
push    1
push    edi
lea     eax, [ebp+string1]
push    edi
push    eax
push    edi
push    edi
call    ds:shellexecutew
mov     ecx, eax
cmp     ecx, 20h
pop     edi
sbb     eax, eax
pop     esi
and     eax, ecx
leave
retn
push    2eh
push    ecx
call    ds:wcsrchr
pop     ecx
test    eax, eax
pop     ecx
jz      short loc_6e2f2d03
add     eax, 2
retn
xor     eax, eax
retn
push    ecx
and     [esp+4+var_4], 0
push    ebx
mov     ebx, ecx
push    esi
mov     esi, [ebx]
test    esi, esi
jz      loc_6e2f2df3
push    edi
push    ebp
mov     ebp, ds:lstrcmpiw
cmp     dword ptr [esi+8], 0
jz      loc_6e2f2de7
mov     ecx, [esi+4]
call    sub_6e2f2cf0
mov     edi, eax
test    edi, edi
jz      loc_6e2f2de7
push    offset acab
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2d57
mov     ecx, [esi+4]
call    sub_6e2f314c
jmp     loc_6e2f2dd8
push    offset aexe
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2d70
mov     edx, [ebx+50h]
mov     ecx, [esi+4]
call    sub_6e2f27fb
jmp     short loc_6e2f2dd8
push    offset areg
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2d89
mov     edx, [ebx+50h]
mov     ecx, [esi+4]
call    sub_6e2f2895
jmp     short loc_6e2f2dd8
push    offset achg
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2d9f
mov     ecx, [esi+4]
call    sub_6e2f2b6e
jmp     short loc_6e2f2dd8
push    offset ainf
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2db8
mov     edx, [ebx+50h]
mov     ecx, [esi+4]
call    sub_6e2f29ac
jmp     short loc_6e2f2dd8
push    offset aurl
push    edi
call    ebp
test    eax, eax
jnz     short loc_6e2f2dd0
push    dword ptr [esi+4]
mov     ecx, ebx
call    sub_6e2f2ab3
jmp     short loc_6e2f2dd8
mov     ecx, [esi+4]
call    sub_6e2f2c62
cmp     [esp+14h+var_4], 0
jnz     short loc_6e2f2de7
test    eax, eax
jz      short loc_6e2f2de7
mov     [esp+14h+var_4], eax
mov     esi, [esi]
test    esi, esi
jnz     loc_6e2f2d22
pop     ebp
pop     edi
mov     eax, [esp+0ch+var_4]
pop     esi
pop     ebx
pop     ecx
retn
mov     edx, [esp+arg_0]
xor     eax, eax
test    edx, edx
jnz     short loc_6e2f2e0a
push    57h
pop     eax
jmp     short locret_6e2f2e0d
mov     [ecx+48h], edx
retn    4
mov     eax, [esp+arg_c]
push    esi
push    edi
push    8
pop     edi
mov     dword_6e2f4008, eax
push    58h
pop     ecx
call    sub_6e2f1ba5
test    eax, eax
jz      short loc_6e2f2e39
push    [esp+8+arg_0]
mov     ecx, eax
call    sub_6e2f1bcb
mov     esi, eax
jmp     short loc_6e2f2e3b
xor     esi, esi
test    esi, esi
jz      short loc_6e2f2e80
mov     eax, [esp+8+arg_8]
xor     edi, edi
push    offset name
push    1
mov     [eax], esi
mov     eax, [esp+10h+arg_4]
push    edi
push    edi
mov     [esi+54h], eax
call    ds:createsemaphorew
mov     [esi+50h], eax
mov     esi, 0b7h
test    eax, eax
jz      short loc_6e2f2e73
call    ds:getlasterror
cmp     eax, esi
jnz     short loc_6e2f2e80
push    offset aicwdlunabletoc
call    sub_6e2f1b79
pop     ecx
mov     edi, esi
mov     eax, edi
pop     edi
pop     esi
retn    10h
push    esi
push    offset aicwdldownloadc_0
call    sub_6e2f1b79
mov     esi, [esp+8+arg_0]
pop     ecx
test    esi, esi
jz      short loc_6e2f2ec5
push    offset aicwdldownloadc_1
call    sub_6e2f1b79
pop     ecx
push    0
push    1
push    dword ptr [esi+50h]
call    ds:releasesemaphore
mov     esi, [esi+0ch]
test    esi, esi
jz      short loc_6e2f2ec1
push    esi
call    ds:internetclosehandle
xor     eax, eax
jmp     short loc_6e2f2ec8
push    57h
pop     eax
pop     esi
retn    4
mov     ecx, [esp+arg_0]
test    ecx, ecx
jz      short loc_6e2f2edb
call    sub_6e2f224a
jmp     short locret_6e2f2ede
push    57h
pop     eax
retn    4
push    esi
push    offset aicwdldownloadc_2
call    sub_6e2f1b79
mov     esi, [esp+8+lpmem]
pop     ecx
test    esi, esi
jz      short loc_6e2f2f15
mov     eax, [esi+0ch]
test    eax, eax
jz      short loc_6e2f2f03
push    eax
call    ds:internetclosehandle
mov     ecx, esi
call    sub_6e2f1dd4
mov     ecx, esi
call    sub_6e2f1906
xor     eax, eax
jmp     short loc_6e2f2f18
push    57h
pop     eax
pop     esi
retn    4
mov     ecx, [esp+arg_0]
test    ecx, ecx
jz      short loc_6e2f2f2f
push    [esp+arg_4]
call    sub_6e2f2dfb
jmp     short locret_6e2f2f32
push    57h
pop     eax
retn    8
push    offset aicwdldownloadp
call    sub_6e2f1b79
pop     ecx
mov     ecx, [esp+arg_0]
test    ecx, ecx
jz      short loc_6e2f2f4f
call    sub_6e2f2d06
jmp     short locret_6e2f2f52
push    57h
pop     eax
retn    4
push    ebp
mov     ebp, esp
push    esi
push    edi
xor     edi, edi
cmp     hlibmodule, edi
jnz     short loc_6e2f2fe1
push    offset acabinet
call    ds:loadlibraryw
cmp     eax, edi
mov     hlibmodule, eax
jz      loc_6e2f3033
mov     esi, ds:getprocaddress
push    offset afdicreate
push    eax
call    esi
push    offset afdicopy
mov     dword_6e2f4014, eax
push    hlibmodule
call    esi
push    offset afdiiscabinet
mov     dword_6e2f401c, eax
push    hlibmodule
call    esi
push    offset afdidestroy
mov     dword_6e2f4018, eax
push    hlibmodule
call    esi
cmp     dword_6e2f4014, edi
mov     dword_6e2f4020, eax
jz      short loc_6e2f3021
cmp     dword_6e2f401c, edi
jz      short loc_6e2f3021
cmp     dword_6e2f4018, edi
jz      short loc_6e2f3021
cmp     eax, edi
jz      short loc_6e2f3021
push    [ebp+arg_20]
push    [ebp+arg_1c]
push    [ebp+arg_18]
push    [ebp+arg_14]
push    [ebp+arg_10]
push    [ebp+arg_c]
push    [ebp+arg_8]
push    [ebp+arg_4]
push    [ebp+arg_0]
call    dword_6e2f4014
mov     esi, eax
add     esp, 24h
cmp     esi, edi
jnz     short loc_6e2f301d
push    hlibmodule
call    ds:freelibrary
mov     hlibmodule, edi
mov     eax, esi
jmp     short loc_6e2f3035
push    hlibmodule
call    ds:freelibrary
mov     hlibmodule, edi
xor     eax, eax
pop     edi
pop     esi
pop     ebp
retn
mov     eax, dword_6e2f4018
test    eax, eax
jnz     short loc_6e2f3043
retn
push    [esp+arg_8]
push    [esp+4+arg_4]
push    [esp+8+arg_0]
call    eax
add     esp, 0ch
retn
push    ebp
mov     ebp, esp
mov     eax, dword_6e2f401c
test    eax, eax
jnz     short loc_6e2f3063
pop     ebp
retn
push    [ebp+arg_18]
push    [ebp+arg_14]
push    [ebp+arg_10]
push    [ebp+arg_c]
push    [ebp+arg_8]
push    [ebp+arg_4]
push    [ebp+arg_0]
call    eax
add     esp, 1ch
pop     ebp
retn
mov     eax, dword_6e2f4020
test    eax, eax
jnz     short loc_6e2f3089
retn
push    [esp+arg_0]
call    eax
pop     ecx
retn
push    [esp+arg_0]
call    ??2@yapaxi@z
pop     ecx
retn
push    dword ptr [esp+4]
call    ??3@yaxpax@z
pop     ecx
retn
push    [esp+arg_8]
push    [esp+4+openflag]
push    [esp+8+filename]
call    ds:_open
add     esp, 0ch
retn
push    [esp+maxcharcount]
push    [esp+4+dstbuf]
push    [esp+8+filehandle]
call    ds:_read
add     esp, 0ch
retn
push    dword ptr [esp+0ch]
push    dword ptr [esp+0ch]
push    dword ptr [esp+0ch]
call    ds:_write
add     esp, 0ch
retn
push    [esp+filehandle]
call    ds:_close
pop     ecx
retn
push    dword ptr [esp+0ch]
push    dword ptr [esp+0ch]
push    dword ptr [esp+0ch]
call    ds:_lseek
add     esp, 0ch
retn
mov     eax, [esp+4]
sub     eax, 0
jz      short loc_6e2f311e
dec     eax
jz      short loc_6e2f311e
dec     eax
jz      short loc_6e2f3132
dec     eax
jz      short loc_6e2f3121
dec     eax
xor     eax, eax
retn
mov     eax, [esp+8]
push    dword ptr [eax+14h]
call    sub_6e2f30e9
pop     ecx
push    1
pop     eax
retn
mov     eax, [esp+8]
push    180h
push    8321h
push    dword ptr [eax+4]
call    sub_6e2f30a7
add     esp, 0ch
retn
push    ebp
mov     ebp, esp
sub     esp, 83ch
push    ebx
push    esi
push    edi
push    105h
lea     eax, [ebp+dest]
xor     ebx, ebx
push    ecx
push    eax
mov     [ebp+var_8], ebx
call    ds:wcstombs
add     esp, 0ch
lea     eax, [ebp+buffer]
push    eax
push    104h
call    ds:getcurrentdirectorya
test    eax, eax
jz      loc_6e2f3358
lea     eax, [ebp+ext]
push    eax
lea     eax, [ebp+filename]
push    eax
lea     eax, [ebp+dir]
push    eax
lea     eax, [ebp+drive]
push    eax
lea     eax, [ebp+dest]
push    eax
call    ds:_splitpath
add     esp, 14h
lea     eax, [ebp+dir]
push    eax
lea     eax, [ebp+drive]
push    eax
lea     eax, [ebp+pathname]
push    offset ass_0
push    eax
call    ds:wsprintfa
add     esp, 10h
lea     eax, [ebp+pathname]
push    eax
call    ds:setcurrentdirectorya
test    eax, eax
jz      loc_6e2f3358
lea     eax, [ebp+var_14]
or      esi, 0ffffffffh
push    eax
push    esi
push    offset loc_6e2f30f5
push    offset sub_6e2f30e9
push    offset loc_6e2f30d3
push    offset sub_6e2f30bd
push    offset sub_6e2f30a7
push    offset loc_6e2f309c
push    offset sub_6e2f3091
call    sub_6e2f2f55
mov     edi, eax
add     esp, 24h
cmp     edi, ebx
jz      loc_6e2f3345
push    ebx
lea     eax, [ebp+dest]
push    8020h
push    eax
call    sub_6e2f30a7
mov     esi, eax
add     esp, 0ch
cmp     esi, 0ffffffffh
jnz     short loc_6e2f3252
push    edi
call    sub_6e2f307f
pop     ecx
push    0fffffffeh
jmp     loc_6e2f333f
lea     eax, [ebp+var_2c]
push    eax
push    esi
push    edi
call    sub_6e2f3039
add     esp, 0ch
test    eax, eax
push    esi
jnz     short loc_6e2f327a
call    ds:_close
pop     ecx
push    edi
call    sub_6e2f307f
pop     ecx
push    0fffffffdh
jmp     loc_6e2f333f
call    ds:_close
pop     ecx
lea     eax, [ebp+dest]
push    5ch
push    eax
call    ds:strrchr
mov     esi, eax
pop     ecx
cmp     esi, ebx
pop     ecx
jnz     short loc_6e2f32be
mov     esi, ds:lstrcpya
lea     eax, [ebp+dest]
push    eax
lea     eax, [ebp+string1]
push    eax
call    esi
lea     eax, [ebp+destination]
push    offset byte_6e2f1850
push    eax
call    esi
jmp     short loc_6e2f3303
lea     eax, [esi+1]
push    eax
lea     eax, [ebp+string1]
push    eax
call    ds:lstrcpya
mov     eax, esi
lea     ecx, [ebp+dest]
sub     eax, ecx
inc     eax
push    eax
lea     eax, [ebp+dest]
push    eax
lea     eax, [ebp+destination]
push    eax
call    ds:strncpy
lea     eax, [ebp+esi+var_233]
lea     ecx, [ebp+dest]
add     esp, 0ch
sub     eax, ecx
mov     [eax], bl
push    ebx
push    ebx
push    offset loc_6e2f310b
lea     eax, [ebp+destination]
push    ebx
push    eax
lea     eax, [ebp+string1]
push    eax
push    edi
call    sub_6e2f3055
add     esp, 1ch
cmp     eax, 1
push    edi
jz      short loc_6e2f3332
call    sub_6e2f307f
pop     ecx
push    0fffffffch
jmp     short loc_6e2f333f
call    sub_6e2f307f
cmp     eax, 1
pop     ecx
jz      short loc_6e2f3342
push    0fffffffbh
pop     esi
jmp     short loc_6e2f3345
mov     esi, [ebp+var_8]
lea     eax, [ebp+buffer]
push    eax
call    ds:setcurrentdirectorya
test    eax, eax
mov     eax, esi
jnz     short loc_6e2f335e
call    ds:getlasterror
pop     edi
pop     esi
pop     ebx
leave
retn
mov     eax, hlibmodule
test    eax, eax
jz      short locret_6e2f3373
push    eax
call    ds:freelibrary
retn