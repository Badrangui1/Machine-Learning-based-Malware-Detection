xor     eax, eax
cmp     [esp+arg_0], 8007000eh
push    0
setz    al
push    0
push    1
dec     eax
and     eax, 6
add     eax, 0c0000017h
push    eax
call    ds:raiseexception
int     3
mov     eax, [esp+arg_0]
test    eax, eax
jz      short locret_401058
cmp     eax, 0ch
jz      short loc_401051
cmp     eax, 16h
jz      short loc_40104a
cmp     eax, 22h
jz      short loc_40104a
cmp     eax, 50h
jz      short locret_401058
push    80004005h
call    sub_401000
push    80070057h
jmp     short loc_401045
push    8007000eh
jmp     short loc_401045
retn
push    esi
push    [esp+4+hresinfo]
mov     esi, eax
push    [esp+8+hmodule]
call    ds:loadresource
test    eax, eax
jnz     short loc_401070
pop     esi
retn
push    edi
push    eax
call    ds:lockresource
mov     edi, eax
test    edi, edi
jz      short loc_4010a5
push    [esp+8+hresinfo]
push    [esp+0ch+hmodule]
call    ds:sizeofresource
add     eax, edi
and     esi, 0fh
jbe     short loc_4010a1
cmp     edi, eax
jnb     short loc_4010a5
dec     esi
movzx   ecx, word ptr [edi]
lea     edi, [edi+ecx*2+2]
jnz     short loc_401093
cmp     edi, eax
jb      short loc_4010a9
xor     eax, eax
jmp     short loc_4010b2
movzx   eax, word ptr [edi]
neg     eax
sbb     eax, eax
and     eax, edi
pop     edi
pop     esi
retn
lea     ecx, [eax+0ch]
or      edx, 0ffffffffh
lock xadd [ecx], edx
dec     edx
test    edx, edx
jg      short locret_4010cc
mov     ecx, [eax]
mov     edx, [ecx]
push    eax
call    dword ptr [edx+4]
retn
sub     esp, 80ch
mov     eax, dword_4109f8
xor     eax, esp
mov     [esp+80ch+var_4], eax
push    esi
push    0
mov     esi, ecx
call    ds:setlasterror
push    edi
push    esi
lea     eax, [esp+818h+var_80c]
push    eax
call    ds:wvsprintfw
mov     esi, eax
call    ds:getlasterror
test    eax, eax
jz      short loc_40110f
push    80004005h
call    sub_401000
mov     ecx, [esp+810h+var_4]
mov     eax, esi
pop     esi
xor     ecx, esp
call    sub_4088de
add     esp, 80ch
retn
push    ebp
mov     ebp, esp
sub     esp, 80ch
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+var_4], eax
push    esi
push    0
mov     esi, ecx
call    ds:setlasterror
push    edi
push    esi
lea     eax, [ebp+string]
push    eax
call    ds:wvsprintfw
mov     esi, eax
call    ds:getlasterror
test    eax, eax
jz      short loc_40116a
push    80004005h
call    sub_401000
cmp     esi, 400h
jg      short loc_401160
cmp     esi, [ebp+sizeinwords]
jb      short loc_40117e
push    80070057h
jmp     short loc_401165
lea     eax, [ebp+string]
push    eax
call    _wcslen
pop     ecx
cmp     eax, [ebp+sizeinwords]
jnb     short loc_401177
lea     eax, [ebp+string]
push    eax
push    [ebp+sizeinwords]
push    ebx
call    _wcscpy_s
push    eax
call    sub_401024
mov     ecx, [ebp+var_4]
add     esp, 10h
mov     eax, esi
xor     ecx, ebp
pop     esi
call    sub_4088de
leave
retn
push    ebp
lea     ebp, [esp-0a0h]
sub     esp, 120h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+0a0h+var_4], eax
push    11ch
lea     eax, [ebp+0a0h+versioninformation]
push    0
push    eax
call    _memset
add     esp, 0ch
lea     eax, [ebp+0a0h+versioninformation]
push    eax
mov     [ebp+0a0h+versioninformation.dwosversioninfosize], 11ch
call    ds:getversionexw
test    eax, eax
jnz     short loc_401200
xor     al, al
jmp     short loc_401220
cmp     [ebp+0a0h+versioninformation.dwmajorversion], 5
jb      short loc_4011fc
jbe     short loc_40120c
mov     al, 1
jmp     short loc_401220
xor     eax, eax
inc     eax
cmp     [ebp+0a0h+versioninformation.dwminorversion], eax
jnb     short loc_401220
cmp     [ebp+0a0h+var_c], 4
sbb     al, al
inc     al
mov     ecx, [ebp+0a0h+var_4]
xor     ecx, ebp
call    sub_4088de
add     ebp, 0a0h
leave
retn
push    ebp
mov     ebp, esp
push    ecx
and     [ebp+var_4], 0
cmp     dword ptr [esi+4], 0ffffffffh
push    edi
jz      short loc_40127c
lea     eax, [ebp+var_4]
push    eax
push    dword ptr [esi+0ch]
xor     edi, edi
mov     eax, esi
call    sub_402aee
test    al, al
jz      short loc_40127c
cmp     [ebp+var_4], edi
jz      short loc_40127c
cmp     [ebp+var_4], 10000h
jge     short loc_40127c
push    [ebp+var_4]
call    ??_u@yapaxi@z
mov     edi, eax
pop     ecx
test    edi, edi
jnz     short loc_401281
push    eax
call    ??_v@yaxpax@z
pop     ecx
xor     eax, eax
pop     edi
leave
retn
lea     eax, [ebp+var_4]
push    eax
mov     eax, esi
call    sub_402a61
test    al, al
jnz     short loc_401293
push    edi
jmp     short loc_401276
mov     al, [edi]
mov     ecx, edi
jmp     short loc_4012a0
cmp     al, 22h
jz      short loc_401290
inc     ecx
mov     al, [ecx]
test    al, al
jnz     short loc_401299
push    0
call    ??_v@yaxpax@z
pop     ecx
mov     eax, edi
jmp     short loc_40127e
push    ebp
mov     ebp, esp
sub     esp, 1ch
push    esi
xor     esi, esi
cmp     [ebp+lpfilename], esi
jnz     short loc_4012c3
xor     eax, eax
pop     esi
leave
retn
push    [ebp+lpfilename]
or      [ebp+var_18], 0ffffffffh
lea     eax, [ebp+var_1c]
mov     [ebp+var_1c], offset off_40ec44
mov     [ebp+var_14], esi
mov     [ebp+var_10], esi
mov     [ebp+var_c], esi
mov     [ebp+var_8], esi
mov     [ebp+var_4], esi
call    sub_402990
test    al, al
jnz     short loc_4012f8
lea     ecx, [ebp+var_1c]
call    sub_402980
mov     eax, esi
jmp     short loc_4012c0
push    edi
lea     esi, [ebp+var_1c]
call    sub_401235
mov     edi, eax
call    sub_402a29
mov     esi, edi
pop     edi
jmp     short loc_4012ec
push    ebx
push    esi
push    [esp+8+arg_0]
mov     [edi], eax
lea     eax, [edi+4]
call    sub_4021ad
mov     ebx, offset dword_41174c
lea     esi, [edi+8]
mov     ecx, ebx
call    sub_40254c
xor     eax, eax
mov     [edi+0ch], eax
lea     esi, [edi+1ch]
mov     ecx, ebx
mov     [edi+10h], eax
mov     [edi+14h], eax
mov     [edi+18h], eax
call    sub_40254c
lea     esi, [edi+20h]
mov     ecx, ebx
call    sub_40254c
pop     esi
mov     eax, edi
pop     ebx
retn    4
push    esi
push    edi
mov     edi, eax
cmp     dword ptr [edi+0ch], 8004ffffh
jz      short loc_401367
call    sub_40159e
mov     eax, [edi+20h]
sub     eax, 10h
call    sub_4010b5
mov     eax, [edi+1ch]
sub     eax, 10h
call    sub_4010b5
lea     esi, [edi+10h]
call    sub_402307
mov     eax, [edi+8]
sub     eax, 10h
call    sub_4010b5
mov     eax, [edi+4]
pop     edi
sub     eax, 10h
pop     esi
jmp     sub_4010b5
push    ebp
mov     ebp, esp
and     esp, 0fffffff8h
sub     esp, 3ch
push    ebx
push    esi
push    edi
mov     ebx, eax
call    sub_4016f6
test    eax, eax
jz      short loc_4013bc
or      eax, 0ffffffffh
jmp     loc_401597
mov     ecx, ebx
call    sub_401791
mov     esi, eax
inc     eax
neg     eax
sbb     eax, eax
and     eax, ds:off_40ebc0
xor     edi, edi
mov     [esp+48h+hobject], esi
cmp     eax, edi
jnz     short loc_4013e8
cmp     esi, 0ffffffffh
jz      short loc_4013b4
push    esi
call    ds:closehandle
jmp     short loc_4013b4
mov     eax, [ebx+1ch]
sub     eax, 10h
mov     [esp+48h+var_20], esi
call    sub_402625
add     eax, 10h
mov     [esp+48h+var_1c], eax
mov     [esp+48h+var_18], 1
mov     [esp+48h+var_14], edi
mov     [esp+48h+var_10], edi
mov     [esp+48h+var_c], edi
mov     [esp+48h+var_8], offset sub_401b51
mov     [esp+48h+var_4], ebx
mov     [esp+48h+var_39], 0
lea     eax, [esp+48h+var_39]
push    eax
lea     edi, [esp+4ch+var_20]
call    sub_402bd4
test    al, al
jz      loc_4014e3
cmp     [esp+48h+var_39], 0
jz      short loc_401420
mov     eax, [ebx+8]
lea     edi, [ebx+0ch]
or      dword ptr [edi], 0ffffffffh
cmp     dword ptr [eax-0ch], 0
jz      loc_40157e
add     eax, 0fffffff0h
call    sub_402625
or      [esp+48h+var_24], 0ffffffffh
add     eax, 10h
mov     [esp+48h+var_38], eax
lea     eax, [esp+48h+var_38]
push    104h
mov     esi, eax
mov     [esp+4ch+var_2c], eax
call    sub_402567
push    eax
mov     [esp+4ch+var_28], eax
call    ds:pathquotespacesw
lea     ecx, [esp+48h+var_2c]
call    sub_40235a
mov     esi, ebx
call    sub_40191c
mov     esi, eax
mov     eax, [ebx+4]
cmp     dword ptr [eax-0ch], 0
jnz     short loc_401513
test    esi, esi
jnz     short loc_4014f1
mov     esi, 80040750h
push    esi
call    sub_401dd9
pop     ecx
push    0
call    ??_v@yaxpax@z
mov     eax, [esp+4ch+var_38]
pop     ecx
add     eax, 0fffffff0h
call    sub_4010b5
lea     edi, [esp+48h+var_20]
call    sub_402b8b
cmp     [esp+48h+hobject], 0ffffffffh
jz      short loc_4014dc
push    [esp+48h+hobject]
call    ds:closehandle
mov     eax, esi
jmp     loc_401597
lea     edi, [esp+48h+var_20]
call    sub_402b8b
jmp     loc_4013da
push    offset ainstall
push    offset ataggedmi
push    offset ainstallsource
push    offset asss
lea     eax, [esp+58h+var_38]
call    sub_4027b6
add     esp, 10h
jmp     short loc_401530
push    eax
push    offset as
lea     eax, [esp+50h+var_38]
call    sub_4027b6
pop     ecx
pop     ecx
lea     eax, [esp+48h+var_38]
push    eax
mov     ecx, ebx
call    sub_4015ed
test    esi, esi
jz      short loc_40155c
push    esi
lea     eax, [esp+4ch+var_30]
call    sub_4021ad
push    dword ptr [eax]
lea     eax, [esp+4ch+var_38]
push    offset as_0
call    sub_4027b6
mov     eax, [esp+50h+var_30]
pop     ecx
pop     ecx
add     eax, 0fffffff0h
call    sub_4010b5
push    edi
lea     eax, [esp+4ch+var_38]
call    sub_402890
pop     ecx
push    esi
call    ??_v@yaxpax@z
mov     eax, [esp+4ch+var_38]
pop     ecx
add     eax, 0fffffff0h
call    sub_4010b5
mov     esi, [esp+48h+hobject]
mov     ebx, [edi]
lea     edi, [esp+48h+var_20]
call    sub_402b8b
cmp     esi, 0ffffffffh
jz      short loc_401595
push    esi
call    ds:closehandle
mov     eax, ebx
pop     edi
pop     esi
pop     ebx
mov     esp, ebp
pop     ebp
retn
push    esi
xor     esi, esi
cmp     [edi+14h], esi
jz      short loc_4015c1
test    esi, esi
jl      short loc_4015db
cmp     esi, [edi+14h]
jge     short loc_4015db
mov     eax, [edi+10h]
push    dword ptr [eax+esi*4]
call    ds:deletefilew
inc     esi
cmp     esi, [edi+14h]
jnz     short loc_4015a6
lea     esi, [edi+10h]
call    sub_402307
lea     esi, [edi+1ch]
push    dword ptr [esi]
call    ds:removedirectoryw
call    sub_40224f
pop     esi
retn
push    0
push    0
push    1
push    0c000008ch
call    ds:raiseexception
int     3
push    ebp
lea     ebp, [esp-198h]
sub     esp, 218h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+198h+var_4], eax
mov     eax, [ebp+198h+arg_0]
push    ebx
push    esi
mov     esi, ecx
mov     [ebp+198h+var_218], eax
mov     eax, dword_41174c
push    edi
mov     ecx, offset dword_41174c
call    dword ptr [eax+0ch]
add     eax, 10h
mov     [ebp+198h+string2], eax
push    offset arecover
push    offset as_1
lea     eax, [ebp+198h+string2]
call    sub_402769
mov     ebx, [ebp+198h+string2]
mov     edi, [ebx-0ch]
pop     ecx
pop     ecx
lea     eax, [esi+4]
test    edi, edi
jge     short loc_40164c
xor     edi, edi
mov     esi, [eax]
cmp     edi, [esi-0ch]
jl      short loc_401665
lea     eax, [esi-10h]
call    sub_402625
mov     esi, eax
add     esi, 10h
mov     [ebp+198h+var_214], esi
jmp     short loc_401678
call    sub_402458
push    esi
mov     ecx, eax
lea     esi, [ebp+198h+var_214]
call    sub_40237f
mov     esi, [ebp+198h+var_214]
push    ebx
lea     eax, [ebp+198h+var_214]
push    eax
call    sub_40247c
mov     ebx, eax
neg     ebx
sbb     bl, bl
lea     eax, [esi-10h]
inc     bl
call    sub_4010b5
pop     edi
pop     esi
test    bl, bl
pop     ebx
jz      short loc_4016d4
push    208h
lea     eax, [ebp+198h+filename]
push    0
push    eax
call    _memset
add     esp, 0ch
push    104h
lea     eax, [ebp+198h+filename]
push    eax
push    0
call    ds:getmodulefilenamew
test    eax, eax
jz      short loc_4016d4
lea     eax, [ebp+198h+filename]
push    eax
mov     eax, [ebp+198h+var_218]
push    offset as_0
call    sub_4027b6
pop     ecx
pop     ecx
mov     eax, [ebp+198h+string2]
add     eax, 0fffffff0h
call    sub_4010b5
mov     ecx, [ebp+198h+var_4]
xor     ecx, ebp
call    sub_4088de
add     ebp, 198h
leave
retn    4
push    ebp
mov     ebp, esp
sub     esp, 0ch
push    ebx
push    esi
mov     esi, eax
push    edi
lea     ebx, [esi+20h]
mov     eax, ebx
lea     edi, [ebp+var_c]
call    sub_40233c
push    dword ptr [eax+4]
push    104h
call    ds:gettemppathw
mov     ecx, edi
call    sub_40235a
mov     eax, [ebx]
push    0
push    eax
call    ds:createdirectoryw
test    eax, eax
jnz     short loc_40173f
call    ds:getlasterror
cmp     eax, 0b7h
jnz     short loc_401773
add     esi, 1ch
mov     eax, esi
lea     edi, [ebp+var_c]
call    sub_40233c
mov     eax, [eax+4]
mov     ebx, [ebx]
push    eax
push    0
push    offset prefixstring
push    ebx
call    ds:gettempfilenamew
mov     ebx, eax
neg     ebx
sbb     bl, bl
mov     ecx, edi
inc     bl
call    sub_40235a
test    bl, bl
jz      short loc_401778
or      eax, 0ffffffffh
jmp     short loc_40178c
push    dword ptr [esi]
call    ds:deletefilew
push    0
push    dword ptr [esi]
call    ds:createdirectoryw
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 22ch
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+var_4], eax
or      [ebp+hfile], 0ffffffffh
push    ebx
push    esi
push    edi
xor     eax, eax
xor     ebx, ebx
push    206h
mov     [ebp+tempfilename], ax
lea     eax, [ebp+var_20e]
push    ebx
push    eax
mov     esi, ecx
mov     [ebp+var_21c], bl
call    _memset
mov     eax, [esi+20h]
add     esp, 0ch
lea     ecx, [ebp+tempfilename]
push    ecx
push    ebx
push    offset agut
push    eax
call    ds:gettempfilenamew
test    eax, eax
jz      loc_401907
lea     eax, [ebp+tempfilename]
push    eax
lea     eax, [ebp+hresinfo]
call    sub_402182
add     esi, 10h
lea     ebx, [ebp+hresinfo]
call    sub_402291
mov     eax, [ebp+hresinfo]
add     eax, 0fffffff0h
call    sub_4010b5
mov     esi, ds:findresourcew
mov     edi, offset type
push    edi
push    67h
xor     ebx, ebx
push    ebx
call    esi
mov     [ebp+hresinfo], eax
cmp     eax, ebx
jnz     short loc_40185b
push    edi
push    66h
push    ebx
mov     [ebp+var_21c], 1
call    esi
mov     [ebp+hresinfo], eax
cmp     eax, ebx
jz      loc_401907
push    [ebp+hresinfo]
push    ebx
call    ds:loadresource
cmp     eax, ebx
jz      loc_401907
push    eax
call    ds:lockresource
mov     esi, eax
cmp     esi, ebx
jz      loc_401907
push    ebx
push    ebx
push    4
push    ebx
push    ebx
push    0c0000000h
lea     eax, [ebp+tempfilename]
push    eax
call    ds:createfilew
mov     [ebp+hfile], eax
cmp     eax, 0ffffffffh
jz      short loc_401907
push    dword ptr [ebp+var_21c]
xor     eax, eax
push    [ebp+hfile]
lea     edi, [ebp+lidistancetomove]
push    [ebp+hresinfo]
stosd
push    ebx
stosd
call    ds:sizeofresource
push    eax
mov     ecx, esi
call    sub_401b75
add     esp, 0ch
test    eax, eax
jnz     short loc_4018f4
push    ebx
push    ebx
push    dword ptr [ebp+lidistancetomove+4]
push    dword ptr [ebp+lidistancetomove]
push    [ebp+hfile]
call    ds:setfilepointerex
test    eax, eax
jnz     short loc_401907
push    [ebp+hfile]
call    ds:closehandle
or      [ebp+hfile], 0ffffffffh
mov     ecx, [ebp+var_4]
mov     eax, [ebp+hfile]
pop     edi
pop     esi
xor     ecx, ebp
pop     ebx
call    sub_4088de
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 20ch
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+var_4], eax
push    208h
lea     eax, [ebp+filename]
push    0
push    eax
call    _memset
add     esp, 0ch
push    104h
lea     eax, [ebp+filename]
push    eax
push    dword ptr [esi]
call    ds:getmodulefilenamew
test    eax, eax
jz      short loc_40196a
lea     eax, [ebp+filename]
push    eax
call    sub_4012b0
pop     ecx
mov     ecx, [ebp+var_4]
xor     ecx, ebp
call    sub_4088de
leave
retn
push    ebp
mov     ebp, esp
push    ecx
push    ecx
push    ebx
push    esi
push    edi
push    [ebp+arg_4]
lea     eax, [ebp+lpstring]
call    sub_402182
mov     esi, [ebp+arg_0]
add     esi, 10h
lea     ebx, [ebp+lpstring]
call    sub_402291
mov     ebx, [ebp+lpstring]
push    ebx
call    ds:lstrlenw
lea     eax, [ebx+eax*2]
jmp     short loc_4019ae
cmp     word ptr [eax], 5ch
jz      short loc_4019ba
dec     eax
dec     eax
cmp     eax, ebx
jnz     short loc_4019a6
cmp     word ptr [eax], 5ch
jz      short loc_4019ba
xor     eax, eax
test    eax, eax
jz      short loc_401a23
sub     eax, ebx
sar     eax, 1
js      short loc_401a23
mov     ecx, [ebx-0ch]
inc     eax
mov     edi, ecx
sub     edi, eax
mov     esi, eax
test    eax, eax
jge     short loc_4019d4
xor     esi, esi
test    edi, edi
jge     short loc_4019da
xor     edi, edi
mov     eax, 7fffffffh
sub     eax, esi
cmp     eax, edi
jl      short loc_401a19
lea     eax, [esi+edi]
cmp     eax, ecx
jle     short loc_4019f0
mov     edi, ecx
sub     edi, esi
cmp     esi, ecx
jle     short loc_4019f6
xor     edi, edi
test    esi, esi
jnz     short loc_4019fe
cmp     edi, ecx
jz      short loc_401a23
lea     eax, [ebp+lpstring]
call    sub_402458
lea     ecx, [ebx+esi*2]
push    ecx
mov     ecx, eax
lea     esi, [ebp+arg_4]
call    sub_40237f
mov     eax, [ebp+arg_4]
jmp     short loc_401a31
push    80070057h
call    sub_401000
lea     eax, [ebx-10h]
call    sub_402625
add     eax, 10h
mov     [ebp+arg_4], eax
mov     edi, [eax-0ch]
push    edi
lea     esi, [ebp+arg_4]
call    sub_402567
lea     ecx, [edi+1]
cmp     ecx, 7fffffffh
ja      short loc_401a19
push    ecx
push    eax
call    ds:charlowerbuffw
mov     eax, edi
mov     edx, esi
call    sub_40258d
mov     ebx, [ebp+arg_4]
mov     edx, [ebx-0ch]
cmp     edx, 4
jle     loc_401b37
mov     eax, edx
lea     ecx, [eax-4]
sub     eax, ecx
mov     edi, eax
mov     esi, ecx
test    ecx, ecx
jge     short loc_401a79
xor     esi, esi
test    edi, edi
jge     short loc_401a7f
xor     edi, edi
mov     eax, 7fffffffh
sub     eax, esi
cmp     eax, edi
jl      short loc_401a19
lea     eax, [esi+edi]
cmp     eax, edx
jle     short loc_401a95
mov     edi, edx
sub     edi, esi
cmp     esi, edx
jle     short loc_401a9b
xor     edi, edi
test    esi, esi
jnz     short loc_401ab3
cmp     edi, edx
jnz     short loc_401ab3
lea     eax, [ebx-10h]
call    sub_402625
add     eax, 10h
mov     [ebp+string1], eax
jmp     short loc_401ac9
lea     eax, [ebp+arg_4]
call    sub_402458
lea     ecx, [ebx+esi*2]
push    ecx
mov     ecx, eax
lea     esi, [ebp+string1]
call    sub_40237f
push    offset string2
push    [ebp+string1]
call    _wcscmp
pop     ecx
pop     ecx
test    eax, eax
jnz     short loc_401b2c
mov     edi, [ebp+arg_0]
add     edi, 8
mov     eax, [edi]
cmp     dword ptr [eax-0ch], 0
jnz     short loc_401b2c
mov     ecx, [ebp+lpstring]
mov     esi, [edi]
lea     eax, [ecx-10h]
sub     esi, 10h
cmp     eax, esi
jz      short loc_401b2c
cmp     dword ptr [esi+0ch], 0
jl      short loc_401b1e
mov     edx, [eax]
cmp     edx, [esi]
jnz     short loc_401b1e
call    sub_402625
mov     [ebp+arg_0], eax
mov     eax, esi
call    sub_4010b5
mov     eax, [ebp+arg_0]
add     eax, 10h
mov     [edi], eax
jmp     short loc_401b2c
mov     ebx, [ecx-0ch]
push    ecx
mov     eax, edi
call    sub_4025af
mov     ebx, [ebp+arg_4]
mov     eax, [ebp+string1]
add     eax, 0fffffff0h
call    sub_4010b5
lea     eax, [ebx-10h]
call    sub_4010b5
mov     eax, [ebp+lpstring]
add     eax, 0fffffff0h
call    sub_4010b5
pop     edi
pop     esi
pop     ebx
leave
retn    8
push    [esp+arg_4]
push    [esp+4+arg_0]
call    sub_401976
retn
push    [esp+arg_4]
call    ??_u@yapaxi@z
pop     ecx
retn
push    [esp+arg_4]
call    ??_v@yaxpax@z
pop     ecx
retn
push    ebp
mov     ebp, esp
sub     esp, 0a0h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+var_8], eax
cmp     [ebp+arg_8], 0
mov     eax, [ebp+hfile]
push    ebx
push    esi
push    edi
mov     edi, ecx
mov     [ebp+var_a0], eax
jnz     short loc_401bc6
push    0
lea     ecx, [ebp+numberofbyteswritten]
push    ecx
push    [ebp+nnumberofbytestowrite]
push    edi
push    eax
call    ds:writefile
test    eax, eax
jz      loc_401d72
mov     eax, [ebp+nnumberofbytestowrite]
cmp     [ebp+numberofbyteswritten], eax
jnz     loc_401d72
jmp     loc_401d56
cmp     [ebp+nnumberofbytestowrite], 0dh
jb      loc_401d72
xor     ebx, ebx
lea     eax, [ebp+var_90]
mov     edx, edi
lea     ecx, [ebp+var_7c]
mov     [ebp+var_90], offset sub_401b5f
mov     [ebp+var_8c], offset sub_401b6a
mov     [ebp+var_68], ebx
mov     [ebp+var_6c], ebx
call    sub_404617
sub     [ebp+nnumberofbytestowrite], 0dh
xor     eax, eax
inc     eax
mov     [ebp+var_30], eax
mov     [ebp+var_2c], eax
add     edi, 5
mov     eax, [edi]
push    eax
mov     [ebp+var_58], ebx
mov     [ebp+var_34], ebx
mov     [ebp+var_24], ebx
mov     [ebp+var_50], ebx
mov     [ebp+var_4c], ebx
mov     [ebp+lpbuffer], eax
call    ??_u@yapaxi@z
mov     esi, eax
pop     ecx
lea     eax, [ebp+numberofbyteswritten]
push    eax
lea     eax, [ebp+nnumberofbytestowrite]
push    eax
add     edi, 8
push    edi
lea     eax, [ebp+lpbuffer]
push    eax
push    esi
lea     edi, [ebp+var_7c]
mov     [ebp+var_88], esi
mov     [ebp+numberofbyteswritten], ebx
call    sub_4044cd
add     esp, 14h
push    [ebp+var_6c]
mov     edi, eax
lea     eax, [ebp+var_90]
push    eax
call    [ebp+var_8c]
push    [ebp+var_68]
lea     eax, [ebp+var_90]
push    eax
mov     [ebp+var_6c], ebx
call    [ebp+var_8c]
add     esp, 10h
mov     [ebp+var_68], ebx
cmp     edi, ebx
jz      short loc_401c94
or      edi, 0ffffffffh
push    esi
call    ??_v@yaxpax@z
pop     ecx
mov     eax, edi
jmp     loc_401d75
mov     ecx, [esi]
add     esi, 4
mov     edi, [esi]
push    4
pop     eax
add     esi, eax
mov     ebx, [esi]
add     esi, eax
mov     edx, [esi]
add     esi, eax
mov     [ebp+var_94], edx
mov     edx, [esi]
push    ecx
mov     [ebp+numberofbyteswritten], ecx
mov     [ebp+var_98], edx
add     esi, eax
call    ??_u@yapaxi@z
pop     ecx
push    [ebp+numberofbyteswritten]
mov     [ebp+lpbuffer], eax
push    eax
push    [ebp+var_98]
mov     eax, [ebp+var_94]
push    eax
lea     edx, [eax+ebx]
lea     eax, [ebx+edi]
add     eax, esi
push    eax
push    ebx
lea     eax, [edi+esi]
push    eax
add     edx, edi
push    edi
add     edx, esi
push    esi
call    sub_404684
add     esp, 24h
test    eax, eax
jz      short loc_401d13
push    [ebp+lpbuffer]
call    ??_v@yaxpax@z
mov     esi, [ebp+var_88]
xor     edi, edi
pop     ecx
inc     edi
jmp     loc_401c86
mov     esi, [ebp+numberofbyteswritten]
push    0
lea     eax, [ebp+var_9c]
push    eax
push    esi
push    [ebp+lpbuffer]
push    [ebp+var_a0]
call    ds:writefile
test    eax, eax
jz      short loc_401d5a
cmp     [ebp+var_9c], esi
jnz     short loc_401d5a
push    [ebp+lpbuffer]
call    ??_v@yaxpax@z
pop     ecx
push    [ebp+var_88]
call    ??_v@yaxpax@z
pop     ecx
xor     eax, eax
jmp     short loc_401d75
push    [ebp+lpbuffer]
call    ??_v@yaxpax@z
pop     ecx
push    [ebp+var_88]
call    ??_v@yaxpax@z
pop     ecx
or      eax, 0ffffffffh
mov     ecx, [ebp+var_8]
pop     edi
pop     esi
xor     ecx, ebp
pop     ebx
call    sub_4088de
leave
retn
push    esi
mov     esi, eax
mov     ecx, offset dword_41174c
call    sub_40254c
push    5288h
push    esi
call    sub_4021d8
mov     eax, esi
pop     esi
retn
push    ebp
mov     ebp, esp
push    ecx
push    esi
mov     esi, eax
mov     ecx, offset dword_41174c
call    sub_40254c
lea     eax, [ebp+var_4]
call    sub_401d84
push    dword ptr [eax]
push    5289h
push    esi
call    sub_402801
mov     eax, [ebp+var_4]
add     esp, 0ch
add     eax, 0fffffff0h
call    sub_4010b5
mov     eax, esi
pop     esi
leave
retn
push    ebp
mov     ebp, esp
push    ecx
push    ecx
mov     eax, dword_41174c
mov     ecx, offset dword_41174c
call    dword ptr [eax+0ch]
add     eax, 10h
cmp     [ebp+arg_0], 80040703h
mov     [ebp+lptext], eax
jz      short loc_401e0a
push    528ah
lea     eax, [ebp+lptext]
push    eax
call    sub_4021d8
jmp     short loc_401e30
lea     eax, [ebp+var_8]
call    sub_401d84
push    dword ptr [eax]
lea     eax, [ebp+lptext]
push    528bh
push    eax
call    sub_402801
mov     eax, [ebp+var_8]
add     esp, 0ch
add     eax, 0fffffff0h
call    sub_4010b5
push    esi
lea     eax, [ebp+var_8]
call    sub_401da0
mov     esi, [ebp+lptext]
push    0
push    dword ptr [eax]
push    esi
push    0
call    ds:messageboxw
mov     eax, [ebp+var_8]
add     eax, 0fffffff0h
call    sub_4010b5
lea     eax, [esi-10h]
call    sub_4010b5
mov     eax, [ebp+arg_0]
pop     esi
leave
retn
call    ds:getlasterror
test    eax, eax
jz      short loc_401e79
jle     short locret_401e7e
and     eax, 0ffffh
or      eax, 80070000h
retn
mov     eax, 80004005h
retn
push    ebp
lea     ebp, [esp-1b8h]
sub     esp, 238h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+1b8h+var_4], eax
and     dword ptr [edi], 0
call    ds:getcurrentprocessid
mov     [ebp+1b8h+var_238], eax
test    eax, eax
jnz     short loc_401ec4
call    sub_401e62
mov     ecx, [ebp+1b8h+var_4]
xor     ecx, ebp
call    sub_4088de
add     ebp, 1b8h
leave
retn
push    0
push    2
call    createtoolhelp32snapshot
mov     [ebp+1b8h+hsnapshot], eax
cmp     eax, 0ffffffffh
jz      short loc_401eaa
push    esi
mov     esi, 22ch
push    esi
lea     eax, [ebp+1b8h+pe]
push    0
push    eax
call    _memset
add     esp, 0ch
lea     eax, [ebp+1b8h+pe]
push    eax
push    [ebp+1b8h+hsnapshot]
mov     [ebp+1b8h+pe.dwsize], esi
call    process32firstw
test    eax, eax
jnz     short loc_401f12
call    sub_401e62
mov     esi, eax
push    [ebp+1b8h+hsnapshot]
call    ds:closehandle
mov     eax, esi
pop     esi
jmp     short loc_401eaf
mov     eax, [ebp+1b8h+var_238]
cmp     [ebp+1b8h+pe.th32processid], eax
jnz     short loc_401f21
mov     eax, [ebp+1b8h+pe.th32parentprocessid]
test    eax, eax
jnz     short loc_401f38
lea     eax, [ebp+1b8h+pe]
push    eax
push    [ebp+1b8h+hsnapshot]
call    process32nextw
test    eax, eax
jnz     short loc_401f12
mov     esi, 80004005h
jmp     short loc_401f04
mov     [edi], eax
xor     esi, esi
jmp     short loc_401f04
push    ebp
lea     ebp, [esp-0a0h]
sub     esp, 120h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+0a0h+var_4], eax
cmp     byte_4117bb, 0
jnz     short loc_401faf
push    118h
lea     eax, [ebp+0a0h+versioninformation.dwmajorversion]
push    0
push    eax
call    _memset
add     esp, 0ch
push    3
push    2
push    0
push    0
mov     [ebp+0a0h+versioninformation.dwosversioninfosize], 11ch
mov     [ebp+0a0h+versioninformation.dwmajorversion], 6
call    ds:versetconditionmask
push    edx
push    eax
push    2
lea     eax, [ebp+0a0h+versioninformation]
push    eax
call    ds:verifyversioninfow
test    eax, eax
setnz   byte_4117bc
mov     byte_4117bb, 1
mov     ecx, [ebp+0a0h+var_4]
mov     al, byte_4117bc
xor     ecx, ebp
call    sub_4088de
add     ebp, 0a0h
leave
retn
push    ebp
lea     ebp, [esp-78h]
sub     esp, 0d4h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+78h+var_4], eax
call    sub_401f3e
test    al, al
jz      short loc_401fee
xor     al, al
jmp     loc_4020a1
push    edi
lea     edi, [ebp+78h+var_ac]
call    sub_401e7f
test    eax, eax
jge     short loc_402002
xor     al, al
jmp     loc_4020a0
push    ebx
push    0f003fh
push    0
push    0
call    ds:openscmanagerw
mov     ebx, eax
test    ebx, ebx
jnz     short loc_40201f
xor     al, al
jmp     loc_40209f
push    esi
mov     esi, offset aseclogon
lea     edi, [ebp+78h+servicename]
movsd
movsd
movsd
movsd
push    8eh
lea     eax, [ebp+78h+var_92]
push    0
push    eax
movsw
call    _memset
add     esp, 0ch
push    0f01ffh
lea     eax, [ebp+78h+servicename]
push    eax
push    ebx
call    ds:openservicew
mov     esi, ds:closeservicehandle
mov     edi, eax
test    edi, edi
jnz     short loc_402069
mov     [ebp+78h+var_a5], 0
push    ebx
call    esi
mov     al, [ebp+78h+var_a5]
jmp     short loc_40209e
lea     eax, [ebp+78h+pcbbytesneeded]
push    eax
push    24h
lea     eax, [ebp+78h+buffer]
push    eax
push    0
push    edi
call    ds:queryservicestatusex
push    edi
test    eax, eax
jz      short loc_402091
mov     eax, [ebp+78h+var_ac]
cmp     eax, [ebp+78h+var_b8]
jnz     short loc_402091
call    esi
mov     [ebp+78h+var_a5], 1
jmp     short loc_402061
mov     esi, ds:closeservicehandle
call    esi
push    ebx
call    esi
xor     al, al
pop     esi
pop     ebx
pop     edi
mov     ecx, [ebp+78h+var_4]
xor     ecx, ebp
call    sub_4088de
add     ebp, 78h
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 24h
push    esi
call    sub_401fc9
test    al, al
jz      short loc_402110
mov     eax, dword_41174c
mov     ecx, offset dword_41174c
call    dword ptr [eax+0ch]
add     eax, 10h
mov     [ebp+lpcmdline], eax
push    528ch
lea     eax, [ebp+lpcmdline]
push    eax
call    sub_4021d8
lea     eax, [ebp+hinstance]
call    sub_401da0
mov     esi, [ebp+lpcmdline]
push    0
push    dword ptr [eax]
push    esi
push    0
call    ds:messageboxw
mov     eax, [ebp+hinstance]
add     eax, 0fffffff0h
call    sub_4010b5
lea     eax, [esi-10h]
call    sub_4010b5
xor     eax, eax
jmp     short loc_40217d
push    2
push    0
call    ds:coinitializeex
mov     esi, eax
test    esi, esi
jge     short loc_402129
push    esi
call    sub_401dd9
pop     ecx
jmp     short loc_40217d
push    edi
call    sub_4011b9
movzx   eax, al
neg     eax
sbb     eax, eax
and     eax, 7ffbf8fdh
add     eax, 80040703h
jns     short loc_40214d
push    eax
call    sub_401dd9
pop     ecx
mov     edi, eax
jmp     short loc_40216c
push    [ebp+lpcmdline]
mov     eax, [ebp+hinstance]
lea     edi, [ebp+var_24]
call    sub_40130d
mov     eax, edi
call    sub_40139d
mov     edi, eax
lea     eax, [ebp+var_24]
call    sub_401355
cmp     esi, 800401f0h
jz      short loc_40217a
call    ds:couninitialize
mov     eax, edi
pop     edi
pop     esi
leave
retn    10h
push    esi
mov     esi, eax
mov     ecx, offset dword_41174c
call    sub_40254c
push    [esp+4+string]
push    esi
call    sub_402526
test    al, al
jnz     short loc_4021a7
push    [esp+4+string]
push    esi
call    sub_4023d5
mov     eax, esi
pop     esi
retn    4
push    esi
mov     esi, eax
mov     ecx, offset dword_41174c
call    sub_40254c
push    [esp+4+lpmultibytestr]
push    esi
call    sub_402526
test    al, al
jnz     short loc_4021d2
push    [esp+4+lpmultibytestr]
push    esi
call    sub_4023fe
mov     eax, esi
pop     esi
retn    4
push    ebx
push    ebp
push    esi
push    edi
xor     edi, edi
mov     ebx, offset dword_411708
push    edi
mov     ecx, ebx
call    sub_40c304
xor     ebp, ebp
inc     ebp
jmp     short loc_40222a
test    edi, edi
jnz     short loc_402230
mov     eax, [esp+10h+arg_4]
shr     eax, 4
inc     eax
push    edi
movzx   eax, ax
push    eax
push    6
push    esi
call    ds:findresourceexw
test    eax, eax
jz      short loc_402221
push    eax
mov     eax, [esp+14h+arg_4]
push    esi
call    sub_401059
mov     edi, eax
pop     ecx
pop     ecx
test    edi, edi
jnz     short loc_402232
push    ebp
mov     ecx, ebx
call    sub_40c304
inc     ebp
mov     esi, eax
test    esi, esi
jnz     short loc_4021f0
xor     esi, esi
test    esi, esi
jnz     short loc_40223a
xor     eax, eax
jmp     short loc_402248
push    [esp+10h+arg_4]
push    esi
push    [esp+18h+arg_0]
call    sub_4024a2
pop     edi
pop     esi
pop     ebp
pop     ebx
retn    8
mov     ecx, [esi]
lea     eax, [ecx-10h]
xor     edx, edx
push    edi
mov     edi, [eax]
cmp     [eax+4], edx
jz      short loc_40228f
cmp     [eax+0ch], edx
jge     short loc_40227e
cmp     [ecx-8], edx
jge     short loc_402272
push    80070057h
call    sub_401000
mov     [ecx-0ch], edx
mov     eax, [esi]
xor     ecx, ecx
mov     [eax], cx
pop     edi
retn
call    sub_4010b5
mov     eax, [edi]
mov     ecx, edi
call    dword ptr [eax+0ch]
add     eax, 10h
mov     [esi], eax
pop     edi
retn
mov     ecx, [esi+4]
mov     eax, [esi+8]
push    edi
cmp     ecx, eax
jnz     short loc_4022e0
mov     edx, [esi]
cmp     ebx, edx
jb      short loc_4022b3
lea     edi, [edx+eax*4]
cmp     ebx, edi
jnb     short loc_4022b3
push    80004005h
call    sub_401000
test    eax, eax
jnz     short loc_4022bc
xor     edi, edi
inc     edi
jmp     short loc_4022cb
lea     edi, [ecx+ecx]
test    edi, edi
jl      short loc_402303
cmp     edi, 1fffffffh
ja      short loc_402303
push    4
push    edi
push    edx
call    __recalloc
add     esp, 0ch
test    eax, eax
jz      short loc_402303
mov     [esi+8], edi
mov     [esi], eax
mov     eax, [esi+4]
mov     ecx, [esi]
lea     edi, [ecx+eax*4]
test    edi, edi
jz      short loc_4022fb
mov     eax, [ebx]
sub     eax, 10h
call    sub_402625
add     eax, 10h
mov     [edi], eax
inc     dword ptr [esi+4]
xor     eax, eax
inc     eax
pop     edi
retn
xor     eax, eax
pop     edi
retn
push    ebx
xor     ebx, ebx
cmp     [esi], ebx
jz      short loc_402334
push    edi
xor     edi, edi
cmp     [esi+4], ebx
jle     short loc_402329
mov     eax, [esi]
mov     eax, [eax+edi*4]
sub     eax, 10h
call    sub_4010b5
inc     edi
cmp     edi, [esi+4]
jl      short loc_402316
push    dword ptr [esi]
call    _free
pop     ecx
mov     [esi], ebx
pop     edi
mov     [esi+4], ebx
mov     [esi+8], ebx
pop     ebx
retn
and     dword ptr [edi+4], 0
or      dword ptr [edi+8], 0ffffffffh
push    esi
mov     esi, eax
push    104h
mov     [edi], esi
call    sub_402567
mov     [edi+4], eax
mov     eax, edi
pop     esi
retn
mov     eax, [ecx+8]
push    esi
mov     esi, [ecx]
cmp     eax, 0ffffffffh
jnz     short loc_402377
mov     eax, [esi]
mov     ecx, [eax-8]
test    eax, eax
jz      short loc_402377
push    ecx
push    eax
call    _wcsnlen
pop     ecx
pop     ecx
mov     edx, esi
pop     esi
jmp     sub_40258d
test    ecx, ecx
jnz     short loc_40238d
push    80004005h
call    sub_401000
cmp     [esp+source], 0
jnz     short loc_40239f
test    edi, edi
jz      short loc_40239f
push    80070057h
jmp     short loc_402388
mov     eax, [ecx]
push    2
push    edi
call    dword ptr [eax]
test    eax, eax
jnz     short loc_4023af
call    sub_402681
add     eax, 10h
mov     [esi], eax
mov     eax, edi
mov     edx, esi
call    sub_40258d
lea     eax, [edi+edi]
push    eax
push    [esp+4+source]
push    eax
push    dword ptr [esi]
call    _memcpy_s
add     esp, 10h
mov     eax, esi
retn    4
push    ebp
mov     ebp, esp
xor     eax, eax
cmp     [ebp+string], eax
jz      short loc_4023e8
push    [ebp+string]
call    _wcslen
pop     ecx
push    ebx
push    [ebp+string]
mov     ebx, eax
mov     eax, [ebp+arg_0]
call    sub_4025af
mov     eax, [ebp+arg_0]
pop     ebx
pop     ebp
retn    8
push    ebp
mov     ebp, esp
push    ebx
mov     ebx, ds:multibytetowidechar
push    esi
xor     esi, esi
push    edi
cmp     [ebp+lpmultibytestr], esi
jz      short loc_402422
push    esi
push    esi
push    0ffffffffh
push    [ebp+lpmultibytestr]
push    esi
push    3
call    ebx
mov     edi, eax
dec     edi
jmp     short loc_402424
xor     edi, edi
cmp     edi, esi
mov     esi, [ebp+arg_0]
jle     short loc_402449
push    edi
call    sub_402567
push    edi
push    eax
push    0ffffffffh
push    [ebp+lpmultibytestr]
push    0
push    3
call    ebx
mov     eax, edi
mov     edx, esi
call    sub_40258d
jmp     short loc_40244e
call    sub_40224f
mov     eax, [ebp+arg_0]
pop     edi
pop     esi
pop     ebx
pop     ebp
retn    8
mov     eax, [eax]
mov     ecx, [eax-10h]
test    ecx, ecx
jz      short loc_402468
mov     eax, [ecx]
call    dword ptr [eax+10h]
jmp     short loc_40246a
xor     eax, eax
test    eax, eax
jnz     short locret_40247b
mov     ecx, offset dword_41174c
mov     eax, dword_41174c
jmp     dword ptr [eax+10h]
retn
cmp     [esp+string2], 0
jnz     short loc_40248d
push    80004005h
call    sub_401000
mov     eax, [esp+arg_0]
mov     eax, [eax]
push    [esp+string2]
push    eax
call    _wcscmp
pop     ecx
pop     ecx
retn    8
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_8]
shr     eax, 4
push    edi
inc     eax
movzx   eax, ax
push    6
push    eax
push    [ebp+hmodule]
call    ds:findresourcew
test    eax, eax
jz      short loc_4024d4
push    eax
push    [ebp+hmodule]
mov     eax, [ebp+arg_8]
call    sub_401059
mov     edi, eax
pop     ecx
pop     ecx
test    edi, edi
jnz     short loc_4024d8
xor     eax, eax
jmp     short loc_402521
push    ebx
movzx   ebx, word ptr [edi]
push    esi
mov     esi, [ebp+arg_0]
push    ebx
call    sub_402567
mov     esi, eax
movzx   eax, word ptr [edi]
add     edi, 2
cmp     eax, 0ffffffffh
jnz     short loc_4024fb
push    edi
call    ds:lstrlenw
inc     eax
add     eax, eax
push    eax
push    edi
lea     eax, [ebx+ebx]
push    eax
push    esi
call    _memcpy_s
push    eax
call    sub_401024
mov     edx, [ebp+arg_0]
add     esp, 14h
mov     eax, ebx
call    sub_40258d
xor     eax, eax
pop     esi
inc     eax
pop     ebx
pop     edi
pop     ebp
retn    0ch
xor     eax, eax
cmp     [esp+arg_4], eax
jz      short locret_402549
test    [esp+arg_4], 0ffff0000h
jnz     short locret_402549
movzx   eax, word ptr [esp+arg_4]
push    eax
push    [esp+4+arg_0]
call    sub_4021d8
mov     al, 1
retn    8
test    ecx, ecx
jnz     short loc_40255a
push    80004005h
call    sub_401000
mov     eax, [ecx]
call    dword ptr [eax+0ch]
add     eax, 10h
mov     [esi], eax
mov     eax, esi
retn
mov     eax, [esi]
xor     ecx, ecx
sub     eax, 10h
inc     ecx
sub     ecx, [eax+0ch]
mov     eax, [eax+8]
sub     eax, [esp+arg_0]
or      ecx, eax
jge     short loc_402588
mov     eax, [esp+arg_0]
mov     ecx, esi
call    sub_40268c
mov     eax, [esi]
retn    4
test    eax, eax
jl      short loc_4025a4
mov     ecx, [edx]
cmp     eax, [ecx-8]
jg      short loc_4025a4
mov     [ecx-0ch], eax
mov     ecx, [edx]
xor     edx, edx
mov     [ecx+eax*2], dx
retn
push    80070057h
call    sub_401000
push    ebp
mov     ebp, esp
push    ecx
push    esi
mov     esi, eax
test    ebx, ebx
jnz     short loc_4025c1
call    sub_40224f
jmp     short loc_402620
push    edi
mov     edi, [ebp+source]
test    edi, edi
jnz     short loc_4025d3
push    80070057h
call    sub_401000
mov     eax, [esi]
mov     ecx, [eax-0ch]
sub     edi, eax
push    ebx
mov     [ebp+var_4], ecx
sar     edi, 1
call    sub_402567
lea     ecx, [ebx+ebx]
push    ecx
cmp     edi, [ebp+var_4]
ja      short loc_402602
lea     ecx, [eax+edi*2]
push    ecx
mov     ecx, [esi]
mov     ecx, [ecx-8]
add     ecx, ecx
push    ecx
push    eax
call    _memmove_s
jmp     short loc_402613
mov     ecx, [esi]
mov     ecx, [ecx-8]
push    [ebp+source]
add     ecx, ecx
push    ecx
push    eax
call    _memcpy_s
add     esp, 10h
mov     eax, ebx
mov     edx, esi
call    sub_40258d
pop     edi
pop     esi
leave
retn    4
push    esi
mov     esi, eax
mov     ecx, [esi]
mov     eax, [ecx]
push    edi
call    dword ptr [eax+10h]
lea     edx, [esi+0ch]
cmp     dword ptr [edx], 0
jl      short loc_402647
cmp     eax, [esi]
jnz     short loc_402647
xor     eax, eax
mov     edi, esi
inc     eax
lock xadd [edx], eax
jmp     short loc_40267c
mov     edx, [eax]
push    2
push    dword ptr [esi+4]
mov     ecx, eax
call    dword ptr [edx]
mov     edi, eax
test    edi, edi
jnz     short loc_40265d
call    sub_402681
mov     eax, [esi+4]
mov     [edi+4], eax
mov     eax, [esi+4]
lea     eax, [eax+eax+2]
push    eax
add     esi, 10h
push    esi
push    eax
lea     eax, [edi+10h]
push    eax
call    _memcpy_s
add     esp, 10h
mov     eax, edi
pop     edi
pop     esi
retn
push    8007000eh
call    sub_401000
push    esi
mov     esi, ecx
push    edi
mov     edi, eax
mov     eax, [esi]
mov     ecx, [eax-0ch]
sub     eax, 10h
cmp     ecx, edi
jle     short loc_4026a0
mov     edi, ecx
cmp     dword ptr [eax+0ch], 1
jle     short loc_4026af
push    edi
push    esi
call    sub_4026d5
jmp     short loc_4026d2
mov     eax, [eax+8]
cmp     eax, edi
jge     short loc_4026d2
mov     edx, eax
mov     eax, 400h
cmp     edx, eax
jle     short loc_4026c5
add     edx, eax
jmp     short loc_4026c7
add     edx, edx
cmp     edx, edi
jge     short loc_4026cd
mov     edx, edi
call    sub_40273f
pop     edi
pop     esi
retn
push    ebp
mov     ebp, esp
push    ecx
mov     eax, [ebp+arg_0]
push    ebx
push    esi
mov     esi, [eax]
mov     ebx, [esi-0ch]
sub     esi, 10h
mov     ecx, [esi]
mov     eax, [ecx]
push    edi
mov     [ebp+var_4], ebx
call    dword ptr [eax+10h]
mov     edx, [eax]
push    2
push    [ebp+arg_4]
mov     ecx, eax
call    dword ptr [edx]
mov     edi, eax
test    edi, edi
jnz     short loc_402707
call    sub_402681
mov     eax, [ebp+arg_4]
cmp     ebx, eax
jge     short loc_402710
mov     eax, ebx
lea     eax, [eax+eax+2]
push    eax
lea     ecx, [esi+10h]
push    ecx
push    eax
lea     ebx, [edi+10h]
push    ebx
call    _memcpy_s
mov     eax, [ebp+var_4]
mov     [edi+4], eax
add     esp, 10h
mov     eax, esi
call    sub_4010b5
mov     eax, [ebp+arg_0]
pop     edi
pop     esi
mov     [eax], ebx
pop     ebx
leave
retn    8
mov     eax, [esi]
sub     eax, 10h
cmp     [eax+8], edx
mov     ecx, [eax]
jge     short loc_40275e
test    edx, edx
jle     short loc_40275e
push    edi
mov     edi, [ecx]
push    2
push    edx
push    eax
call    dword ptr [edi+8]
pop     edi
test    eax, eax
jnz     short loc_402763
call    sub_402681
add     eax, 10h
mov     [esi], eax
retn
push    ebp
mov     ebp, esp
push    ecx
mov     ecx, [ebp+arg_0]
push    ebx
push    esi
push    edi
mov     esi, eax
mov     ebx, ecx
test    ecx, ecx
jnz     short loc_402785
push    80070057h
call    sub_401000
lea     edi, [ebp+arg_4]
call    sub_4010cd
mov     edi, eax
push    edi
mov     [ebp+var_4], edi
call    sub_402567
inc     edi
push    edi
mov     ecx, ebx
lea     edi, [ebp+arg_4]
mov     ebx, eax
call    sub_401127
mov     eax, [ebp+var_4]
pop     ecx
mov     edx, esi
call    sub_40258d
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
push    ecx
push    ecx
mov     ecx, [ebp+arg_0]
push    ebx
push    esi
mov     esi, eax
mov     eax, [esi]
mov     ebx, [eax-0ch]
push    edi
lea     edi, [ebp+arg_4]
mov     [ebp+var_4], ecx
call    sub_4010cd
mov     edi, eax
lea     eax, [edi+ebx]
push    eax
mov     [ebp+var_8], eax
call    sub_402567
mov     ecx, [ebp+var_4]
inc     edi
push    edi
lea     ebx, [eax+ebx*2]
lea     edi, [ebp+arg_4]
call    sub_401127
mov     eax, [ebp+var_8]
pop     ecx
mov     edx, esi
call    sub_40258d
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
push    ecx
push    ecx
mov     eax, [ebp+arg_0]
push    esi
push    edi
call    sub_402458
mov     ecx, eax
lea     esi, [ebp+lpsource]
call    sub_40254c
push    [ebp+arg_4]
mov     eax, esi
push    eax
call    sub_4021d8
test    eax, eax
jnz     short loc_402833
push    80004005h
call    sub_401000
mov     esi, [ebp+lpsource]
xor     edi, edi
cmp     [esi-0ch], edi
jnz     short loc_402844
push    80070057h
jmp     short loc_40282e
lea     eax, [ebp+arg_8]
mov     [ebp+arguments], eax
lea     eax, [ebp+arguments]
push    eax
push    edi
lea     eax, [ebp+lpsource]
push    eax
push    edi
push    edi
push    esi
push    500h
mov     [ebp+lpsource], edi
call    ds:formatmessagew
test    eax, eax
jnz     short loc_40286d
call    sub_402681
push    [ebp+lpsource]
push    [ebp+arg_0]
call    sub_4023d5
push    [ebp+lpsource]
call    ds:localfree
lea     eax, [esi-10h]
mov     [ebp+arguments], edi
call    sub_4010b5
pop     edi
pop     esi
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 5ch
mov     eax, [eax]
push    ebx
push    esi
push    edi
sub     eax, 10h
call    sub_402625
mov     esi, eax
push    44h
xor     ebx, ebx
lea     eax, [ebp+startupinfo]
push    ebx
add     esi, 10h
push    eax
mov     [ebp+var_8], esi
call    _memset
xor     eax, eax
lea     edi, [ebp+processinformation]
stosd
stosd
stosd
stosd
add     esp, 0ch
lea     eax, [ebp+startupinfo]
push    eax
call    ds:getstartupinfow
or      [ebp+startupinfo.dwflags], 81h
xor     eax, eax
inc     eax
mov     [ebp+startupinfo.wshowwindow], ax
cmp     [esi-4], eax
jle     short loc_4028f1
push    dword ptr [esi-0ch]
lea     eax, [ebp+var_8]
push    eax
call    sub_4026d5
mov     esi, [ebp+var_8]
lea     eax, [ebp+processinformation]
push    eax
lea     eax, [ebp+startupinfo]
push    eax
push    ebx
push    ebx
push    400h
push    ebx
push    ebx
push    ebx
push    esi
push    ebx
call    ds:createprocessw
test    eax, eax
jnz     short loc_402929
call    ds:getlasterror
mov     ecx, [ebp+lpexitcode]
mov     [ecx], eax
lea     eax, [esi-10h]
call    sub_4010b5
pop     edi
pop     esi
mov     al, bl
pop     ebx
leave
retn
push    0ffffffffh
push    [ebp+processinformation.hprocess]
call    ds:waitforsingleobject
mov     [ebp+var_1], 1
cmp     [ebp+lpexitcode], ebx
jz      short loc_40294f
push    [ebp+lpexitcode]
push    [ebp+processinformation.hprocess]
call    ds:getexitcodeprocess
test    eax, eax
setnz   [ebp+var_1]
push    [ebp+processinformation.hprocess]
mov     edi, ds:closehandle
call    edi
push    [ebp+processinformation.hthread]
call    edi
mov     bl, [ebp+var_1]
jmp     short loc_40291a
push    esi
mov     esi, ecx
call    sub_402980
test    [esp+4+arg_0], 1
jz      short loc_40297a
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
retn    4
push    esi
mov     esi, ecx
mov     dword ptr [ecx], offset off_40ec44
call    sub_402a29
pop     esi
retn
push    ebp
mov     ebp, esp
sub     esp, 1ch
push    esi
push    edi
mov     esi, eax
call    sub_402a29
xor     edi, edi
push    edi
push    80h
push    3
push    edi
push    1
push    80000000h
push    [ebp+lpfilename]
call    ds:createfilew
mov     [esi+4], eax
cmp     eax, 0ffffffffh
jz      short loc_402a21
push    edi
push    edi
push    edi
push    2
push    edi
push    eax
call    ds:createfilemappingw
mov     [esi+8], eax
cmp     eax, edi
jz      short loc_402a1c
push    edi
push    edi
push    edi
push    4
push    eax
call    ds:mapviewoffile
mov     edx, eax
mov     [esi+0ch], edx
cmp     edx, edi
jz      short loc_402a13
push    6
pop     ecx
mov     [ebp+buffer.baseaddress], edi
xor     eax, eax
lea     edi, [ebp+buffer.allocationbase]
rep stosd
push    1ch
lea     eax, [ebp+buffer]
push    eax
push    edx
call    ds:virtualquery
test    eax, eax
jz      short loc_402a13
mov     eax, [ebp+buffer.regionsize]
mov     [esi+10h], eax
mov     al, 1
jmp     short loc_402a23
push    dword ptr [esi+8]
call    ds:closehandle
call    sub_402a29
xor     al, al
pop     edi
pop     esi
leave
retn    4
mov     eax, [esi+0ch]
test    eax, eax
jz      short loc_402a3b
push    eax
call    ds:unmapviewoffile
and     dword ptr [esi+0ch], 0
mov     eax, [esi+8]
push    edi
mov     edi, ds:closehandle
test    eax, eax
jz      short loc_402a50
push    eax
call    edi
and     dword ptr [esi+8], 0
mov     eax, [esi+4]
cmp     eax, 0ffffffffh
jz      short loc_402a5f
push    eax
call    edi
or      dword ptr [esi+4], 0ffffffffh
pop     edi
retn
cmp     [esp+arg_0], 0
jnz     short loc_402a6c
xor     al, al
jmp     short locret_402a7e
cmp     dword ptr [eax+4], 0ffffffffh
jz      short loc_402a68
push    [esp+arg_0]
push    dword ptr [eax+0ch]
call    sub_402aee
retn    4
test    ecx, ecx
jnz     short loc_402a88
xor     al, al
retn
mov     eax, 5a4dh
cmp     [ecx], ax
jnz     short loc_402a85
mov     eax, [ecx+3ch]
add     eax, ecx
cmp     dword ptr [eax], 4550h
jnz     short loc_402a85
mov     eax, [eax+98h]
test    eax, eax
jz      short loc_402aae
lea     edx, [eax+ecx]
jmp     short loc_402ab0
xor     edx, edx
test    edx, edx
jz      short loc_402a85
lea     eax, [edx+8]
test    eax, eax
jz      short loc_402a85
cmp     byte ptr [eax], 30h
lea     ecx, [eax+1]
jnz     short loc_402adf
mov     al, [ecx]
inc     ecx
cmp     al, 82h
jnz     short loc_402adf
movzx   eax, byte ptr [ecx]
movzx   ecx, byte ptr [ecx+1]
shl     eax, 8
lea     eax, [eax+ecx+13h]
and     eax, 0ffffff8h
jmp     short loc_402ae1
xor     eax, eax
test    eax, eax
jz      short loc_402a85
mov     [esi+14h], eax
mov     [esi+18h], edx
mov     al, 1
retn
cmp     [esp+arg_0], 0
push    esi
mov     esi, eax
jnz     short loc_402afc
xor     al, al
jmp     short loc_402b3f
mov     ecx, [esp+4+arg_0]
call    sub_402a81
test    al, al
jz      short loc_402af8
mov     eax, [esi+10h]
add     eax, [esp+4+arg_0]
push    ebx
mov     ebx, [esi+18h]
add     ebx, [esi+14h]
cmp     ebx, eax
jb      short loc_402b1f
xor     al, al
jmp     short loc_402b3e
push    4
push    offset agact
push    ebx
call    _memcmp
add     esp, 0ch
test    eax, eax
jnz     short loc_402b1b
mov     edx, [esp+8+arg_4]
mov     eax, ebx
call    sub_402b43
pop     ebx
pop     esi
retn    8
add     eax, 4
movzx   cx, byte ptr [eax]
push    esi
mov     esi, 100h
imul    cx, si
movzx   si, byte ptr [eax+1]
add     cx, si
movzx   ecx, cx
movzx   esi, cx
lea     ecx, [esi+1]
test    edi, edi
jnz     short loc_402b6d
mov     [edx], ecx
jmp     short loc_402b87
cmp     [edx], ecx
jge     short loc_402b75
xor     al, al
pop     esi
retn
push    esi
add     eax, 2
push    eax
push    edi
call    _memcpy
add     esp, 0ch
mov     byte ptr [esi+edi], 0
mov     al, 1
pop     esi
retn
push    esi
xor     esi, esi
cmp     [edi+10h], esi
jz      short loc_402bae
test    esi, esi
jl      short loc_402bc2
cmp     esi, [edi+10h]
jge     short loc_402bc2
mov     eax, [edi+0ch]
push    dword ptr [eax+esi*4]
call    ds:deletefilew
inc     esi
cmp     esi, [edi+10h]
jnz     short loc_402b93
lea     esi, [edi+0ch]
call    sub_402307
mov     eax, [edi+4]
sub     eax, 10h
pop     esi
jmp     sub_4010b5
push    0
push    0
push    1
push    0c000008ch
call    ds:raiseexception
int     3
push    ebp
mov     ebp, esp
mov     eax, 4022ch
call    __alloca_probe
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+var_8], eax
mov     eax, [ebp+arg_0]
push    ebx
push    esi
mov     [ebp+hfile], eax
xor     ebx, ebx
push    ebx
lea     eax, [ebp+numberofbytesread]
push    eax
mov     esi, 200h
push    esi
lea     eax, [ebp+buffer]
push    eax
push    dword ptr [edi]
mov     [ebp+var_4020d], 1
call    ds:readfile
test    eax, eax
jz      loc_402cdb
cmp     [ebp+numberofbytesread], esi
jnz     loc_402cdb
push    4
lea     eax, [ebp+buf1]
push    offset dword_40ebb4
push    eax
call    _memcmp
add     esp, 0ch
test    eax, eax
jnz     short loc_402c5a
mov     eax, [ebp+hfile]
mov     byte ptr [eax], 1
mov     al, 1
jmp     loc_402cdd
push    5
lea     eax, [ebp+buf1]
push    offset austar
push    eax
call    _memcmp
add     esp, 0ch
test    eax, eax
jnz     short loc_402cdb
mov     eax, [edi+4]
sub     eax, 10h
call    sub_402625
add     eax, 10h
mov     [ebp+lpfilename], eax
push    offset multibytestr
lea     eax, [ebp+lpfilename]
push    eax
call    sub_402e14
lea     eax, [ebp+buffer]
push    eax
lea     eax, [ebp+lpfilename]
push    eax
call    sub_402e14
mov     esi, [ebp+lpfilename]
push    ebx
push    100h
push    2
push    ebx
push    ebx
push    40000000h
push    esi
call    ds:createfilew
mov     [ebp+hfile], eax
cmp     eax, 0ffffffffh
jnz     short loc_402ced
lea     eax, [esi-10h]
call    sub_4010b5
xor     al, al
mov     ecx, [ebp+var_8]
pop     esi
xor     ecx, ebp
pop     ebx
call    sub_4088de
leave
retn    4
push    8
lea     eax, [ebp+string]
push    ebx
push    eax
call    _strtol
add     esp, 0ch
push    1
push    ebx
push    ebx
push    dword ptr [edi]
mov     esi, eax
mov     [ebp+var_40218], esi
call    ds:setfilepointer
add     eax, [ebp+var_40218]
neg     esi
and     esi, 1ffh
add     esi, eax
mov     [ebp+var_40228], esi
cmp     [ebp+var_40218], ebx
jbe     short loc_402da8
mov     ecx, [ebp+var_40218]
mov     eax, 40000h
mov     [ebp+nnumberofbytestoread], eax
cmp     ecx, eax
jnb     short loc_402d4c
mov     [ebp+nnumberofbytestoread], ecx
push    ebx
lea     eax, [ebp+numberofbytesread]
push    eax
push    [ebp+nnumberofbytestoread]
lea     eax, [ebp+var_4000c]
push    eax
push    dword ptr [edi]
call    ds:readfile
test    eax, eax
jz      short loc_402da2
push    ebx
lea     eax, [ebp+numberofbytesread]
push    eax
push    [ebp+nnumberofbytestoread]
lea     eax, [ebp+var_4000c]
push    eax
push    [ebp+hfile]
call    ds:writefile
test    eax, eax
jz      short loc_402da2
mov     eax, [ebp+nnumberofbytestoread]
sub     [ebp+var_40218], eax
jnz     short loc_402d31
jmp     short loc_402da8
mov     [ebp+var_4020d], bl
push    [ebp+hfile]
call    ds:closehandle
cmp     [ebp+var_4020d], bl
jz      short loc_402deb
cmp     [edi+8], bl
jz      short loc_402dd7
lea     esi, [edi+0ch]
lea     ebx, [ebp+lpfilename]
call    sub_402291
mov     esi, [ebp+var_40228]
xor     ebx, ebx
mov     eax, [edi+18h]
cmp     eax, ebx
jz      short loc_402deb
push    [ebp+lpfilename]
push    dword ptr [edi+1ch]
call    eax
pop     ecx
pop     ecx
cmp     esi, 0ffffffffh
jz      short loc_402dfb
push    ebx
push    ebx
push    esi
push    dword ptr [edi]
call    ds:setfilepointer
mov     eax, [ebp+lpfilename]
add     eax, 0fffffff0h
call    sub_4010b5
mov     al, [ebp+var_4020d]
jmp     loc_402cdd
push    ebp
mov     ebp, esp
push    ecx
mov     eax, [ebp+arg_0]
push    esi
call    sub_402458
mov     ecx, eax
lea     esi, [ebp+source]
call    sub_40254c
push    [ebp+lpmultibytestr]
mov     eax, esi
push    eax
call    sub_402526
test    al, al
jnz     short loc_402e45
push    [ebp+lpmultibytestr]
mov     eax, esi
push    eax
call    sub_4023fe
mov     esi, [ebp+source]
push    dword ptr [esi-0ch]
mov     eax, [ebp+arg_0]
push    esi
call    sub_402e64
lea     eax, [esi-10h]
call    sub_4010b5
mov     eax, [ebp+arg_0]
pop     esi
leave
retn    8
push    ebp
mov     ebp, esp
push    ecx
push    ebx
push    esi
push    edi
mov     edi, [ebp+source]
mov     esi, eax
mov     eax, [esi]
mov     ebx, [eax-0ch]
sub     edi, eax
xor     eax, eax
sar     edi, 1
cmp     [ebp+maxcount], eax
jge     short loc_402e8a
push    80070057h
call    sub_401000
cmp     [ebp+source], eax
jz      short loc_402e9c
push    [ebp+maxcount]
push    [ebp+source]
call    _wcsnlen
pop     ecx
pop     ecx
mov     ecx, 7fffffffh
sub     ecx, eax
cmp     ecx, ebx
mov     [ebp+maxcount], eax
jl      short loc_402e80
add     eax, ebx
push    eax
mov     [ebp+var_4], eax
call    sub_402567
cmp     edi, ebx
lea     edi, [eax+edi*2]
jbe     short loc_402ebf
mov     edi, [ebp+source]
mov     ecx, [ebp+maxcount]
add     ecx, ecx
push    ecx
push    edi
push    ecx
lea     eax, [eax+ebx*2]
push    eax
call    _memcpy_s
mov     eax, [ebp+var_4]
add     esp, 10h
mov     edx, esi
call    sub_40258d
pop     edi
pop     esi
pop     ebx
leave
retn    8
push    ebp
mov     ebp, esp
sub     esp, 58h
mov     eax, [edx+10h]
mov     [ebp+var_1c], eax
mov     eax, [edx+34h]
mov     ecx, [edx+8]
mov     [ebp+var_10], eax
mov     eax, [edx+38h]
mov     [ebp+var_24], eax
mov     eax, [edx+3ch]
mov     [ebp+var_34], eax
mov     eax, [edx+40h]
mov     [ebp+var_38], eax
mov     eax, [edx+44h]
mov     [ebp+var_44], eax
xor     eax, eax
inc     eax
push    ebx
push    esi
push    edi
mov     edi, eax
shl     edi, cl
mov     ecx, [edx+4]
shl     eax, cl
mov     esi, [edx+1ch]
dec     edi
mov     [ebp+var_58], edi
dec     eax
and     [ebp+var_28], 0
mov     [ebp+var_54], eax
mov     eax, [edx]
mov     [ebp+var_4c], eax
mov     eax, [edx+14h]
mov     [ebp+var_3c], eax
mov     eax, [edx+28h]
mov     [ebp+var_30], eax
mov     eax, [edx+24h]
mov     [ebp+var_14], eax
mov     eax, [edx+2ch]
mov     [ebp+var_20], eax
mov     eax, [edx+30h]
mov     [ebp+var_40], eax
mov     eax, [edx+18h]
mov     [ebp+var_8], eax
mov     eax, [edx+20h]
mov     [ebp+var_4], eax
mov     ebx, [ebp+var_20]
mov     eax, [ebp+var_10]
mov     ecx, [ebp+var_1c]
and     ebx, edi
shl     eax, 4
add     eax, ebx
lea     eax, [ecx+eax*2]
movzx   ecx, word ptr [eax]
mov     [ebp+var_50], ebx
mov     [ebp+var_c], eax
cmp     esi, 1000000h
jnb     short loc_402f9c
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     eax, [ebp+var_c]
mov     edi, esi
shr     edi, 0bh
imul    edi, ecx
cmp     [ebp+var_4], edi
jnb     loc_40314a
mov     esi, edi
mov     edi, 800h
sub     edi, ecx
shr     edi, 5
add     edi, ecx
mov     [eax], di
mov     edi, [ebp+var_1c]
add     edi, 0e6ch
cmp     [ebp+var_40], 0
mov     [ebp+var_c], edi
jnz     short loc_402fd6
cmp     [ebp+var_20], 0
jz      short loc_403008
mov     eax, [ebp+var_14]
test    eax, eax
jnz     short loc_402fe0
mov     eax, [ebp+var_30]
mov     ecx, [ebp+var_3c]
movzx   eax, byte ptr [eax+ecx-1]
mov     ebx, [ebp+var_20]
and     ebx, [ebp+var_54]
push    8
pop     ecx
sub     cl, byte ptr [ebp+var_4c]
shr     eax, cl
mov     ecx, [ebp+var_4c]
shl     ebx, cl
add     eax, ebx
imul    eax, 600h
add     edi, eax
mov     [ebp+var_c], edi
cmp     [ebp+var_10], 7
jnb     short loc_40307b
xor     ebx, ebx
inc     ebx
add     ebx, ebx
movzx   eax, word ptr [ebx+edi]
cmp     esi, 1000000h
jnb     short loc_403039
mov     edi, [ebp+var_8]
mov     ecx, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     ecx, 8
or      ecx, edi
mov     edi, [ebp+var_c]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], ecx
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, eax
cmp     [ebp+var_4], ecx
jnb     short loc_40305a
mov     esi, ecx
mov     ecx, 800h
sub     ecx, eax
shr     ecx, 5
add     ecx, eax
mov     [ebx+edi], cx
jmp     short loc_40306e
sub     [ebp+var_4], ecx
mov     edi, [ebp+var_c]
sub     esi, ecx
mov     ecx, eax
shr     ecx, 5
sub     eax, ecx
mov     [ebx+edi], ax
inc     ebx
cmp     ebx, 100h
jb      short loc_403011
jmp     loc_403129
mov     eax, [ebp+var_14]
cmp     eax, [ebp+var_24]
mov     [ebp+var_2c], 100h
sbb     ecx, ecx
and     ecx, [ebp+var_30]
xor     ebx, ebx
sub     ecx, [ebp+var_24]
add     ecx, [edx+14h]
inc     ebx
movzx   eax, byte ptr [ecx+eax]
mov     [ebp+var_48], eax
jmp     short loc_4030a2
mov     edi, [ebp+var_c]
shl     [ebp+var_48], 1
mov     ecx, [ebp+var_2c]
and     ecx, [ebp+var_48]
mov     eax, [ebp+var_2c]
add     eax, ecx
add     eax, ebx
lea     edi, [edi+eax*2]
movzx   eax, word ptr [edi]
mov     [ebp+var_50], edi
mov     [ebp+var_18], eax
cmp     esi, 1000000h
jnb     short loc_4030dd
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     eax, esi
shr     eax, 0bh
imul    eax, [ebp+var_18]
cmp     [ebp+var_4], eax
jnb     short loc_403101
mov     esi, eax
mov     eax, 800h
sub     eax, [ebp+var_18]
not     ecx
shr     eax, 5
add     eax, [ebp+var_18]
add     ebx, ebx
jmp     short loc_403114
sub     [ebp+var_4], eax
sub     esi, eax
mov     eax, [ebp+var_18]
mov     edi, eax
shr     edi, 5
sub     eax, edi
lea     ebx, [ebx+ebx+1]
mov     edi, [ebp+var_50]
and     [ebp+var_2c], ecx
mov     [edi], ax
cmp     ebx, 100h
jb      loc_40309f
mov     eax, [ebp+var_3c]
mov     ecx, [ebp+var_14]
inc     [ebp+var_14]
inc     [ebp+var_20]
mov     [ecx+eax], bl
mov     eax, [ebp+var_10]
movzx   eax, ds:byte_40eb94[eax]
mov     [ebp+var_10], eax
jmp     loc_403b16
sub     [ebp+var_4], edi
mov     eax, ecx
shr     eax, 5
sub     ecx, eax
mov     eax, [ebp+var_c]
mov     [eax], cx
mov     eax, [ebp+var_10]
mov     ecx, [ebp+var_1c]
sub     esi, edi
lea     ecx, [ecx+eax*2+180h]
movzx   eax, word ptr [ecx]
mov     [ebp+var_c], ecx
cmp     esi, 1000000h
jnb     short loc_403191
mov     edi, [ebp+var_8]
mov     ecx, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     ecx, 8
or      ecx, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+var_c]
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4031c1
add     [ebp+var_10], 0ch
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx], di
mov     ecx, [ebp+var_1c]
add     ecx, 664h
jmp     loc_4033f4
sub     [ebp+var_4], edi
mov     ecx, eax
shr     ecx, 5
sub     eax, ecx
mov     ecx, [ebp+var_c]
sub     esi, edi
cmp     [ebp+var_40], 0
mov     [ecx], ax
jnz     short loc_4031e3
cmp     [ebp+var_20], 0
jz      loc_403b2e
mov     ecx, [ebp+var_1c]
mov     eax, [ebp+var_10]
lea     eax, [ecx+eax*2+198h]
movzx   ecx, word ptr [eax]
mov     [ebp+var_c], eax
cmp     esi, 1000000h
jnb     short loc_403215
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     edi, esi
shr     edi, 0bh
imul    edi, ecx
cmp     [ebp+var_4], edi
jnb     loc_4032db
mov     eax, 800h
sub     eax, ecx
shr     eax, 5
add     eax, ecx
mov     ecx, [ebp+var_c]
mov     [ecx], ax
mov     eax, [ebp+var_10]
mov     ecx, [ebp+var_1c]
add     eax, 0fh
shl     eax, 4
add     eax, ebx
lea     eax, [ecx+eax*2]
movzx   ecx, word ptr [eax]
mov     esi, edi
mov     [ebp+var_18], ecx
cmp     edi, 1000000h
jnb     short loc_403272
mov     ecx, [ebp+var_4]
shl     edi, 8
mov     esi, edi
mov     edi, [ebp+var_8]
movzx   edi, byte ptr [edi]
shl     ecx, 8
or      ecx, edi
inc     [ebp+var_8]
mov     [ebp+var_4], ecx
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, [ebp+var_18]
cmp     [ebp+var_4], ecx
jnb     short loc_4032c4
mov     edi, [ebp+var_14]
mov     esi, ecx
mov     ecx, 800h
sub     ecx, [ebp+var_18]
shr     ecx, 5
add     ecx, [ebp+var_18]
cmp     edi, [ebp+var_24]
mov     [eax], cx
mov     eax, [ebp+var_3c]
sbb     ecx, ecx
and     ecx, [ebp+var_30]
sub     ecx, [ebp+var_24]
add     ecx, edi
mov     cl, [ecx+eax]
mov     [edi+eax], cl
inc     edi
inc     [ebp+var_20]
cmp     [ebp+var_10], 7
mov     [ebp+var_14], edi
sbb     eax, eax
and     eax, 0fffffffeh
add     eax, 0bh
jmp     loc_403142
sub     [ebp+var_4], ecx
sub     esi, ecx
mov     ecx, [ebp+var_18]
mov     edi, ecx
shr     edi, 5
sub     ecx, edi
mov     [eax], cx
jmp     loc_4033dc
sub     [ebp+var_4], edi
mov     eax, ecx
shr     eax, 5
sub     ecx, eax
mov     eax, [ebp+var_c]
mov     [eax], cx
mov     ecx, [ebp+var_1c]
mov     eax, [ebp+var_10]
sub     esi, edi
lea     eax, [ecx+eax*2+1b0h]
movzx   ecx, word ptr [eax]
mov     [ebp+var_c], eax
cmp     esi, 1000000h
jnb     short loc_403322
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     eax, [ebp+var_c]
mov     edi, esi
shr     edi, 0bh
imul    edi, ecx
cmp     [ebp+var_4], edi
jnb     short loc_403348
mov     esi, edi
mov     edi, 800h
sub     edi, ecx
shr     edi, 5
add     edi, ecx
mov     [eax], di
mov     eax, [ebp+var_34]
jmp     loc_4033d3
sub     [ebp+var_4], edi
mov     eax, ecx
shr     eax, 5
sub     ecx, eax
mov     eax, [ebp+var_c]
mov     [eax], cx
mov     eax, [ebp+var_10]
mov     ecx, [ebp+var_1c]
sub     esi, edi
lea     ecx, [ecx+eax*2+1c8h]
movzx   eax, word ptr [ecx]
mov     [ebp+var_c], ecx
cmp     esi, 1000000h
jnb     short loc_40338f
mov     edi, [ebp+var_8]
mov     ecx, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     ecx, 8
or      ecx, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+var_c]
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4033b2
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     eax, [ebp+var_38]
mov     [ecx], di
jmp     short loc_4033cd
sub     [ebp+var_4], edi
mov     ecx, eax
shr     ecx, 5
sub     esi, edi
sub     eax, ecx
mov     ecx, [ebp+var_c]
mov     [ecx], ax
mov     ecx, [ebp+var_38]
mov     eax, [ebp+var_44]
mov     [ebp+var_44], ecx
mov     ecx, [ebp+var_34]
mov     [ebp+var_38], ecx
mov     ecx, [ebp+var_24]
mov     [ebp+var_34], ecx
mov     [ebp+var_24], eax
cmp     [ebp+var_10], 7
mov     ecx, [ebp+var_1c]
sbb     eax, eax
and     eax, 0fffffffdh
add     eax, 0bh
mov     [ebp+var_10], eax
add     ecx, 0a68h
movzx   eax, word ptr [ecx]
mov     [ebp+var_18], eax
cmp     esi, 1000000h
jnb     short loc_403419
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     eax, esi
shr     eax, 0bh
imul    eax, [ebp+var_18]
cmp     [ebp+var_4], eax
jnb     short loc_403451
mov     esi, eax
mov     eax, 800h
sub     eax, [ebp+var_18]
shl     ebx, 4
shr     eax, 5
add     eax, [ebp+var_18]
and     [ebp+var_2c], 0
mov     [ecx], ax
lea     ecx, [ebx+ecx+4]
mov     [ebp+var_28], 8
jmp     loc_4034e1
sub     [ebp+var_4], eax
sub     esi, eax
mov     eax, [ebp+var_18]
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx], ax
movzx   edi, word ptr [ecx+2]
cmp     esi, 1000000h
jnb     short loc_403489
mov     ebx, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     eax, 8
or      eax, ebx
mov     ebx, [ebp+var_50]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
mov     eax, esi
shr     eax, 0bh
imul    eax, edi
cmp     [ebp+var_4], eax
jnb     short loc_4034bd
mov     esi, eax
mov     eax, 800h
sub     eax, edi
shr     eax, 5
add     eax, edi
mov     [ecx+2], ax
push    8
pop     eax
shl     ebx, 4
lea     ecx, [ebx+ecx+104h]
mov     [ebp+var_2c], eax
mov     [ebp+var_28], eax
jmp     short loc_4034e1
sub     [ebp+var_4], eax
sub     esi, eax
mov     eax, edi
shr     eax, 5
sub     edi, eax
mov     [ecx+2], di
add     ecx, 204h
mov     [ebp+var_2c], 10h
mov     [ebp+var_28], 100h
xor     edi, edi
inc     edi
add     edi, edi
movzx   eax, word ptr [edi+ecx]
mov     [ebp+var_50], edi
cmp     esi, 1000000h
jnb     short loc_40350f
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, [ebp+var_50]
mov     ebx, esi
shr     ebx, 0bh
imul    ebx, eax
cmp     [ebp+var_4], ebx
jnb     short loc_403530
mov     esi, ebx
mov     ebx, 800h
sub     ebx, eax
shr     ebx, 5
add     ebx, eax
mov     [edi+ecx], bx
jmp     short loc_403544
sub     [ebp+var_4], ebx
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     edi, [ebp+var_50]
sub     esi, ebx
mov     [edi+ecx], ax
inc     edi
mov     eax, [ebp+var_2c]
cmp     edi, [ebp+var_28]
jb      short loc_4034e4
sub     eax, [ebp+var_28]
add     edi, eax
cmp     [ebp+var_10], 0ch
mov     [ebp+var_28], edi
jb      loc_403a9d
cmp     edi, 4
jnb     short loc_403567
mov     ecx, edi
jmp     short loc_40356a
push    3
pop     ecx
mov     eax, [ebp+var_1c]
shl     ecx, 7
lea     ecx, [ecx+eax+360h]
movzx   eax, word ptr [ecx+2]
cmp     esi, 1000000h
jnb     short loc_40359a
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4035bd
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx+2], di
push    2
jmp     short loc_4035cf
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx+2], ax
push    3
pop     eax
lea     ebx, [eax+eax]
movzx   eax, word ptr [ebx+ecx]
mov     [ebp+var_18], ebx
cmp     esi, 1000000h
jnb     short loc_4035fc
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_18]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_40361f
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ebx+ecx], di
mov     edi, ebx
jmp     short loc_403633
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     edi, [ebp+var_18]
mov     [edi+ecx], ax
inc     edi
lea     ebx, [edi+edi]
movzx   eax, word ptr [ebx+ecx]
mov     [ebp+var_18], ebx
cmp     esi, 1000000h
jnb     short loc_40365f
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_18]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_403682
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ebx+ecx], di
mov     edi, ebx
jmp     short loc_403696
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     edi, [ebp+var_18]
mov     [edi+ecx], ax
inc     edi
lea     ebx, [edi+edi]
movzx   eax, word ptr [ebx+ecx]
mov     [ebp+var_18], ebx
cmp     esi, 1000000h
jnb     short loc_4036c2
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_18]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4036e5
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ebx+ecx], di
mov     edi, ebx
jmp     short loc_4036f9
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     edi, [ebp+var_18]
mov     [edi+ecx], ax
inc     edi
add     edi, edi
movzx   eax, word ptr [edi+ecx]
mov     [ebp+var_18], edi
cmp     esi, 1000000h
jnb     short loc_403724
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, [ebp+var_18]
mov     ebx, esi
shr     ebx, 0bh
imul    ebx, eax
cmp     [ebp+var_4], ebx
jnb     short loc_403745
mov     esi, ebx
mov     ebx, 800h
sub     ebx, eax
shr     ebx, 5
add     ebx, eax
mov     [edi+ecx], bx
jmp     short loc_403759
sub     [ebp+var_4], ebx
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     edi, [ebp+var_18]
sub     esi, ebx
mov     [edi+ecx], ax
inc     edi
lea     ebx, [edi+edi]
add     ecx, ebx
movzx   eax, word ptr [ecx]
mov     [ebp+var_18], ebx
cmp     esi, 1000000h
jnb     short loc_403786
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_18]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4037a8
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx], di
mov     eax, ebx
jmp     short loc_4037bb
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx], ax
mov     eax, [ebp+var_18]
inc     eax
sub     eax, 40h
cmp     eax, 4
jb      loc_403a5f
xor     edi, edi
inc     edi
mov     ecx, eax
mov     ebx, eax
shr     ecx, 1
and     ebx, edi
dec     ecx
or      ebx, 2
mov     [ebp+var_50], ecx
cmp     eax, 0eh
jnb     loc_40386f
shl     ebx, cl
mov     [ebp+var_48], edi
mov     [ebp+var_18], ebx
sub     ebx, eax
mov     eax, [ebp+var_1c]
lea     ecx, [eax+ebx*2+55eh]
mov     [ebp+var_c], ecx
add     edi, edi
movzx   eax, word ptr [edi+ecx]
cmp     esi, 1000000h
jnb     short loc_403821
mov     ebx, [ebp+var_8]
mov     ecx, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     ecx, 8
or      ecx, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+var_c]
mov     ebx, esi
shr     ebx, 0bh
imul    ebx, eax
cmp     [ebp+var_4], ebx
jnb     short loc_403845
mov     esi, ebx
mov     ebx, 800h
sub     ebx, eax
shr     ebx, 5
add     ebx, eax
mov     eax, [ebp+var_18]
mov     [edi+ecx], bx
jmp     short loc_403862
sub     [ebp+var_4], ebx
mov     ecx, eax
shr     ecx, 5
sub     eax, ecx
mov     ecx, [ebp+var_c]
mov     [edi+ecx], ax
mov     eax, [ebp+var_18]
sub     esi, ebx
inc     edi
or      eax, [ebp+var_48]
mov     [ebp+var_18], eax
shl     [ebp+var_48], 1
dec     [ebp+var_50]
jnz     short loc_4037f9
jmp     loc_403a5f
sub     ecx, 4
cmp     esi, 1000000h
jnb     short loc_403891
mov     edi, [ebp+var_8]
mov     eax, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     eax, 8
or      eax, edi
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], eax
shr     esi, 1
sub     [ebp+var_4], esi
mov     eax, [ebp+var_4]
shr     eax, 1fh
neg     eax
lea     ebx, [eax+ebx*2+1]
and     eax, esi
add     [ebp+var_4], eax
dec     ecx
jnz     short loc_403872
mov     ecx, [ebp+var_1c]
movzx   eax, word ptr [ecx+646h]
shl     ebx, 4
mov     [ebp+var_18], ebx
cmp     esi, 1000000h
jnb     short loc_4038d9
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4038ff
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx+646h], di
push    2
jmp     short loc_403918
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
or      [ebp+var_18], 1
mov     [ecx+646h], ax
push    3
pop     eax
lea     ebx, [eax+eax]
lea     ecx, [ebx+ecx+644h]
movzx   eax, word ptr [ecx]
mov     [ebp+var_2c], ebx
cmp     esi, 1000000h
jnb     short loc_40394b
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_2c]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_40396d
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx], di
mov     eax, ebx
jmp     short loc_403984
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx], ax
mov     eax, [ebp+var_2c]
inc     eax
or      [ebp+var_18], 2
lea     ebx, [eax+eax]
mov     eax, [ebp+var_1c]
lea     ecx, [ebx+eax+644h]
movzx   eax, word ptr [ecx]
mov     [ebp+var_2c], ebx
cmp     esi, 1000000h
jnb     short loc_4039b9
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
mov     ebx, [ebp+var_2c]
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_4039db
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     [ecx], di
mov     eax, ebx
jmp     short loc_4039f2
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx], ax
mov     eax, [ebp+var_2c]
inc     eax
or      [ebp+var_18], 4
mov     ecx, [ebp+var_1c]
lea     ecx, [ecx+eax*2+644h]
movzx   eax, word ptr [ecx]
cmp     esi, 1000000h
jnb     short loc_403a1e
mov     ebx, [ebp+var_8]
mov     edi, [ebp+var_4]
movzx   ebx, byte ptr [ebx]
shl     edi, 8
or      edi, ebx
shl     esi, 8
inc     [ebp+var_8]
mov     [ebp+var_4], edi
mov     edi, esi
shr     edi, 0bh
imul    edi, eax
cmp     [ebp+var_4], edi
jnb     short loc_403a41
mov     esi, edi
mov     edi, 800h
sub     edi, eax
shr     edi, 5
add     edi, eax
mov     eax, [ebp+var_18]
mov     [ecx], di
jmp     short loc_403a56
sub     [ebp+var_4], edi
sub     esi, edi
mov     edi, eax
shr     edi, 5
sub     eax, edi
mov     [ecx], ax
mov     eax, [ebp+var_18]
or      eax, 8
cmp     eax, 0ffffffffh
jz      loc_403b33
cmp     [ebp+var_40], 0
mov     ecx, [ebp+var_38]
mov     edi, [ebp+var_28]
mov     [ebp+var_44], ecx
mov     ecx, [ebp+var_34]
mov     [ebp+var_38], ecx
mov     ecx, [ebp+var_24]
mov     [ebp+var_34], ecx
lea     ecx, [eax+1]
mov     [ebp+var_24], ecx
jnz     short loc_403a85
cmp     eax, [ebp+var_20]
jmp     short loc_403a88
cmp     eax, [ebp+var_40]
jnb     loc_403b2e
cmp     [ebp+var_10], 13h
sbb     eax, eax
and     eax, 0fffffffdh
add     eax, 0ah
mov     [ebp+var_10], eax
mov     eax, [ebp+arg_0]
mov     ecx, [ebp+var_14]
inc     edi
inc     edi
cmp     eax, ecx
jz      loc_403b2e
sub     eax, ecx
cmp     eax, edi
jnb     short loc_403ab8
mov     [ebp+var_48], eax
jmp     short loc_403abd
mov     eax, edi
mov     [ebp+var_48], edi
cmp     ecx, [ebp+var_24]
sbb     ecx, ecx
and     ecx, [ebp+var_30]
add     [ebp+var_20], eax
sub     ecx, [ebp+var_24]
sub     edi, eax
add     ecx, [ebp+var_14]
mov     [ebp+var_28], edi
lea     edi, [ecx+eax]
cmp     edi, [ebp+var_30]
mov     edi, [ebp+var_3c]
ja      short loc_403afd
mov     ebx, [ebp+var_14]
sub     ecx, ebx
add     edi, ebx
add     [ebp+var_14], eax
mov     [ebp+var_50], ecx
lea     ebx, [edi+eax]
mov     eax, [ebp+var_50]
mov     al, [eax+edi]
mov     [edi], al
inc     edi
cmp     edi, ebx
jnz     short loc_403aee
jmp     short loc_403b16
mov     ebx, [ebp+var_14]
mov     al, [ecx+edi]
inc     [ebp+var_14]
inc     ecx
mov     [ebx+edi], al
cmp     ecx, [ebp+var_30]
jnz     short loc_403b11
xor     ecx, ecx
dec     [ebp+var_48]
jnz     short loc_403afd
mov     eax, [ebp+var_14]
cmp     eax, [ebp+arg_0]
jnb     short loc_403b3e
mov     eax, [ebp+var_8]
cmp     eax, [ebp+arg_4]
jnb     short loc_403b3e
mov     edi, [ebp+var_58]
jmp     loc_402f5e
xor     eax, eax
inc     eax
jmp     short loc_403b99
add     [ebp+var_28], 112h
sub     [ebp+var_10], 0ch
mov     eax, [ebp+var_8]
cmp     esi, 1000000h
jnb     short loc_403b5b
mov     ecx, [ebp+var_4]
movzx   edi, byte ptr [eax]
shl     ecx, 8
or      ecx, edi
shl     esi, 8
mov     [ebp+var_4], ecx
inc     eax
mov     [edx+18h], eax
mov     eax, [ebp+var_4]
mov     [edx+20h], eax
mov     eax, [ebp+var_28]
mov     [edx+48h], eax
mov     eax, [ebp+var_14]
mov     [edx+24h], eax
mov     eax, [ebp+var_20]
mov     [edx+2ch], eax
mov     eax, [ebp+var_24]
mov     [edx+38h], eax
mov     eax, [ebp+var_34]
mov     [edx+3ch], eax
mov     eax, [ebp+var_38]
mov     [edx+40h], eax
mov     eax, [ebp+var_44]
mov     [edx+44h], eax
mov     eax, [ebp+var_10]
mov     [edx+34h], eax
mov     [edx+1ch], esi
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn    8
push    ebp
mov     ebp, esp
push    ecx
push    ecx
mov     edx, [eax+48h]
test    edx, edx
jz      short locret_403c15
cmp     edx, 112h
jnb     short locret_403c15
mov     ecx, [eax+24h]
push    ebx
mov     ebx, [eax+38h]
push    esi
mov     esi, [eax+28h]
mov     [ebp+var_4], ebx
mov     ebx, [ebp+arg_0]
mov     [ebp+var_8], esi
mov     esi, edx
sub     ebx, ecx
push    edi
mov     edi, [eax+14h]
cmp     ebx, esi
jnb     short loc_403bd6
mov     esi, ebx
cmp     dword ptr [eax+30h], 0
jnz     short loc_403bec
mov     ebx, [eax+0ch]
sub     ebx, [eax+2ch]
cmp     ebx, esi
ja      short loc_403bec
mov     ebx, [eax+0ch]
mov     [eax+30h], ebx
add     [eax+2ch], esi
sub     edx, esi
mov     [eax+48h], edx
jmp     short loc_403c0b
dec     esi
cmp     ecx, [ebp+var_4]
sbb     edx, edx
and     edx, [ebp+var_8]
sub     edx, [ebp+var_4]
add     edx, ecx
mov     dl, [edx+edi]
mov     [ecx+edi], dl
inc     ecx
test    esi, esi
jnz     short loc_403bf6
pop     edi
pop     esi
mov     [eax+24h], ecx
pop     ebx
leave
retn    4
push    ebx
cmp     dword ptr [esi+30h], 0
mov     edx, edi
jnz     short loc_403c36
mov     eax, [esi+0ch]
mov     ecx, [esi+24h]
sub     eax, [esi+2ch]
mov     ebx, edi
sub     ebx, ecx
cmp     ebx, eax
jbe     short loc_403c36
lea     edx, [ecx+eax]
mov     ebx, [esp+4+arg_0]
push    ebx
push    edx
mov     edx, esi
call    sub_402ee4
test    eax, eax
jnz     short loc_403c7f
mov     eax, [esi+0ch]
cmp     [esi+2ch], eax
jb      short loc_403c52
mov     [esi+30h], eax
push    edi
mov     eax, esi
call    sub_403ba0
cmp     [esi+24h], edi
jnb     short loc_403c70
cmp     [esi+18h], ebx
jnb     short loc_403c70
mov     eax, 112h
cmp     [esi+48h], eax
jb      short loc_403c1a
jmp     short loc_403c75
mov     eax, 112h
cmp     [esi+48h], eax
jbe     short loc_403c7d
mov     [esi+48h], eax
xor     eax, eax
pop     ebx
retn    4
push    ebp
mov     ebp, esp
sub     esp, 18h
mov     ecx, [eax+20h]
mov     edx, [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+arg_4]
add     edx, ecx
mov     ecx, [eax+8]
mov     [ebp+arg_4], edx
xor     edx, edx
inc     edx
shl     edx, cl
push    ebx
mov     ebx, [eax+10h]
push    esi
mov     esi, [eax+1ch]
push    edi
mov     edi, [eax+34h]
dec     edx
and     edx, [eax+2ch]
mov     ecx, edi
shl     ecx, 4
add     ecx, edx
movzx   ecx, word ptr [ebx+ecx*2]
mov     [ebp+var_8], ebx
mov     [ebp+var_14], ecx
cmp     esi, 1000000h
jnb     short loc_403cee
mov     ecx, [ebp+arg_0]
cmp     ecx, [ebp+arg_4]
jb      short loc_403cda
xor     eax, eax
jmp     loc_40423d
mov     ebx, [ebp+var_4]
movzx   ecx, byte ptr [ecx]
shl     ebx, 8
or      ebx, ecx
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], ebx
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, [ebp+var_14]
cmp     [ebp+var_4], ecx
jnb     loc_403e4f
mov     esi, ecx
mov     ecx, [ebp+var_8]
add     ecx, 0e6ch
cmp     dword ptr [eax+30h], 0
mov     [ebp+var_c], ecx
jnz     short loc_403d1a
cmp     dword ptr [eax+2ch], 0
jz      short loc_403d50
mov     ecx, [eax+24h]
test    ecx, ecx
jnz     short loc_403d24
mov     ecx, [eax+28h]
mov     ebx, [eax+14h]
movzx   ebx, byte ptr [ebx+ecx-1]
mov     edx, [eax]
push    8
pop     ecx
sub     cl, dl
xor     edx, edx
shr     ebx, cl
mov     ecx, [eax+4]
inc     edx
shl     edx, cl
mov     ecx, [eax]
dec     edx
and     edx, [eax+2ch]
shl     edx, cl
add     ebx, edx
imul    ebx, 600h
add     [ebp+var_c], ebx
cmp     edi, 7
jnb     short loc_403dae
xor     ecx, ecx
inc     ecx
mov     ebx, 1000000h
mov     eax, [ebp+var_c]
add     ecx, ecx
movzx   edx, word ptr [ecx+eax]
cmp     esi, ebx
jnb     short loc_403d8a
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edi, 8
or      edi, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
mov     eax, esi
shr     eax, 0bh
imul    eax, edx
cmp     [ebp+var_4], eax
jnb     short loc_403d9b
mov     esi, eax
jmp     short loc_403da1
sub     [ebp+var_4], eax
sub     esi, eax
inc     ecx
cmp     ecx, 100h
jb      short loc_403d5d
jmp     loc_403e43
mov     edx, [eax+24h]
mov     edi, [eax+38h]
cmp     edx, edi
jnb     short loc_403dbd
mov     ecx, [eax+28h]
jmp     short loc_403dbf
xor     ecx, ecx
mov     eax, [eax+14h]
sub     eax, edi
add     eax, edx
movzx   eax, byte ptr [eax+ecx]
xor     edx, edx
mov     [ebp+var_10], eax
mov     [ebp+var_8], 100h
inc     edx
mov     ebx, 1000000h
shl     [ebp+var_10], 1
mov     eax, [ebp+var_8]
and     eax, [ebp+var_10]
mov     edi, [ebp+var_c]
lea     ecx, [eax+edx]
add     ecx, [ebp+var_8]
movzx   ecx, word ptr [edi+ecx*2]
mov     [ebp+var_14], ecx
cmp     esi, ebx
jnb     short loc_403e19
mov     ecx, [ebp+arg_0]
cmp     ecx, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   ecx, byte ptr [ecx]
shl     edi, 8
or      edi, ecx
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, [ebp+var_14]
cmp     [ebp+var_4], ecx
jnb     short loc_403e2f
mov     esi, ecx
add     edx, edx
not     eax
jmp     short loc_403e38
sub     esi, ecx
sub     [ebp+var_4], ecx
lea     edx, [edx+edx+1]
and     [ebp+var_8], eax
cmp     edx, 100h
jb      short loc_403ddc
mov     [ebp+var_10], 1
jmp     loc_40422a
sub     [ebp+var_4], ecx
sub     esi, ecx
mov     ebx, 1000000h
cmp     esi, ebx
jnb     short loc_403e7d
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     ecx, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     ecx, 8
or      ecx, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+var_8]
movzx   ecx, word ptr [ecx+edi*2+180h]
mov     eax, esi
shr     eax, 0bh
imul    eax, ecx
cmp     [ebp+var_4], eax
jnb     short loc_403eb0
mov     ecx, [ebp+var_8]
and     [ebp+var_18], 0
mov     esi, eax
add     ecx, 664h
mov     [ebp+var_10], 2
jmp     loc_403ff3
sub     [ebp+var_4], eax
sub     esi, eax
mov     [ebp+var_10], 3
cmp     esi, ebx
jnb     short loc_403ee0
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     ecx, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     ecx, 8
or      ecx, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     eax, [ebp+var_8]
movzx   eax, word ptr [eax+edi*2+198h]
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, eax
cmp     [ebp+var_4], ecx
jnb     short loc_403f58
mov     eax, [ebp+var_8]
add     edi, 0fh
shl     edi, 4
add     edi, edx
movzx   edi, word ptr [eax+edi*2]
mov     esi, ecx
cmp     ecx, ebx
jnb     short loc_403f2f
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
movzx   eax, byte ptr [eax]
shl     ecx, 8
mov     esi, ecx
mov     ecx, [ebp+var_4]
shl     ecx, 8
or      ecx, eax
inc     [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     eax, esi
shr     eax, 0bh
imul    eax, edi
cmp     [ebp+var_4], eax
jnb     loc_403fde
cmp     eax, ebx
jnb     short loc_403f50
mov     eax, [ebp+arg_4]
cmp     [ebp+arg_0], eax
jnb     loc_403cd3
push    3
pop     eax
jmp     loc_40423d
sub     [ebp+var_4], ecx
sub     esi, ecx
cmp     esi, ebx
jnb     short loc_403f81
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     ecx, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     ecx, 8
or      ecx, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     ecx, [ebp+var_8]
movzx   ecx, word ptr [ecx+edi*2+1b0h]
mov     eax, esi
shr     eax, 0bh
imul    eax, ecx
cmp     [ebp+var_4], eax
jb      short loc_403fda
sub     [ebp+var_4], eax
sub     esi, eax
mov     eax, [ebp+var_8]
movzx   ecx, word ptr [eax+edi*2+1c8h]
cmp     esi, ebx
jnb     short loc_403fcd
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edi, 8
or      edi, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
mov     eax, esi
shr     eax, 0bh
imul    eax, ecx
cmp     [ebp+var_4], eax
jnb     short loc_403fde
mov     esi, eax
jmp     short loc_403fe3
sub     esi, eax
sub     [ebp+var_4], eax
mov     ecx, [ebp+var_8]
mov     [ebp+var_18], 0ch
add     ecx, 0a68h
cmp     esi, ebx
jnb     short loc_404017
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edi, 8
or      edi, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
movzx   edi, word ptr [ecx]
mov     eax, esi
shr     eax, 0bh
imul    eax, edi
cmp     [ebp+var_4], eax
jnb     short loc_40403d
shl     edx, 4
and     [ebp+var_14], 0
mov     esi, eax
lea     ecx, [edx+ecx+4]
mov     [ebp+var_c], 8
jmp     short loc_4040a7
sub     [ebp+var_4], eax
sub     esi, eax
cmp     esi, ebx
jnb     short loc_404066
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edi, 8
or      edi, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
movzx   edi, word ptr [ecx+2]
mov     eax, esi
shr     eax, 0bh
imul    eax, edi
cmp     [ebp+var_4], eax
jnb     short loc_40408e
push    8
mov     esi, eax
pop     eax
shl     edx, 4
lea     ecx, [edx+ecx+104h]
mov     [ebp+var_14], eax
mov     [ebp+var_c], eax
jmp     short loc_4040a7
sub     [ebp+var_4], eax
sub     esi, eax
add     ecx, 204h
mov     [ebp+var_14], 10h
mov     [ebp+var_c], 100h
xor     eax, eax
inc     eax
add     eax, eax
cmp     esi, ebx
jnb     short loc_4040d0
mov     edx, [ebp+arg_0]
cmp     edx, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   edx, byte ptr [edx]
shl     edi, 8
or      edi, edx
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
movzx   edi, word ptr [eax+ecx]
mov     edx, esi
shr     edx, 0bh
imul    edx, edi
cmp     [ebp+var_4], edx
jnb     short loc_4040e5
mov     esi, edx
jmp     short loc_4040eb
sub     [ebp+var_4], edx
sub     esi, edx
inc     eax
cmp     eax, [ebp+var_c]
jb      short loc_4040aa
mov     ecx, [ebp+var_14]
sub     ecx, [ebp+var_c]
add     eax, ecx
cmp     [ebp+var_18], 4
jnb     loc_40422a
cmp     eax, 4
jb      short loc_40410a
push    3
pop     eax
mov     edi, [ebp+var_8]
shl     eax, 7
lea     eax, [eax+edi+360h]
mov     [ebp+var_c], eax
xor     eax, eax
inc     eax
mov     ecx, [ebp+var_c]
add     eax, eax
movzx   edx, word ptr [eax+ecx]
cmp     esi, ebx
jnb     short loc_404150
mov     ecx, [ebp+arg_0]
cmp     ecx, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+arg_0]
mov     ecx, [ebp+var_4]
movzx   edi, byte ptr [edi]
shl     ecx, 8
or      ecx, edi
mov     edi, [ebp+var_8]
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], ecx
mov     ecx, esi
shr     ecx, 0bh
imul    ecx, edx
cmp     [ebp+var_4], ecx
jnb     short loc_404161
mov     esi, ecx
jmp     short loc_404167
sub     [ebp+var_4], ecx
sub     esi, ecx
inc     eax
cmp     eax, 40h
jb      short loc_40411d
sub     eax, 40h
cmp     eax, 4
jb      loc_40422a
mov     ecx, eax
shr     ecx, 1
dec     ecx
mov     [ebp+var_14], ecx
cmp     eax, 0eh
jnb     short loc_40419a
mov     edx, eax
and     edx, 1
or      edx, 2
shl     edx, cl
sub     edx, eax
lea     ecx, [edi+edx*2+55eh]
jmp     short loc_4041e1
sub     ecx, 4
cmp     esi, ebx
jnb     short loc_4041c1
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edx, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edx, 8
or      edx, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edx
mov     eax, [ebp+var_4]
shr     esi, 1
sub     eax, esi
shr     eax, 1fh
dec     eax
and     eax, esi
sub     [ebp+var_4], eax
dec     ecx
jnz     short loc_40419d
lea     ecx, [edi+644h]
mov     [ebp+var_14], 4
xor     edx, edx
inc     edx
add     edx, edx
cmp     esi, ebx
jnb     short loc_40420a
mov     eax, [ebp+arg_0]
cmp     eax, [ebp+arg_4]
jnb     loc_403cd3
mov     edi, [ebp+var_4]
movzx   eax, byte ptr [eax]
shl     edi, 8
or      edi, eax
shl     esi, 8
inc     [ebp+arg_0]
mov     [ebp+var_4], edi
movzx   edi, word ptr [edx+ecx]
mov     eax, esi
shr     eax, 0bh
imul    eax, edi
cmp     [ebp+var_4], eax
jnb     short loc_40421f
mov     esi, eax
jmp     short loc_404225
sub     [ebp+var_4], eax
sub     esi, eax
inc     edx
dec     [ebp+var_14]
jnz     short loc_4041e4
cmp     esi, ebx
jnb     short loc_40423a
mov     eax, [ebp+arg_4]
cmp     [ebp+arg_0], eax
jnb     loc_403cd3
mov     eax, [ebp+var_10]
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
mov     ebp, esp
sub     esp, 10h
push    esi
push    edi
mov     edi, [ebx]
push    [ebp+arg_0]
and     dword ptr [ebx], 0
mov     esi, eax
mov     [ebp+var_4], edi
call    sub_403ba0
mov     eax, [ebp+arg_c]
and     dword ptr [eax], 0
cmp     dword ptr [esi+48h], 112h
jnz     short loc_404289
mov     esi, [esi+20h]
test    esi, esi
jnz     short loc_40427b
mov     eax, [ebp+arg_c]
mov     dword ptr [eax], 1
xor     eax, eax
test    esi, esi
setnz   al
pop     edi
pop     esi
leave
retn
mov     edi, [ebp+var_4]
xor     ecx, ecx
cmp     [esi+4ch], ecx
jz      short loc_4042f3
cmp     edi, ecx
jbe     short loc_4042b3
mov     eax, [esi+58h]
cmp     eax, 5
jnb     short loc_4042b3
mov     edx, [ebp+src]
mov     dl, [edx]
mov     [eax+esi+5ch], dl
inc     dword ptr [esi+58h]
inc     [ebp+src]
inc     dword ptr [ebx]
dec     edi
mov     [ebp+var_4], edi
jnz     short loc_404294
cmp     dword ptr [esi+58h], 5
jb      loc_404477
cmp     byte ptr [esi+5ch], 0
jnz     loc_404487
movzx   eax, byte ptr [esi+5dh]
movzx   edx, byte ptr [esi+5eh]
shl     eax, 8
or      eax, edx
movzx   edx, byte ptr [esi+5fh]
shl     eax, 8
or      eax, edx
movzx   edx, byte ptr [esi+60h]
shl     eax, 8
or      eax, edx
or      dword ptr [esi+1ch], 0ffffffffh
mov     [esi+20h], eax
mov     [esi+4ch], ecx
mov     [esi+58h], ecx
mov     eax, [esi+24h]
mov     [ebp+var_c], ecx
cmp     eax, [ebp+arg_0]
jb      short loc_404327
mov     eax, [esi+48h]
cmp     eax, ecx
jnz     short loc_40430e
cmp     [esi+20h], ecx
jz      loc_40448f
cmp     [ebp+arg_8], ecx
jz      loc_40449a
cmp     eax, ecx
jnz     loc_4044aa
xor     eax, eax
inc     eax
mov     [ebp+var_c], eax
jmp     short loc_40432a
xor     eax, eax
inc     eax
cmp     [esi+50h], ecx
jz      short loc_40437a
mov     ecx, [esi+4]
add     ecx, [esi]
mov     edx, 300h
shl     edx, cl
add     edx, 736h
jz      short loc_404366
mov     edi, [esi+10h]
mov     ecx, edx
mov     eax, 400h
movzx   edx, ax
mov     eax, edx
shl     edx, 10h
or      eax, edx
shr     ecx, 1
rep stosd
adc     ecx, ecx
rep stosw
mov     edi, [ebp+var_4]
xor     eax, eax
inc     eax
xor     ecx, ecx
mov     [esi+44h], eax
mov     [esi+40h], eax
mov     [esi+3ch], eax
mov     [esi+38h], eax
mov     [esi+34h], ecx
mov     [esi+50h], ecx
mov     eax, [esi+58h]
cmp     eax, ecx
jnz     short loc_4043e5
cmp     edi, 14h
jb      short loc_404394
cmp     [ebp+var_c], ecx
jnz     short loc_404394
mov     eax, [ebp+src]
lea     edi, [edi+eax-14h]
jmp     short loc_4043bb
push    edi
push    [ebp+src]
mov     eax, esi
call    sub_403c83
pop     ecx
pop     ecx
test    eax, eax
jz      loc_4044af
cmp     [ebp+var_c], 0
jz      short loc_4043b8
cmp     eax, 2
jnz     loc_4044aa
mov     edi, [ebp+src]
mov     eax, [ebp+src]
push    edi
mov     edi, [ebp+arg_0]
mov     [esi+18h], eax
call    sub_403c19
test    eax, eax
jnz     loc_404487
mov     eax, [esi+18h]
sub     eax, [ebp+src]
add     [ebx], eax
add     [ebp+src], eax
sub     [ebp+var_4], eax
jmp     loc_404465
mov     [ebp+var_8], ecx
jmp     short loc_404400
cmp     [ebp+var_8], edi
jnb     short loc_404408
mov     edx, [ebp+var_8]
mov     ecx, [ebp+src]
mov     cl, [edx+ecx]
mov     [eax+esi+5ch], cl
inc     eax
inc     [ebp+var_8]
mov     [ebp+var_10], eax
cmp     eax, 14h
jb      short loc_4043ea
mov     [esi+58h], eax
cmp     eax, 14h
jb      short loc_404416
cmp     [ebp+var_c], 0
jz      short loc_404437
push    eax
lea     eax, [esi+5ch]
push    eax
mov     eax, esi
call    sub_403c83
pop     ecx
pop     ecx
test    eax, eax
jz      loc_4044c6
cmp     [ebp+var_c], 0
jz      short loc_404437
cmp     eax, 2
jnz     short loc_4044aa
mov     edi, [ebp+arg_0]
lea     eax, [esi+5ch]
push    eax
mov     [esi+18h], eax
call    sub_403c19
test    eax, eax
jnz     short loc_404487
mov     eax, [esi+18h]
sub     eax, [ebp+var_10]
mov     ecx, [ebp+var_8]
sub     eax, esi
lea     eax, [ecx+eax-5ch]
add     [ebx], eax
add     [ebp+src], eax
sub     [ebp+var_4], eax
and     dword ptr [esi+58h], 0
cmp     dword ptr [esi+48h], 112h
jnz     loc_404286
jmp     loc_40426b
mov     eax, [ebp+arg_c]
mov     dword ptr [eax], 3
xor     eax, eax
jmp     loc_404282
xor     eax, eax
inc     eax
jmp     loc_404282
mov     eax, [ebp+arg_c]
mov     dword ptr [eax], 4
jmp     short loc_404480
xor     eax, eax
mov     ecx, [ebp+arg_c]
mov     dword ptr [ecx], 2
jmp     loc_404282
xor     eax, eax
inc     eax
jmp     short loc_40449c
push    edi
push    [ebp+src]
lea     eax, [esi+5ch]
push    eax
call    _memcpy
add     esp, 0ch
add     [ebx], edi
mov     [esi+58h], edi
jmp     short loc_404477
mov     eax, [ebp+var_8]
add     [ebx], eax
jmp     short loc_404477
push    ebp
mov     ebp, esp
sub     esp, 10h
mov     eax, [ebp+arg_4]
mov     ecx, [eax]
and     dword ptr [eax], 0
push    ebx
push    esi
mov     esi, [ebp+arg_c]
mov     edx, [esi]
and     dword ptr [esi], 0
mov     [ebp+var_4], ecx
mov     [ebp+var_8], edx
mov     eax, [ebp+var_8]
mov     [ebp+var_c], eax
mov     eax, [edi+28h]
cmp     [edi+24h], eax
jnz     short loc_4044fd
and     dword ptr [edi+24h], 0
mov     edx, [edi+24h]
mov     ebx, eax
sub     ebx, edx
mov     [ebp+var_10], edx
cmp     ecx, ebx
jbe     short loc_40450f
xor     ecx, ecx
jmp     short loc_404515
lea     eax, [edx+ecx]
xor     ecx, ecx
inc     ecx
push    [ebp+arg_10]
lea     ebx, [ebp+var_c]
push    ecx
push    [ebp+src]
push    eax
mov     eax, edi
call    sub_404242
mov     ebx, eax
mov     eax, [ebp+var_c]
add     [esi], eax
add     [ebp+src], eax
sub     [ebp+var_8], eax
mov     esi, [edi+24h]
mov     eax, [edi+14h]
sub     esi, [ebp+var_10]
add     eax, [ebp+var_10]
push    esi
push    eax
push    [ebp+arg_0]
call    _memcpy
mov     eax, [ebp+arg_4]
add     [ebp+arg_0], esi
sub     [ebp+var_4], esi
add     [eax], esi
add     esp, 1ch
test    ebx, ebx
jnz     short loc_404570
test    esi, esi
jz      short loc_404574
cmp     [ebp+var_4], ebx
jz      short loc_404574
mov     esi, [ebp+arg_c]
mov     ecx, [ebp+var_4]
jmp     loc_4044eb
mov     eax, ebx
jmp     short loc_404576
xor     eax, eax
pop     esi
pop     ebx
leave
retn
movzx   eax, byte ptr [edx+4]
push    esi
movzx   esi, byte ptr [edx+3]
shl     eax, 8
or      eax, esi
movzx   esi, byte ptr [edx+2]
shl     eax, 8
or      eax, esi
movzx   esi, byte ptr [edx+1]
shl     eax, 8
or      eax, esi
mov     esi, 1000h
cmp     eax, esi
jnb     short loc_4045a5
mov     eax, esi
mov     dl, [edx]
mov     [ecx+0ch], eax
cmp     dl, 0e1h
jb      short loc_4045b4
push    4
pop     eax
pop     esi
retn
movzx   eax, dl
cdq
push    9
pop     esi
idiv    esi
push    5
pop     esi
movzx   eax, al
mov     [ecx], edx
cdq
idiv    esi
pop     esi
mov     [ecx+8], eax
mov     [ecx+4], edx
xor     eax, eax
retn
mov     ecx, [eax+4]
add     ecx, [eax]
mov     eax, [edi+10h]
push    esi
mov     esi, 300h
shl     esi, cl
add     esi, 736h
test    eax, eax
jz      short loc_4045f1
cmp     esi, [edi+54h]
jz      short loc_404613
push    eax
push    ebx
call    dword ptr [ebx+4]
and     dword ptr [edi+10h], 0
lea     eax, [esi+esi]
push    eax
push    ebx
call    dword ptr [ebx]
add     esp, 10h
mov     [edi+10h], eax
mov     [edi+54h], esi
test    eax, eax
jnz     short loc_404613
push    2
pop     eax
pop     esi
retn
xor     eax, eax
pop     esi
retn
push    ebp
mov     ebp, esp
sub     esp, 14h
push    ebx
push    esi
push    edi
mov     edi, ecx
lea     ecx, [ebp+var_10]
mov     ebx, eax
call    sub_40457a
test    eax, eax
jnz     short loc_40467f
mov     eax, ecx
call    sub_4045d2
test    eax, eax
jnz     short loc_40467f
mov     eax, [edi+14h]
mov     esi, [ebp+var_4]
test    eax, eax
jz      short loc_40464a
cmp     esi, [edi+28h]
jz      short loc_404673
push    eax
push    ebx
call    dword ptr [ebx+4]
and     dword ptr [edi+14h], 0
push    esi
push    ebx
call    dword ptr [ebx]
add     esp, 10h
mov     [edi+14h], eax
test    eax, eax
jnz     short loc_404673
push    dword ptr [edi+10h]
push    ebx
call    dword ptr [ebx+4]
and     dword ptr [edi+10h], 0
pop     ecx
pop     ecx
push    2
pop     eax
jmp     short loc_40467f
mov     [edi+28h], esi
lea     esi, [ebp+var_10]
movsd
movsd
movsd
movsd
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
push    ebp
lea     ebp, [esp-1a8h]
sub     esp, 228h
mov     eax, dword_4109f8
xor     eax, ebp
mov     [ebp+1a8h+var_4], eax
mov     eax, [ebp+1a8h+arg_0]
and     [ebp+1a8h+var_214], 0
mov     [ebp+1a8h+var_228], eax
mov     eax, [ebp+1a8h+arg_1c]
mov     [ebp+1a8h+var_220], eax
push    ebx
mov     eax, 400h
movzx   ebx, ax
push    esi
mov     eax, ebx
shl     ebx, 10h
or      eax, ebx
push    edi
mov     ecx, 81h
lea     edi, [ebp+1a8h+var_208]
rep stosd
mov     eax, [ebp+1a8h+arg_18]
mov     ecx, edx
add     edx, eax
xor     eax, eax
xor     esi, esi
or      [ebp+1a8h+var_210], 0ffffffffh
mov     [ebp+1a8h+var_215], 0
mov     [ebp+1a8h+var_224], edx
mov     [ebp+1a8h+var_20c], eax
cmp     ecx, edx
jz      short loc_404715
mov     edi, [ebp+1a8h+var_20c]
movzx   ebx, byte ptr [ecx]
shl     edi, 8
or      edi, ebx
inc     ecx
inc     eax
cmp     eax, 5
mov     [ebp+1a8h+var_20c], edi
mov     [ebp+1a8h+var_21c], ecx
jl      short loc_4046ed
cmp     [ebp+1a8h+arg_20], esi
jnz     short loc_40471a
xor     eax, eax
jmp     short loc_404746
xor     eax, eax
inc     eax
jmp     short loc_404746
mov     al, [ebp+1a8h+var_215]
mov     edx, [ebp+1a8h+var_220]
mov     ecx, [ebp+1a8h+arg_4]
mov     edi, [ebp+1a8h+arg_20]
sub     ecx, [ebp+1a8h+var_214]
sub     edi, esi
cmp     edi, ecx
jnb     short loc_404737
mov     ecx, edi
test    ecx, ecx
jnz     short loc_404761
xor     eax, eax
cmp     esi, [ebp+1a8h+arg_20]
setnz   al
mov     ecx, [ebp+1a8h+var_4]
pop     edi
pop     esi
xor     ecx, ebp
pop     ebx
call    sub_4088de
add     ebp, 1a8h
leave
retn
mov     edx, [ebp+1a8h+var_220]
mov     edi, [ebp+1a8h+var_228]
mov     ebx, [ebp+1a8h+var_214]
mov     bl, [edi+ebx]
mov     [edx+esi], bl
mov     dl, bl
and     dl, 0feh
inc     esi
cmp     dl, 0e8h
jz      short loc_40478e
cmp     al, 0fh
jnz     short loc_404786
mov     dl, bl
and     dl, 0f0h
cmp     dl, 80h
jz      short loc_40478e
inc     [ebp+1a8h+var_214]
dec     ecx
mov     al, bl
jnz     short loc_40475e
test    ecx, ecx
jz      short loc_40473b
cmp     esi, [ebp+1a8h+arg_20]
jz      short loc_40473b
mov     edx, [ebp+1a8h+var_214]
inc     [ebp+1a8h+var_214]
mov     ecx, edi
mov     dl, [ecx+edx]
cmp     dl, 0e8h
jnz     short loc_4047b3
movzx   edi, al
lea     edi, [ebp+edi*2+1a8h+var_208]
jmp     short loc_4047c4
lea     edi, [ebp+1a8h+var_8]
cmp     dl, 0e9h
jz      short loc_4047c4
lea     edi, [ebp+1a8h+var_6]
movzx   ecx, word ptr [edi]
mov     eax, [ebp+1a8h+var_210]
shr     eax, 0bh
imul    eax, ecx
cmp     [ebp+1a8h+var_20c], eax
jnb     short loc_404819
mov     ebx, 800h
sub     ebx, ecx
shr     ebx, 5
add     ebx, ecx
mov     [ebp+1a8h+var_210], eax
mov     [edi], bx
cmp     eax, 1000000h
jnb     short loc_404812
mov     ecx, [ebp+1a8h+var_21c]
cmp     ecx, [ebp+1a8h+var_224]
jz      loc_404715
movzx   edi, byte ptr [ecx]
shl     eax, 8
mov     [ebp+1a8h+var_210], eax
mov     eax, [ebp+1a8h+var_20c]
shl     eax, 8
or      eax, edi
inc     ecx
mov     [ebp+1a8h+var_20c], eax
mov     [ebp+1a8h+var_21c], ecx
mov     al, dl
jmp     loc_40471d
sub     [ebp+1a8h+var_210], eax
sub     [ebp+1a8h+var_20c], eax
mov     eax, ecx
shr     eax, 5
sub     ecx, eax
cmp     [ebp+1a8h+var_210], 1000000h
mov     [edi], cx
jnb     short loc_404854
mov     eax, [ebp+1a8h+var_21c]
cmp     eax, [ebp+1a8h+var_224]
jz      loc_404715
mov     ecx, [ebp+1a8h+var_20c]
movzx   edi, byte ptr [eax]
shl     [ebp+1a8h+var_210], 8
shl     ecx, 8
or      ecx, edi
inc     eax
mov     [ebp+1a8h+var_20c], ecx
mov     [ebp+1a8h+var_21c], eax
push    4
cmp     dl, 0e8h
pop     edx
jnz     short loc_40487c
mov     ecx, [ebp+1a8h+arg_8]
cmp     [ebp+1a8h+arg_c], edx
jb      loc_404715
add     [ebp+1a8h+arg_8], edx
sub     [ebp+1a8h+arg_c], edx
jmp     short loc_40489a
mov     ecx, [ebp+1a8h+arg_10]
cmp     [ebp+1a8h+arg_14], edx
jb      loc_404715
add     [ebp+1a8h+arg_10], edx
sub     [ebp+1a8h+arg_14], edx
movzx   eax, byte ptr [ecx]
movzx   edi, byte ptr [ecx+1]
shl     eax, 8
or      eax, edi
movzx   edi, byte ptr [ecx+2]
movzx   ecx, byte ptr [ecx+3]
shl     eax, 8
or      eax, edi
shl     eax, 8
or      eax, ecx
sub     eax, esi
sub     eax, edx
mov     edx, [ebp+1a8h+var_220]
mov     [edx+esi], al
inc     esi
cmp     esi, [ebp+1a8h+arg_20]
jz      loc_40473b
mov     ecx, eax
shr     ecx, 8
mov     [edx+esi], cl
inc     esi
cmp     esi, [ebp+1a8h+arg_20]
jz      loc_40473b
mov     ecx, eax
shr     ecx, 10h
mov     [edx+esi], cl
inc     esi
cmp     esi, [ebp+1a8h+arg_20]
jz      loc_40473b
shr     eax, 18h
mov     [edx+esi], al
inc     esi
jmp     loc_404720
push    offset ?__cxxunhandledexceptionfilter@@ygjpau_exception_pointers@@@z
call    ds:setunhandledexceptionfilter
xor     eax, eax
retn
mov     edi, edi
push    esi
mov     eax, offset dword_40ed54
mov     esi, offset dword_40ed54
push    edi
mov     edi, eax
cmp     eax, esi
jnb     short loc_4058c3
mov     eax, [edi]
test    eax, eax
jz      short loc_4058bc
call    eax
add     edi, 4
cmp     edi, esi
jb      short loc_4058b4
pop     edi
pop     esi
retn
mov     edi, edi
push    esi
mov     eax, offset dword_40ed5c
mov     esi, offset dword_40ed5c
push    edi
mov     edi, eax
cmp     eax, esi
jnb     short loc_4058e9
mov     eax, [edi]
test    eax, eax
jz      short loc_4058e2
call    eax
add     edi, 4
cmp     edi, esi
jb      short loc_4058da
pop     edi
pop     esi
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_411290, eax
pop     ebp
retn
push    esi
push    4
push    20h
call    __calloc_crt
mov     esi, eax
push    esi
call    __encode_pointer
add     esp, 0ch
mov     dword_411908, eax
mov     dword_411904, eax
test    esi, esi
jnz     short loc_4065d1
push    18h
pop     eax
pop     esi
retn
and     dword ptr [esi], 0
xor     eax, eax
pop     esi
retn
push    dword_41129c
call    __decode_pointer
pop     ecx
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_4112a8, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_4112b4, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_4112b8, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
mov     dword_4112bc, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
sub     esp, 14h
push    ebx
push    esi
push    edi
call    __encoded_null
and     [ebp+var_4], 0
cmp     dword_4112c0, 0
mov     ebx, eax
jnz     loc_406b24
push    offset libfilename
call    ds:loadlibrarya
mov     edi, eax
test    edi, edi
jz      loc_406bd5
mov     esi, ds:getprocaddress
push    offset amessageboxa
push    edi
call    esi
test    eax, eax
jz      loc_406bd5
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetactivewindo
push    edi
mov     dword_4112c0, eax
call    esi
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetlastactivep
push    edi
mov     dword_4112c4, eax
call    esi
push    eax
call    __encode_pointer
mov     [esp+24h+lpprocname], offset agetuserobjecti
push    edi
mov     dword_4112c8, eax
call    esi
push    eax
call    __encode_pointer
pop     ecx
mov     dword_4112d0, eax
test    eax, eax
jz      short loc_406b24
push    offset agetprocesswind
push    edi
call    esi
push    eax
call    __encode_pointer
pop     ecx
mov     dword_4112cc, eax
mov     eax, dword_4112cc
cmp     eax, ebx
jz      short loc_406b7c
cmp     dword_4112d0, ebx
jz      short loc_406b7c
push    eax
call    __decode_pointer
push    dword_4112d0
mov     esi, eax
call    __decode_pointer
pop     ecx
pop     ecx
mov     edi, eax
test    esi, esi
jz      short loc_406b7c
test    edi, edi
jz      short loc_406b7c
call    esi
test    eax, eax
jz      short loc_406b73
lea     ecx, [ebp+var_8]
push    ecx
push    0ch
lea     ecx, [ebp+var_14]
push    ecx
push    1
push    eax
call    edi
test    eax, eax
jz      short loc_406b73
test    [ebp+var_c], 1
jnz     short loc_406b7c
or      [ebp+arg_8], 200000h
jmp     short loc_406bb5
mov     eax, dword_4112c4
cmp     eax, ebx
jz      short loc_406bb5
push    eax
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_406bb5
call    eax
mov     [ebp+var_4], eax
test    eax, eax
jz      short loc_406bb5
mov     eax, dword_4112c8
cmp     eax, ebx
jz      short loc_406bb5
push    eax
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_406bb5
push    [ebp+var_4]
call    eax
mov     [ebp+var_4], eax
push    dword_4112c0
call    __decode_pointer
pop     ecx
test    eax, eax
jz      short loc_406bd5
push    [ebp+arg_8]
push    [ebp+arg_4]
push    [ebp+arg_0]
push    [ebp+var_4]
call    eax
jmp     short loc_406bd7
xor     eax, eax
pop     edi
pop     esi
pop     ebx
leave
retn
jmp     short loc_4075fc
cmp     ecx, dword_4109f8
jnz     short loc_4088e8
rep retn
jmp     ___report_gsfailure
and     dword_4117c4, 0
retn
call    __get_sse2_info
mov     dword_4117c0, eax
xor     eax, eax
retn
mov     edi, edi
push    esi
mov     esi, ecx
mov     eax, [esi]
test    eax, eax
jz      short loc_40c239
push    eax
call    _free
and     dword ptr [esi], 0
pop     ecx
and     dword ptr [esi+4], 0
and     dword ptr [esi+8], 0
pop     esi
retn
mov     edi, edi
push    esi
push    18h
mov     esi, ecx
push    0
push    esi
call    _memset
add     esp, 0ch
mov     eax, esi
pop     esi
retn
push    0ch
push    offset stru_40eff8
call    __seh_prolog4
and     [ebp+ms_exc.registration.trylevel], 0
push    ecx
call    ds:initializecriticalsection
and     [ebp+var_1c], 0
jmp     short loc_40c294
mov     eax, [ebp+ms_exc.exc_ptr]
mov     eax, [eax]
mov     eax, [eax]
xor     ecx, ecx
cmp     eax, 0c0000017h
setz    cl
mov     eax, ecx
retn
mov     esp, [ebp+ms_exc.old_esp]
mov     [ebp+var_1c], 8007000eh
mov     [ebp+ms_exc.registration.trylevel], 0fffffffeh
mov     eax, [ebp+var_1c]
call    __seh_epilog4
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_0]
test    eax, eax
jl      short loc_40c2be
cmp     eax, [ecx+4]
jge     short loc_40c2be
mov     ecx, [ecx]
lea     eax, [ecx+eax*4]
pop     ebp
retn    4
push    0
push    0
push    1
push    0c000008ch
call    ds:raiseexception
int     3
mov     edi, edi
push    esi
mov     esi, ecx
lea     ecx, [esi+14h]
call    sub_40c243
xor     eax, eax
mov     [esi+2ch], eax
mov     [esi+30h], eax
mov     [esi+34h], eax
mov     eax, esi
pop     esi
retn
mov     edi, edi
push    esi
mov     esi, ecx
lea     eax, [esi+14h]
push    eax
call    ds:deletecriticalsection
lea     ecx, [esi+2ch]
pop     esi
jmp     loc_40c224
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
push    edi
mov     esi, ecx
lea     edi, [esi+14h]
push    edi
call    ds:entercriticalsection
mov     eax, [esi+30h]
mov     ecx, [ebp+arg_0]
cmp     ecx, eax
jg      short loc_40c344
test    ecx, ecx
jl      short loc_40c344
cmp     ecx, eax
jnz     short loc_40c337
mov     esi, [esi+8]
push    edi
call    ds:leavecriticalsection
mov     eax, esi
jmp     short loc_40c34d
push    ecx
lea     ecx, [esi+2ch]
call    sub_40c2a4
mov     esi, [eax]
jmp     short loc_40c32c
push    edi
call    ds:leavecriticalsection
xor     eax, eax
pop     edi
pop     esi
pop     ebp
retn    4
mov     edi, edi
push    esi
mov     esi, ecx
call    sub_40c2d0
mov     eax, 400000h
lea     ecx, [esi+14h]
mov     dword ptr [esi], 38h
mov     [esi+8], eax
mov     [esi+4], eax
mov     dword ptr [esi+0ch], 900h
mov     dword ptr [esi+10h], offset dword_40e364
call    sub_40c259
test    eax, eax
jge     short loc_40c38f
mov     byte_4117ba, 1
mov     eax, esi
pop     esi
retn
cmp     byte ptr [ecx+8], 0
mov     dword ptr [ecx], offset off_40e374
jz      short locret_40c3ad
mov     ecx, [ecx+4]
test    ecx, ecx
jz      short locret_40c3ad
push    ecx
call    ds:heapdestroy
retn
mov     edi, edi
push    ebp
mov     ebp, esp
push    [ebp+dwbytes]
push    0
push    dword ptr [ecx+4]
call    ds:heapalloc
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
cmp     [ebp+lpmem], 0
jz      short loc_40c3de
push    [ebp+lpmem]
push    0
push    dword ptr [ecx+4]
call    ds:heapfree
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
xor     eax, eax
cmp     [ebp+lpmem], eax
jnz     short loc_40c3f7
push    [ebp+dwbytes]
mov     eax, [ecx]
call    dword ptr [eax]
jmp     short loc_40c418
cmp     [ebp+dwbytes], eax
jnz     short loc_40c408
push    [ebp+lpmem]
mov     eax, [ecx]
call    dword ptr [eax+4]
xor     eax, eax
jmp     short loc_40c418
push    [ebp+dwbytes]
push    [ebp+lpmem]
push    eax
push    dword ptr [ecx+4]
call    ds:heaprealloc
pop     ebp
retn    8
mov     edi, edi
push    ebp
mov     ebp, esp
push    [ebp+lpmem]
push    0
push    dword ptr [ecx+4]
call    ds:heapsize
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, ecx
call    sub_40c393
test    [ebp+arg_0], 1
jz      short loc_40c44d
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, ecx
mov     ecx, [ebp+arg_0]
mov     [eax+4], ecx
mov     dword ptr [eax], offset off_40e388
xor     ecx, ecx
mov     dword ptr [eax+14h], 2
mov     [eax+0ch], ecx
mov     [eax+10h], ecx
mov     [eax+18h], cx
mov     [eax+1ah], cx
mov     [eax+8], eax
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_4]
mul     [ebp+arg_8]
test    edx, edx
ja      short loc_40c499
cmp     eax, 0ffffffffh
jbe     short loc_40c4a0
mov     eax, 80070057h
pop     ebp
retn
mov     ecx, [ebp+arg_0]
mov     [ecx], eax
xor     eax, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
mov     ecx, [ecx+4]
mov     eax, [ecx]
pop     ebp
jmp     dword ptr [eax+4]
xor     edx, edx
lea     eax, [ecx+14h]
inc     edx
lock xadd [eax], edx
lea     eax, [ecx+8]
retn
mov     eax, ecx
retn
mov     edi, edi
push    ebp
mov     ebp, esp
test    [ebp+arg_0], 1
push    esi
mov     esi, ecx
mov     dword ptr [esi], offset off_40e388
jz      short loc_40c4e3
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
mov     eax, [ebp+arg_4]
mov     ecx, [ebp+arg_8]
or      edx, 0ffffffffh
sub     edx, eax
cmp     edx, ecx
jnb     short loc_40c505
mov     eax, 80070057h
pop     ebp
retn
add     eax, ecx
mov     ecx, [ebp+arg_0]
mov     [ecx], eax
xor     eax, eax
pop     ebp
retn
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, [ebp+arg_0]
push    edi
push    [ebp+arg_4]
add     esi, 8
and     esi, 0fffffff8h
lea     eax, [ebp+arg_0]
push    esi
push    eax
mov     edi, ecx
call    sub_40c485
add     esp, 0ch
test    eax, eax
jl      short loc_40c56c
push    [ebp+arg_0]
lea     eax, [ebp+arg_0]
push    10h
push    eax
call    sub_40c4ea
add     esp, 0ch
test    eax, eax
jl      short loc_40c56c
mov     ecx, [edi+4]
push    [ebp+arg_0]
mov     eax, [ecx]
call    dword ptr [eax]
test    eax, eax
jz      short loc_40c56c
dec     esi
and     dword ptr [eax+4], 0
mov     [eax], edi
mov     dword ptr [eax+0ch], 1
mov     [eax+8], esi
jmp     short loc_40c56e
xor     eax, eax
pop     edi
pop     esi
pop     ebp
retn    8
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, [ebp+arg_4]
push    edi
push    [ebp+arg_8]
add     esi, 8
and     esi, 0fffffff8h
lea     eax, [ebp+arg_4]
push    esi
push    eax
mov     edi, ecx
call    sub_40c485
add     esp, 0ch
test    eax, eax
jl      short loc_40c5c7
push    [ebp+arg_4]
lea     eax, [ebp+arg_4]
push    10h
push    eax
call    sub_40c4ea
add     esp, 0ch
test    eax, eax
jl      short loc_40c5c7
push    [ebp+arg_4]
mov     ecx, [edi+4]
push    [ebp+arg_0]
mov     eax, [ecx]
call    dword ptr [eax+8]
test    eax, eax
jz      short loc_40c5c7
dec     esi
mov     [eax+8], esi
jmp     short loc_40c5c9
xor     eax, eax
pop     edi
pop     esi
pop     ebp
retn    0ch
mov     dword ptr [ecx], offset ??_7bad_alloc@std@@6b@
jmp     sub_40c8f2
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, ecx
mov     dword ptr [esi], offset ??_7bad_alloc@std@@6b@
call    sub_40c8f2
test    [ebp+arg_0], 1
jz      short loc_40c7ef
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
pop     ebp
retn    4
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
push    [ebp+arg_0]
mov     esi, ecx
call    ??0exception@std@@qae@abv01@@z
mov     dword ptr [esi], offset ??_7bad_alloc@std@@6b@
mov     eax, esi
pop     esi
pop     ebp
retn    4
cmp     dword ptr [ecx+8], 0
mov     dword ptr [ecx], offset ??_7exception@std@@6b@
jz      short locret_40c907
push    dword ptr [ecx+4]
call    _free
pop     ecx
retn
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, ecx
call    sub_40c8f2
test    [ebp+arg_0], 1
jz      short loc_40c92f
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
pop     ebp
retn    4
mov     edi, edi
push    ecx
mov     dword ptr [ecx], offset ??_7type_info@@6b@
call    ?_type_info_dtor@type_info@@caxpav1@@z
pop     ecx
retn
mov     edi, edi
push    ebp
mov     ebp, esp
push    esi
mov     esi, ecx
call    sub_40c936
test    [ebp+arg_0], 1
jz      short loc_40c960
push    esi
call    ??3@yaxpax@z
pop     ecx
mov     eax, esi
pop     esi
pop     ebp
retn    4
mov     ecx, offset dword_411708
call    sub_40c353
push    offset sub_40ca8f
call    _atexit
pop     ecx
retn
call    ds:getprocessheap
push    offset sub_40ca99
mov     dword_411740, offset off_40e374
mov     dword_411744, eax
mov     byte_411748, 0
call    _atexit
pop     ecx
retn
push    offset dword_411740
mov     ecx, offset dword_41174c
call    sub_40c454
push    offset sub_40caa3
call    _atexit
pop     ecx
retn
mov     ecx, offset dword_411708
jmp     loc_40c2ec
mov     ecx, offset dword_411740
jmp     sub_40c393
mov     dword_41174c, offset off_40e388
retn
mov     dword_411768, offset ??_7bad_alloc@std@@6b@
mov     ecx, offset dword_411768
jmp     sub_40c8f2