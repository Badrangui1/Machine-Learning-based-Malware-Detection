# Machine-Learning-based-Malware-Detection
It looks like your script is designed to load, preprocess, and save the data from the given directories. Here is a step-by-step guide on how to run this script and proceed with training and evaluating your models.

### Step-by-Step Guide

1. **Ensure the Necessary Packages are Installed**
    
    Ensure you have `tensorflow`, `scikit-learn`, and `numpy` installed in your environment. If not, you can install them using:
    
    ```
    pip install tensorflow scikit-learn numpy
    
    ```
    
2. **Save the Script**
    
    Save your script as `load_and_preprocess_data.py`.
    
3. **Run the Script**
    
    Open a terminal or command prompt, navigate to the directory containing your script, and run:
    
    ```
    python load_and_preprocess_data.py
    
    ```
    
    This script will load the data from your specified directories, preprocess it, and save the preprocessed data and tokenizer to files.
    

### Step 3: Define and Train the Model

Create a new script named `train_model.py` for defining and training your CNN and RNN models.

```python
import numpy as np
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Embedding, Conv1D, GlobalMaxPooling1D, Dense, Dropout, LSTM
import pickle

# Load the preprocessed data
X_train = np.load('X_train.npy')
X_test = np.load('X_test.npy')
y_train = np.load('y_train.npy')
y_test = np.load('y_test.npy')

# Load the tokenizer
with open('tokenizer.pickle', 'rb') as handle:
    tokenizer = pickle.load(handle)

# Set the vocabulary size
vocab_size = len(tokenizer.word_index) + 1
max_sequence_length = X_train.shape[1]

# Define the CNN model
cnn_model = Sequential()
cnn_model.add(Embedding(input_dim=vocab_size, output_dim=128, input_length=max_sequence_length))
cnn_model.add(Conv1D(filters=128, kernel_size=5, activation='relu'))
cnn_model.add(GlobalMaxPooling1D())
cnn_model.add(Dense(128, activation='relu'))
cnn_model.add(Dropout(0.5))
cnn_model.add(Dense(1, activation='sigmoid'))

# Compile the CNN model
cnn_model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train the CNN model
cnn_model.fit(X_train, y_train, epochs=10, batch_size=32, validation_data=(X_test, y_test))

# Save the trained CNN model
cnn_model.save('cnn_model.h5')

# Define the RNN model
rnn_model = Sequential()
rnn_model.add(Embedding(input_dim=vocab_size, output_dim=128, input_length=max_sequence_length))
rnn_model.add(LSTM(128, return_sequences=False))
rnn_model.add(Dense(128, activation='relu'))
rnn_model.add(Dropout(0.5))
rnn_model.add(Dense(1, activation='sigmoid'))

# Compile the RNN model
rnn_model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train the RNN model
rnn_model.fit(X_train, y_train, epochs=10, batch_size=32, validation_data=(X_test, y_test))

# Save the trained RNN model
rnn_model.save('rnn_model.h5')

```

### Step 4: Evaluate the Model

Create a new script named `evaluate_model.py` to evaluate your trained models.

```python
import numpy as np
from tensorflow.keras.models import load_model

# Load the preprocessed data
X_test = np.load('X_test.npy')
y_test = np.load('y_test.npy')

# Load the trained CNN model
cnn_model = load_model('cnn_model.h5')

# Evaluate the CNN model
cnn_loss, cnn_accuracy = cnn_model.evaluate(X_test, y_test)
print(f"CNN Test Accuracy: {cnn_accuracy * 100:.2f}%")

# Load the trained RNN model
rnn_model = load_model('rnn_model.h5')

# Evaluate the RNN model
rnn_loss, rnn_accuracy = rnn_model.evaluate(X_test, y_test)
print(f"RNN Test Accuracy: {rnn_accuracy * 100:.2f}%")

```

### How to Use

1. **Ensure TensorFlow is Installed**:
    - Run `pip install tensorflow` if you haven't already.
2. **Preprocess Assembly Code**:
    - Ensure your assembly files are preprocessed using your `preprocess_assembly.py` script.
3. **Load and Preprocess Data**:
    - Run the `load_and_preprocess_data.py` script to load, preprocess, vectorize the data, and save it.
    
    ```
    python load_and_preprocess_data.py
    
    ```
    
4. **Train the Model**:
    - Run the `train_model.py` script to define, compile, and train both CNN and RNN models. The models will be saved after training.
    
    ```
    python train_model.py
    
    ```
    
5. **Evaluate the Model**:
    - Run the `evaluate_model.py` script to load the trained models and evaluate their performance on the test set.
    
    ```
    python evaluate_model.py
    
    ```
    

By following these steps, you can preprocess your assembly code files, prepare them for machine learning, and train and evaluate CNN and RNN models to classify them as malware or benign. Adjust the parameters and preprocessing steps as needed for your specific dataset and requirements.
